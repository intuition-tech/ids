<!DOCTYPE html>
<html>

  <head>
    <meta charset="utf-8" />
    <title>Intuition Design System Template</title>
    <link rel="icon" type="image/png" href="images/favicon-inverted.png">
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <link rel="stylesheet" href="css/colors.css" />
    <link rel="stylesheet" href="css/normalize.css" />
    <link rel="stylesheet" href="css/settings.css" />
    <link rel="stylesheet" href="css/layout.css" />
    <link rel="stylesheet" href="css/ids.css" />
    <link rel="stylesheet" href="css/gallery.css" />
    <link rel="stylesheet" href="css/navbar.css" />

  </head>

  <body class="ids">
    <header></header>
    <ids-navbar></ids-navbar>
    <main>
      <div class="ids__wrapper">
        <div class="section" id="intro">
          <div class="ids__space XL"></div>
          <div class="ids__text-width">
            <ids-nav-item id="ids" text=".ids"><h1>.ids</h1></ids-nav-item>
            <p>IDS (Intuition Design System) – дизайн-система для вёрстки нарративов.</p>
            <p>Упрощает создание лендингов, онлайн-изданий и любых цифровых продуктов для веба, в основе которых лежит история, объяснение, иллюстрированный текст.</p>
            <p>Технически IDS – это набор CSS-классов, JS-компонентов и всяких секретных приёмчиков. Это не библиотека, а шаблон – вы не подключаете IDS в проект как зависимость, не расширяете классы, не переопределяете свойства. Вместо этого вы тупо копируете к себе её исходный код, и меняете его как захочется. Без проблем с совместимостью, без апдейтов. </p>
            <aside>
              <p>Публичный репозиторий: <code><a href="https://github.com/intuition-tech/ids">github.com/intuition-tech/ids</a></code></p>
              
            </aside>
            <p>Если у вас нет навыков разработчика, то простейший способ начать проект – скачать архив репозитория, открыть файлы в редакторе кода и делать из них что-то своё. Вы можете смело менять свою копию, эталонный образец всегда доступен здесь: <code><a href="https://intuition-tech.github.io/ids">intuition-tech.github.io/ids</a></code>.</p>
            <p>Если вы разработчик – делайте что хотите. IDS работает в статике, у неё ноль зависимостей и ванильный JS.</p>

          </div>
        </div>

        <div class="section">
          <div class="ids__space L"></div>
          <div class="ids__text-width">
            <ids-nav-item id="setup" text="Настройка"><h2>Настройка</h2></ids-nav-item>
            <p>Базовые параметры дизайн-системы задаются в файле <code>settings.css</code>.</p>
            <p> Кроме того, в IDS включён <code><a href="https://necolas.github.io/normalize.css/">normalize.css</a></code> – набор корректировок, устраняющих неконсистентность реализации стилей в разных браузерах – с ним не надо ничего делать, он просто есть. </p>
          </div>
        </div>

        <div class="section" id="font">
          <div class="ids__space"></div>
          <div class="ids__text-width">
            <h3>Шрифт</h3>
            <p>В IDS по умолчанию используется шрифт <a href=https://www.paratype.com/fonts/pt/pt-root-ui" target="_BLANK">PT Root UI</a>, вариативная веб-версия. Он классный! Но дизайн-система не завязана на конкретный шрифт, вы можете подключить любой, достаточно положить шрифт в папку <code>/fonts</code> и отредактировать раздел Fonts в файле <code>settings.css</code>.</p>
            <p>TODO: Написать кусок об использовании числовых значений для font-weight.</p>

          </div>
        </div>

        <div class="section" id="density">
          <div class="ids__space"></div>
          <div class="ids__text-width">
            <h3>Плотность</h3>
            <p>Разным шрифтам подходит разная плотность вёрстки. Кроме того, плотность это эстетический выбор – иногда нужна тесная вёрстка, иногда воздушная.</p>
            <p>В IDS есть переменная <code>--ids__density</code>, которая влияет на интерлиньяж текста, а также на поля и отступы всех текстовых элементов. Чтобы настроить плотность вёрстки, попробуйте сначала найти оптимальное значение этой переменной, а потом уже редактировать отдельные стили.</p>
          </div>
        </div>

        <div class="section" id="fluid">
          <div class="ids__space"></div>
          <div class="ids__text-width">
            <h3>Адаптивность</h3>
            <p>IDS считает, что есть только два типа устройств: <code>mobile</code> и <code>desktop</code>. Это определяется по ширине вьюпорта (если упрощать, обычно это ширина окна браузера): если вьюпорт меньше 768 px, значит мобила, если больше – десктоп.</p>
            <p>IDS реализует концепцию Fluid Typography – это когда в зависимости от ширины вьюпорта рассчитывается значение font-size для body, а затем единицы em или rem используются не только для текста, но и для полей, радиусов скруглений, отступов, а иногда и габаритов отдельных элементов.</p>
            <aside>
              <p>Конечно, для толщин обводок уместнее px, а для размеров, высчитываемых относительно габаритов родительских контейнеров, подойдут только %, vh и vw.</p>
            </aside>

            <p>Этот подход упрощает отладку дизайна. Сначала нужно найти оптимальный диапазон значений font-size, подходящий выбранному шрифту и желаемой крупности «обычного» текста.</p>
            <p>Этот диапазон задают переменные <code>--desktop-font-size-min</code> и <code>--desktop-font-size-max</code>. Нужно подобрать такие значения, чтобы при изменении ширины текст масштабировался, сохраняя разбивку слов по строкам. И тогда можно проверять вёрстку только на одной ширине, зная, что при любой ширине компоновка элементов сохранится. </p>
            <p>Для мобилы нужно найти свою пару значений <code>--mobile-font-size-min</code> и <code>--mobile-font-size-max</code>, но идея ровно та же – одинаковая вёрстка на телефончиках разной ширины.</p>
            <p>Fluid Typography не заставляет масштабировать страницу именно так – можно эксперименоировать. Можно вообще сделать минимальное и максимальное значения одинаковыми, получится обычная резиновая вёрстка, но «крупность» элементов всё ещё можно будет менять через переменные.</p>
          </div>

        </div>

        <div class="section" id="color">
          <div class="ids__space"></div>
          <div class="ids__text-width">
            <h3>Цвет</h3>
            <p>IDS хранит цветовую палитру в переменных. Именование цветов функциональное: для чего используется, так и называется.</p>
            <p>Все цветовые палитры хранятся в файле <code>color-palettes.css</code>. Вот они (пока что одна): 
          </div>
          <style>
            .guide-color-plate {
              height: 6em;
              font-size: 0.8em;
              padding: 0.6em 0.8em;
            }
          </style>

          <div class="ids__space"></div>
          <div class="ids__sequence L">
            <div class="ids__sequence-item">
              <div class="guide-color-plate" style="background-color: rgba(var(--ids__text-RGB), 1); color: rgba(var(--ids__background-RGB), 1)">
                <p>--ids__text-RGB</p>
              </div>
            </div>

            <div class="ids__sequence-item">
              <div class="guide-color-plate" style="background-color: rgba(var(--ids__link-RGB), 1); color: rgba(var(--ids__background-RGB), 1)">
                <p>--ids__link-RGB</p>
              </div>
            </div>
            <div class="ids__sequence-item">
              <div class="guide-color-plate" style="background-color: rgba(var(--ids__hover-RGB), 1); color: rgba(var(--ids__background-RGB), 1)">
                <p>--ids__hover-RGB</p>
              </div>
            </div>
            <div class="ids__sequence-item">
              <div class="guide-color-plate" style="background-color: rgba(var(--ids__mark-RGB), 1)">
                <p>--ids__mark-RGB</p>
              </div>
            </div>

            <div class="ids__sequence-item">
              <div class="guide-color-plate" style="background-color: rgba(var(--ids__code-RGB), 1); color: rgba(var(--ids__background-RGB), 1)">
                <p>--ids__code-RGB</p>
              </div>
            </div>
            <div class="ids__sequence-item">
              <div class="guide-color-plate" style="background-color: rgba(var(--ids__accent-RGB), 1); color: rgba(var(--ids__background-RGB), 1)">
                <p>--ids__accent-RGB</p>
              </div>
            </div>
            <div class="ids__sequence-item">
              <div class="guide-color-plate" style="background-color: rgba(var(--ids__surface-RGB), 1)">
                <p>--ids__surface-RGB</p>
              </div>
            </div>
            <div class="ids__sequence-item">
              <div class="guide-color-plate" style="background-color: rgba(var(--ids__background-RGB), 1)">
                <p>--ids__background-RGB</p>
              </div>
            </div>
          </div>

          <div class="ids__space"></div>
          <div class="ids__text-width">
            <p>Каждая переменная хранит строку из трёх значений в пространстве RGB через запятую, например: <code>253, 47, 75</code>.<p></p> Не получится написать <code>color: var(--ids__accent-RGB)</code>, надо <code>color: rgb(var(--ids__accent-RGB))</code>. Это чтобы хранить прозрачность цвета не в переменной, а в свойстве селектора, писать <code>color: rgba(var(--ids__accent-RGB), 0.5)</code>, когда нужен цвет с прозрачностью 0.5. </p>
          </div>
        </div>

        <div class="section">
          <div class="ids__space L"></div>
          <div class="ids__text-width">
            <ids-nav-item id="frame" text="Каркас страницы"><h2>Каркас страницы</h2></ids-nav-item>
            <p>IDS не использует модульные сетки или колонки для организации пространства страницы. У нас всё намного проще: страница состоит из этажей, они идут сверху вниз друг за другом, каждый занимает всю доступную ширину и может быть любой высоты. Такой подход не мешает внутри этажа создавать модульные сетки и сложные композиции, но изолированность этажей позволяет легко менять их местами и избавляет от какой-либо взаимозависимости. </p>
          </div>
        </div>

        <div class="section">
          <div class="ids__space"></div>
          <div class="ids__text-width">
            <h3>Обёртки</h3>
            <p><code>.ids__wrapper</code> — стандартный этажа c большими полями на десктопе и с минимальными на мобиле.</p>
          </div>
        </div>
      </div>

      <div style="background-color: rgba(var(--ids__accent-RGB), 0.1);">
        <div class="ids__wrapper">
          <div style="background-color: rgba(var(--ids__accent-RGB), 0.1);">
            <div class="ids__space XL"></div>
            <div class="ids__space XL"></div>
          </div>
        </div>
      </div>

      <div class="ids__wrapper">
        <div class="section">
          <div class="ids__space M"></div>
          <p><code>.ids__wrapper.wide</code> — этаж на всю ширину с минимальными полями</p>
        </div>
      </div>

      <div style="background-color: rgba(var(--ids__accent-RGB), 0.1);">
        <div class="ids__wrapper wide">
          <div style="background-color: rgba(var(--ids__accent-RGB), 0.1);">
            <div class="ids__space XL"></div>
            <div class="ids__space XL"></div>
          </div>
        </div>
      </div>

      <div class="ids__wrapper">
        <div class="section" id="">
          <div class="ids__space M"></div>
          <p><code>.ids__wrapper.edge</code> — этаж на всю ширину без полей</p>
        </div>
      </div>

      <div style="background-color: rgba(var(--ids__accent-RGB), 0.1);">
        <div class="ids__wrapper edge">
          <div style="background-color: rgba(var(--ids__accent-RGB), 0.1);">
            <div class="ids__space XL"></div>
            <div class="ids__space XL"></div>
          </div>
        </div>
      </div>

      <div class="ids__wrapper">

        <div class="section">
          <div class="ids__space M"></div>
          <p>Внутри этажей используется обёртка для создания «текстовой ширины»</p>
          <p><code>.ids__text-width</code></p>
          <div style="background-color: rgba(var(--ids__accent-RGB), 0.1);">
            <div class="ids__text-width">
              <div style="background-color: rgba(var(--ids__accent-RGB), 0.1);">
                <div class="ids__space XL"></div>
                <div class="ids__space XL"></div>
              </div>
            </div>
          </div>

        </div>

        <div class="section">
          <div class="ids__space L"></div>
          <div class="ids__text-width">
            <h3>Система отступов</h3>
            <p>В IDS у обёрток нулевые отступы, а у большинства других элементов задан только отступ снизу, минимальный, чтобы верстать элементы одним потоком.</p>

            <p>Когда нужны заметные отступы — например, между этажами или перед заголовком, чтобы он не прилипал к предыдущему абзацу — используются специальные заглушки, спейсеры.</p>
          </div>
          <div class="ids__space M"></div>
          <div class="ids__sequence M gap-S">
            <div class="ids__sequence-item">
              <p><code>ids__space.S</code></p>
              <div class="ids__space S" style="background-color: rgba(var(--ids__accent-RGB), 0.1);"></div>
            </div>
            <div class="ids__sequence-item">
              <p><code>ids__space.M</code></p>
              <div class="ids__space M" style="background-color: rgba(var(--ids__accent-RGB), 0.1);"></div>
            </div>
            <div class="ids__sequence-item">
              <p><code>ids__space.L</code></p>
              <div class="ids__space L" style="background-color: rgba(var(--ids__accent-RGB), 0.1);"></div>
            </div>
            <div class="ids__sequence-item">
              <p><code>ids__space.XL</code></p>
              <div class="ids__space XL" style="background-color: rgba(var(--ids__accent-RGB), 0.1);"></div>
            </div>
          </div>
          <div class="ids__space L"></div>
          <div class="ids__text-width">

            <aside>
              <h4>Почему так</h4>

              <p>На первый взгляд спейсеры — довольно тупое решение. Как во времена ручного металлического набора для создания пустых мест использовали свинцовые бруски, вот так и мы здась. Неужели нельзя как-то элегантнее? Практика показала, что это самое гибкое и удобное решение.</p>
              <p>Например, на этой плашке, где вы сейчас читаете этот текст, верхний отступ у заголовка «Почему так» помешал бы поставить его вот так аккуратно в угол — пришлось бы писать более сложные стили с условиями, это слишком хрупко. Ну и не только поэтому, много ещё почему, спасибо за вопрос.</p>
            </aside>
          </div>
        </div>

        <div class="section">
          <div class="ids__space L"></div>
          <div class="ids__text-width">
            <ids-nav-item id="tags-style" text="Стилизация тегов"><h2>Стилизация тегов</h2></ids-nav-item>
            <p>IDS стилизует некоторые часто используемые теги — чтобы можно было верстать большие объёмы текста, сохраняя минималистичную разметку. Стили тегов определены только внутри контейнера <code>.ids</code>. Вы можете повесить этот класс на <code>body</code> и знать, что стили дизайн-системы применятся везде.</p>
              <aside>
                <p>Иногда это может мешать. Например, подчёркнутой станет любая ссылка, не только текстовая, и любой ненумерованный список получит точки и отступы, даже когда это не текст. Можно переопределять стили, а можно просто не вешать <code>.ids</code> на <code>body</code>, а повесить где-то внутри, где у вас начинается основной поток текста. </p>
                <p>В этом случае все остальные настройки продолжат распространяться на всю страницу, и классы с префиксом <code>.ids__</code> тоже будут работать везде. Класс <code>.ids</code> изолирует только стили тегов.</p>
              </aside>
            <p>Вот что у нас есть:</p>
          </div>
        </div>



        <div class="section">
          <div class="ids__space M"></div>
          <div class="ids__text-width">
            <h3>Заголовки</h3>
            <code>h1</code>
            <h1>Главный заголовок страницы</h1>
            <hr>
            <code>h2</code>
            <h2>Заголовок второго уровня</h2>
            <hr>
            <code>h3</code>
            <h3>Заголовок третьего уровня</h3>
            <hr>
            <code>h4</code>
            <h4>Заголовок четвёртого уровня</h4>
            <hr>
            <code>h5</code>
            <h5>Заголовок пятого уровня</h5>
            <hr>
            <code>h6</code>
            <h6>Заголовок шестого уровня</h6>
            <hr>

            <div class="ids__space"></div>
            <p>Бывает, что тексту не нужны такие крупные заголовки как h1 или h2. Проблема в том, что по стандартам доступности на странице должен быть h1, а следующим уровнем не может быть h3, должен быть h2. Чтобы разрешить это противоречие, мы подготовили специальные классы, визуально уменьшающие h1 и h2:</p>

            <code>h1.S</code>
            <h1 class="S">Главный заголовок, уменьшенный</h1>
            <hr>
            <code>h1.XS</code>
            <h1 class="XS">Главный заголовок, уменьшенный ещё сильнее</h1>
            <hr>
            <code>h2.XS</code>
            <h2 class="XS">Заголовок второго уровня, уменьшенный как-то</h2>
            <hr>


            <p>TODO: hgroup с лейблом</p>
          </div>
        </div>

        <div class="section">
          <div class="ids__space M"></div>
          <div class="ids__text-width">
            <h3>Текст</h3>
            <code>p</code>
            <p>TODO: показать абзац +помельче +покрупнее +супер-крупный</p>
              <code>p.loud</code>
            <p>Когда мы рисуем макеты, то контролируем только внешний вид. Проблема в том, что </p>
            <p class="loud">дизайн цифровых продуктов — это в первую очередь дизайн взаимодействия.</p>
            <code>mark</code>
            <code>code</code>
            <p>Используются, чтобы выделить <mark>важную мысль</mark> или <code>фрагмент кода</code>.</p>

          </div>

        </div>

        <div class="section">
          <div class="ids__space"></div>
          <div class="ids__text-width">
            <h3>Иллюстрация</h3>
            <p><code>figure</code> <code>figcaption</code></p>

          </div>
        </div>

        <div class="section">
          <div class="ids__space"></div>
          <div class="ids__text-width">
            <h3>Список</h3>
            <p><code>ul</code> <code>li</code></p>
            <p><code>ol</code> <code>li</code></p>
          </div>
        </div>

        <div class="section">
          <div class="ids__space"></div>
          <div class="ids__text-width">
            <h3>Ссылка</h3>
            <p><code>a</code></p>
            <p><code>.ids__promo-link</code></p>
            <p>TODO: Псевдо-радиогруппа для скролл-навигации</p>
          </div>
        </div>

        <div class="section">
          <div class="ids__space"></div>
          <div class="ids__text-width">
            <h3>Дополнительный текст</h3>
            <p><code>aside</code></p>
            <p><code>.ids__note</code></p>
          </div>
        </div>

        <div class="ids__space M"></div>

        <div class="section">
          <div class="ids__space"></div>
          <div class="ids__text-width">
            <h3>Сетка</h3>
            <p>С помощью класса <code>.ids__sequence</code> можно быстро сделать сетку из одинаковых элементов, которая реализована через <code>display:flex</code>. Сделайте <code>.ids__sequence</code> родителем, а каждую ячейку сетки оберните в <code>.ids__sequence-item</code>:</p>                      
            <div class="ids__space XS"></div>
            <p><code>.ids__sequence</code></p>
            <p>    <code>.ids__sequence-item</code></p>
            <p>    <code>.ids__sequence-item</code></p>
            <div class="ids__space S"></div>
            <aside>Мы рекомендуем никогда не стилизовать ячейку саму по себе, а всегда добавлять внутрь ещё один контейнер, и уже для него задавать цвет фона, скругление, поля и всё остальное. </aside>

            <div class="ids__space S"></div>
            <h4>Модификатор размера</h4>
            
            <p><code>ids__sequence.XL</code></p>                
            <div class="ids__sequence XL gap-S">
              <div class="ids__sequence-item">
                <div class="ids__space XL" style="background-color: rgba(var(--ids__accent-RGB), 0.1);">
                  <p>Текст в ячейке</p>
                </div>
              </div>
              <div class="ids__sequence-item">                
                <div class="ids__space XL" style="background-color: rgba(var(--ids__accent-RGB), 0.1);">
                  <p>Текст в ячейке</p>
                </div>
              </div>
            </div>            
            <div class="ids__space S"></div> 
            <p><code>ids__sequence.L</code></p>
            <div class="ids__sequence L gap-S">
              <div class="ids__sequence-item">
                <div class="ids__space XL" style="background-color: rgba(var(--ids__accent-RGB), 0.1);"></div>
              </div>
              <div class="ids__sequence-item">                
                <div class="ids__space XL" style="background-color: rgba(var(--ids__accent-RGB), 0.1);"></div>
              </div>
              <div class="ids__sequence-item">                
                <div class="ids__space XL" style="background-color: rgba(var(--ids__accent-RGB), 0.1);"></div>
              </div>              
            </div>
            
            <div class="ids__space S"></div> 
            <p><code>ids__sequence.S</code></p>
                        
            <div class="ids__sequence S gap-S">
              <div class="ids__sequence-item">
                <div class="ids__space XL" style="background-color: rgba(var(--ids__accent-RGB), 0.1);"></div>
              </div>
              <div class="ids__sequence-item">                
                <div class="ids__space XL" style="background-color: rgba(var(--ids__accent-RGB), 0.1);"></div>
              </div>
              <div class="ids__sequence-item">                
                <div class="ids__space XL" style="background-color: rgba(var(--ids__accent-RGB), 0.1);"></div>
              </div>
              <div class="ids__sequence-item">                
                <div class="ids__space XL" style="background-color: rgba(var(--ids__accent-RGB), 0.1);"></div>
              </div>
              <div class="ids__sequence-item">                
                <div class="ids__space XL" style="background-color: rgba(var(--ids__accent-RGB), 0.1);"></div>
              </div>
              <div class="ids__sequence-item">                
                <div class="ids__space XL" style="background-color: rgba(var(--ids__accent-RGB), 0.1);"></div>
              </div>
            </div>


            <div class="ids__space S"></div>

            <h4>Отступы между ячейками</h4>
            <p>С помошью модификатора <code>gap</code> можно задавать отступы между ячейками:</p>
            <p><code>.ids__sequence.XL.gap-L</code></p>
            <div class="example-container" style="background-color: rgb(255,235,237); padding-bottom: 0.001em;">
              <div class="ids__sequence XL gap-L">
                <div class="ids__sequence-item">
                  <div class="ids__space XL" style="background-color: rgb(255,218,221);"></div>
                </div>
                <div class="ids__sequence-item">                
                  <div class="ids__space XL" style="background-color: rgb(255,218,221);"></div>
                </div>
                <div class="ids__sequence-item">                
                  <div class="ids__space XL" style="background-color: rgb(255,218,221);"></div>
                </div>
                <div class="ids__sequence-item">                
                  <div class="ids__space XL" style="background-color: rgb(255,218,221);"></div>
                </div>
              </div>
            </div>              
            <div class="ids__space M"></div>

            <p><code>.ids__sequence.XL.gap-M</code></p>
            <div class="example-container" style="background-color: rgb(255,235,237); padding-bottom: 0.001em;">
              <div class="ids__sequence XL gap-M">
                <div class="ids__sequence-item">
                  <div class="ids__space XL" style="background-color: rgb(255,218,221);"></div>
                </div>
                <div class="ids__sequence-item">                
                  <div class="ids__space XL" style="background-color: rgb(255,218,221);"></div>
                </div>
                <div class="ids__sequence-item">                
                  <div class="ids__space XL" style="background-color: rgb(255,218,221);"></div>
                </div>
                <div class="ids__sequence-item">                
                  <div class="ids__space XL" style="background-color: rgb(255,218,221);"></div>
                </div>
              </div>
            </div>
            
            <div class="ids__space S"></div>
            
            <p><code>.ids__sequence.XL.gap-S</code></p> 
            <div class="example-container" style="background-color: rgb(255,235,237); padding-bottom: 0.001em;">
              <div class="ids__sequence XL gap-S">
                <div class="ids__sequence-item">
                  <div class="ids__space XL" style="background-color: rgb(255,218,221);"></div>
                </div>
                <div class="ids__sequence-item">                
                  <div class="ids__space XL" style="background-color: rgb(255,218,221);"></div>
                </div>
                <div class="ids__sequence-item">                
                  <div class="ids__space XL" style="background-color: rgb(255,218,221);"></div>
                </div>
                <div class="ids__sequence-item">                
                  <div class="ids__space XL" style="background-color: rgb(255,218,221);"></div>
                </div>
              </div>
            </div>            
          </div>
        </div>
        
        <div class="ids__space M"></div>
        
        <div class="section">
          <div class="ids__space"></div>
          <div class="ids__text-width">
            <h3>Таблица</h3>
            <p><code>table</code> — обычная таблица</p>
            <p><code>tr</code>, <code>th</code>, <code>td</code> — стандартные элементы таблицы. Ну разве что <code>th</code> приклеивается к верху окна.</p>
          </div>
        </div>

        <div class="section">
          <div class="ids__space L"></div>
          <ids-nav-item id="components" text="Компоненты"><h2>Компоненты</h2></ids-nav-item>
        </div>

        <div class="section">
          <div class="ids__space"></div>
          <h3><code>.ids__snooze</code></h3>
        </div>

        <div class="section">
          <div class="ids__space"></div>
          <h3><code>.ids__footnote</code></h3>
        </div>

        <div class="section">
          <div class="ids__space"></div>
          <h3><code>.ids__navbar</code></h3>
        </div>
        <div class="section">
          <div class="ids__space"></div>
          <h3>Галерея</h3>
          <p><code>ids-gallery</code> — специальный тег для Галереи. </p>
          <p>Для разделения изображений используем тег <code>figure</code>.</p>
          <p><code>a</code> содержит ссылку на полноразмерное изображение.
            Если оно отличается от того, которое используется для превью,
            ему нужно указать размеры в атрибутах <code>data-pswp-width</code>
            и <code>data-pswp-height</code>
          </p>
          <div class="ids__space XL"></div>
        </div>
      </div>
      <div class="ids__wrapper wide">
        <div class="section">
          <ids-gallery>
            <figure>
              <a href="https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/pokemon/1.png">
                <img src="https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/pokemon/1.png" alt="bulbasaur">
              </a>
            </figure>
            <figure>
              <a href="https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/pokemon/2.png"
                 data-pswp-width="960"
                 data-pswp-height="960"
              >
                <img src="https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/pokemon/2.png" alt="ivysaur">
              </a>
            </figure>
            <figure>
              <a href="https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/pokemon/3.png">
                <img src="https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/pokemon/3.png" alt="venusaur">
              </a>
            </figure>
            <figure>
              <a href="https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/pokemon/4.png">
                <img src="https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/pokemon/4.png" alt="charmander">
              </a>
            </figure>
            <figure>
              <a href="https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/pokemon/5.png">
                <img src="https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/pokemon/5.png" alt="charmeleon">
              </a>
            </figure>
            <figure>
              <a href="https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/pokemon/6.png">
                <img src="https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/pokemon/6.png" alt="charizard">
              </a>
            </figure>
            <figure>
              <a href="https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/pokemon/7.png">
                <img src="https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/pokemon/7.png" alt="squirtle">
              </a>
            </figure>
            <figure>
              <a href="https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/pokemon/8.png">
                <img src="https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/pokemon/8.png" alt="wartortle">
              </a>
            </figure>
            <figure>
              <a href="https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/pokemon/9.png">
                <img src="https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/pokemon/9.png" alt="blastoise">
              </a>
            </figure>
            <figure>
              <a href="https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/pokemon/10.png">
                <img src="https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/pokemon/10.png" alt="caterpie">
              </a>
            </figure>
            <figure>
              <a href="https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/pokemon/11.png">
                <img src="https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/pokemon/11.png" alt="metapod">
              </a>
            </figure>
            <figure>
              <a href="https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/pokemon/12.png">
                <img src="https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/pokemon/12.png" alt="butterfree">
              </a>
            </figure>
            <figure>
              <a href="https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/pokemon/13.png">
                <img src="https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/pokemon/13.png" alt="weedle">
              </a>
            </figure>
            <figure>
              <a href="https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/pokemon/14.png">
                <img src="https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/pokemon/14.png" alt="kakuna">
              </a>
            </figure>
            <figure>
              <a href="https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/pokemon/15.png">
                <img src="https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/pokemon/15.png" alt="beedrill">
              </a>
            </figure>
            <figure>
              <a href="https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/pokemon/16.png">
                <img src="https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/pokemon/16.png" alt="pidgey">
              </a>
            </figure>
            <figure>
              <a href="https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/pokemon/17.png">
                <img src="https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/pokemon/17.png" alt="pidgeotto">
              </a>
            </figure>
            <figure>
              <a href="https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/pokemon/18.png">
                <img src="https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/pokemon/18.png" alt="pidgeot" >
              </a>
            </figure>
            <figure>
              <a href="https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/pokemon/19.png">
                <img src="https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/pokemon/19.png" alt="ratata">
              </a>
            </figure>
            <figure>
              <a href="https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/pokemon/20.png">
                <img src="https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/pokemon/20.png" alt="raticate">
              </a>
            </figure>
          </ids-gallery>
        </div>
        <div class="ids__space XL"></div>
      </div>

    </main>
  

    <!-- Encoded with base64 versions of libraries -->
    <script type="importmap">
      {
        "imports": {
          "photoswipe": "data:text/javascript;base64,LyohCiAgKiBQaG90b1N3aXBlIDUuNC40IC0gaHR0cHM6Ly9waG90b3N3aXBlLmNvbQogICogKGMpIDIwMjQgRG15dHJvIFNlbWVub3YKICAqLwpmdW5jdGlvbiB0KHQsaSxzKXtjb25zdCBoPWRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoaSk7cmV0dXJuIHQmJihoLmNsYXNzTmFtZT10KSxzJiZzLmFwcGVuZENoaWxkKGgpLGh9ZnVuY3Rpb24gaSh0LGkpe3JldHVybiB0Lng9aS54LHQueT1pLnksdm9pZCAwIT09aS5pZCYmKHQuaWQ9aS5pZCksdH1mdW5jdGlvbiBzKHQpe3QueD1NYXRoLnJvdW5kKHQueCksdC55PU1hdGgucm91bmQodC55KX1mdW5jdGlvbiBoKHQsaSl7Y29uc3Qgcz1NYXRoLmFicyh0LngtaS54KSxoPU1hdGguYWJzKHQueS1pLnkpO3JldHVybiBNYXRoLnNxcnQocypzK2gqaCl9ZnVuY3Rpb24gZSh0LGkpe3JldHVybiB0Lng9PT1pLngmJnQueT09PWkueX1mdW5jdGlvbiBuKHQsaSxzKXtyZXR1cm4gTWF0aC5taW4oTWF0aC5tYXgodCxpKSxzKX1mdW5jdGlvbiBvKHQsaSxzKXtsZXQgaD1gdHJhbnNsYXRlM2QoJHt0fXB4LCR7aXx8MH1weCwwKWA7cmV0dXJuIHZvaWQgMCE9PXMmJihoKz1gIHNjYWxlM2QoJHtzfSwke3N9LDEpYCksaH1mdW5jdGlvbiByKHQsaSxzLGgpe3Quc3R5bGUudHJhbnNmb3JtPW8oaSxzLGgpfWZ1bmN0aW9uIGEodCxpLHMsaCl7dC5zdHlsZS50cmFuc2l0aW9uPWk/YCR7aX0gJHtzfW1zICR7aHx8ImN1YmljLWJlemllciguNCwwLC4yMiwxKSJ9YDoibm9uZSJ9ZnVuY3Rpb24gbCh0LGkscyl7dC5zdHlsZS53aWR0aD0ibnVtYmVyIj09dHlwZW9mIGk/YCR7aX1weGA6aSx0LnN0eWxlLmhlaWdodD0ibnVtYmVyIj09dHlwZW9mIHM/YCR7c31weGA6c31jb25zdCBjPSJpZGxlIixkPSJsb2FkaW5nIix1PSJsb2FkZWQiLHA9ImVycm9yIjtmdW5jdGlvbiBtKCl7cmV0dXJuISghbmF2aWdhdG9yLnZlbmRvcnx8IW5hdmlnYXRvci52ZW5kb3IubWF0Y2goL2FwcGxlL2kpKX1sZXQgdj0hMTt0cnl7d2luZG93LmFkZEV2ZW50TGlzdGVuZXIoInRlc3QiLG51bGwsT2JqZWN0LmRlZmluZVByb3BlcnR5KHt9LCJwYXNzaXZlIix7Z2V0OigpPT57dj0hMH19KSl9Y2F0Y2godCl7fWNsYXNzIGZ7Y29uc3RydWN0b3IoKXt0aGlzLnQ9W119YWRkKHQsaSxzLGgpe3RoaXMuaSh0LGkscyxoKX1yZW1vdmUodCxpLHMsaCl7dGhpcy5pKHQsaSxzLGgsITApfXJlbW92ZUFsbCgpe3RoaXMudC5mb3JFYWNoKCh0PT57dGhpcy5pKHQudGFyZ2V0LHQudHlwZSx0Lmxpc3RlbmVyLHQucGFzc2l2ZSwhMCwhMCl9KSksdGhpcy50PVtdfWkodCxpLHMsaCxlLG4pe2lmKCF0KXJldHVybjtjb25zdCBvPWU/InJlbW92ZUV2ZW50TGlzdGVuZXIiOiJhZGRFdmVudExpc3RlbmVyIjtpLnNwbGl0KCIgIikuZm9yRWFjaCgoaT0+e2lmKGkpe258fChlP3RoaXMudD10aGlzLnQuZmlsdGVyKChoPT5oLnR5cGUhPT1pfHxoLmxpc3RlbmVyIT09c3x8aC50YXJnZXQhPT10KSk6dGhpcy50LnB1c2goe3RhcmdldDp0LHR5cGU6aSxsaXN0ZW5lcjpzLHBhc3NpdmU6aH0pKTtjb25zdCByPSEhdiYme3Bhc3NpdmU6aHx8ITF9O3Rbb10oaSxzLHIpfX0pKX19ZnVuY3Rpb24gdyh0LGkpe2lmKHQuZ2V0Vmlld3BvcnRTaXplRm4pe2NvbnN0IHM9dC5nZXRWaWV3cG9ydFNpemVGbih0LGkpO2lmKHMpcmV0dXJuIHN9cmV0dXJue3g6ZG9jdW1lbnQuZG9jdW1lbnRFbGVtZW50LmNsaWVudFdpZHRoLHk6d2luZG93LmlubmVySGVpZ2h0fX1mdW5jdGlvbiBnKHQsaSxzLGgsZSl7bGV0IG49MDtpZihpLnBhZGRpbmdGbiluPWkucGFkZGluZ0ZuKHMsaCxlKVt0XTtlbHNlIGlmKGkucGFkZGluZyluPWkucGFkZGluZ1t0XTtlbHNle2NvbnN0IHM9InBhZGRpbmciK3RbMF0udG9VcHBlckNhc2UoKSt0LnNsaWNlKDEpO2lbc10mJihuPWlbc10pfXJldHVybiBOdW1iZXIobil8fDB9ZnVuY3Rpb24geSh0LGkscyxoKXtyZXR1cm57eDppLngtZygibGVmdCIsdCxpLHMsaCktZygicmlnaHQiLHQsaSxzLGgpLHk6aS55LWcoInRvcCIsdCxpLHMsaCktZygiYm90dG9tIix0LGkscyxoKX19Y2xhc3MgX3tjb25zdHJ1Y3Rvcih0KXt0aGlzLnNsaWRlPXQsdGhpcy5jdXJyWm9vbUxldmVsPTEsdGhpcy5jZW50ZXI9e3g6MCx5OjB9LHRoaXMubWF4PXt4OjAseTowfSx0aGlzLm1pbj17eDowLHk6MH19dXBkYXRlKHQpe3RoaXMuY3Vyclpvb21MZXZlbD10LHRoaXMuc2xpZGUud2lkdGg/KHRoaXMubygieCIpLHRoaXMubygieSIpLHRoaXMuc2xpZGUucHN3cC5kaXNwYXRjaCgiY2FsY0JvdW5kcyIse3NsaWRlOnRoaXMuc2xpZGV9KSk6dGhpcy5yZXNldCgpfW8odCl7Y29uc3R7cHN3cDppfT10aGlzLnNsaWRlLHM9dGhpcy5zbGlkZVsieCI9PT10PyJ3aWR0aCI6ImhlaWdodCJdKnRoaXMuY3Vyclpvb21MZXZlbCxoPWcoIngiPT09dD8ibGVmdCI6InRvcCIsaS5vcHRpb25zLGkudmlld3BvcnRTaXplLHRoaXMuc2xpZGUuZGF0YSx0aGlzLnNsaWRlLmluZGV4KSxlPXRoaXMuc2xpZGUucGFuQXJlYVNpemVbdF07dGhpcy5jZW50ZXJbdF09TWF0aC5yb3VuZCgoZS1zKS8yKStoLHRoaXMubWF4W3RdPXM+ZT9NYXRoLnJvdW5kKGUtcykraDp0aGlzLmNlbnRlclt0XSx0aGlzLm1pblt0XT1zPmU/aDp0aGlzLmNlbnRlclt0XX1yZXNldCgpe3RoaXMuY2VudGVyLng9MCx0aGlzLmNlbnRlci55PTAsdGhpcy5tYXgueD0wLHRoaXMubWF4Lnk9MCx0aGlzLm1pbi54PTAsdGhpcy5taW4ueT0wfWNvcnJlY3RQYW4odCxpKXtyZXR1cm4gbihpLHRoaXMubWF4W3RdLHRoaXMubWluW3RdKX19Y2xhc3MgeHtjb25zdHJ1Y3Rvcih0LGkscyxoKXt0aGlzLnBzd3A9aCx0aGlzLm9wdGlvbnM9dCx0aGlzLml0ZW1EYXRhPWksdGhpcy5pbmRleD1zLHRoaXMucGFuQXJlYVNpemU9bnVsbCx0aGlzLmVsZW1lbnRTaXplPW51bGwsdGhpcy5maXQ9MSx0aGlzLmZpbGw9MSx0aGlzLnZGaWxsPTEsdGhpcy5pbml0aWFsPTEsdGhpcy5zZWNvbmRhcnk9MSx0aGlzLm1heD0xLHRoaXMubWluPTF9dXBkYXRlKHQsaSxzKXtjb25zdCBoPXt4OnQseTppfTt0aGlzLmVsZW1lbnRTaXplPWgsdGhpcy5wYW5BcmVhU2l6ZT1zO2NvbnN0IGU9cy54L2gueCxuPXMueS9oLnk7dGhpcy5maXQ9TWF0aC5taW4oMSxlPG4/ZTpuKSx0aGlzLmZpbGw9TWF0aC5taW4oMSxlPm4/ZTpuKSx0aGlzLnZGaWxsPU1hdGgubWluKDEsbiksdGhpcy5pbml0aWFsPXRoaXMubCgpLHRoaXMuc2Vjb25kYXJ5PXRoaXMudSgpLHRoaXMubWF4PU1hdGgubWF4KHRoaXMuaW5pdGlhbCx0aGlzLnNlY29uZGFyeSx0aGlzLnAoKSksdGhpcy5taW49TWF0aC5taW4odGhpcy5maXQsdGhpcy5pbml0aWFsLHRoaXMuc2Vjb25kYXJ5KSx0aGlzLnBzd3AmJnRoaXMucHN3cC5kaXNwYXRjaCgiem9vbUxldmVsc1VwZGF0ZSIse3pvb21MZXZlbHM6dGhpcyxzbGlkZURhdGE6dGhpcy5pdGVtRGF0YX0pfW0odCl7Y29uc3QgaT10KyJab29tTGV2ZWwiLHM9dGhpcy5vcHRpb25zW2ldO2lmKHMpcmV0dXJuImZ1bmN0aW9uIj09dHlwZW9mIHM/cyh0aGlzKToiZmlsbCI9PT1zP3RoaXMuZmlsbDoiZml0Ij09PXM/dGhpcy5maXQ6TnVtYmVyKHMpfXUoKXtsZXQgdD10aGlzLm0oInNlY29uZGFyeSIpO3JldHVybiB0fHwodD1NYXRoLm1pbigxLDMqdGhpcy5maXQpLHRoaXMuZWxlbWVudFNpemUmJnQqdGhpcy5lbGVtZW50U2l6ZS54PjRlMyYmKHQ9NGUzL3RoaXMuZWxlbWVudFNpemUueCksdCl9bCgpe3JldHVybiB0aGlzLm0oImluaXRpYWwiKXx8dGhpcy5maXR9cCgpe3JldHVybiB0aGlzLm0oIm1heCIpfHxNYXRoLm1heCgxLDQqdGhpcy5maXQpfX1jbGFzcyBie2NvbnN0cnVjdG9yKGkscyxoKXt0aGlzLmRhdGE9aSx0aGlzLmluZGV4PXMsdGhpcy5wc3dwPWgsdGhpcy5pc0FjdGl2ZT1zPT09aC5jdXJySW5kZXgsdGhpcy5jdXJyZW50UmVzb2x1dGlvbj0wLHRoaXMucGFuQXJlYVNpemU9e3g6MCx5OjB9LHRoaXMucGFuPXt4OjAseTowfSx0aGlzLmlzRmlyc3RTbGlkZT10aGlzLmlzQWN0aXZlJiYhaC5vcGVuZXIuaXNPcGVuLHRoaXMuem9vbUxldmVscz1uZXcgeChoLm9wdGlvbnMsaSxzLGgpLHRoaXMucHN3cC5kaXNwYXRjaCgiZ2V0dGluZ0RhdGEiLHtzbGlkZTp0aGlzLGRhdGE6dGhpcy5kYXRhLGluZGV4OnN9KSx0aGlzLmNvbnRlbnQ9dGhpcy5wc3dwLmNvbnRlbnRMb2FkZXIuZ2V0Q29udGVudEJ5U2xpZGUodGhpcyksdGhpcy5jb250YWluZXI9dCgicHN3cF9fem9vbS13cmFwIiwiZGl2IiksdGhpcy5ob2xkZXJFbGVtZW50PW51bGwsdGhpcy5jdXJyWm9vbUxldmVsPTEsdGhpcy53aWR0aD10aGlzLmNvbnRlbnQud2lkdGgsdGhpcy5oZWlnaHQ9dGhpcy5jb250ZW50LmhlaWdodCx0aGlzLmhlYXZ5QXBwZW5kZWQ9ITEsdGhpcy5ib3VuZHM9bmV3IF8odGhpcyksdGhpcy5wcmV2RGlzcGxheWVkV2lkdGg9LTEsdGhpcy5wcmV2RGlzcGxheWVkSGVpZ2h0PS0xLHRoaXMucHN3cC5kaXNwYXRjaCgic2xpZGVJbml0Iix7c2xpZGU6dGhpc30pfXNldElzQWN0aXZlKHQpe3QmJiF0aGlzLmlzQWN0aXZlP3RoaXMuYWN0aXZhdGUoKTohdCYmdGhpcy5pc0FjdGl2ZSYmdGhpcy5kZWFjdGl2YXRlKCl9YXBwZW5kKHQpe3RoaXMuaG9sZGVyRWxlbWVudD10LHRoaXMuY29udGFpbmVyLnN0eWxlLnRyYW5zZm9ybU9yaWdpbj0iMCAwIix0aGlzLmRhdGEmJih0aGlzLmNhbGN1bGF0ZVNpemUoKSx0aGlzLmxvYWQoKSx0aGlzLnVwZGF0ZUNvbnRlbnRTaXplKCksdGhpcy5hcHBlbmRIZWF2eSgpLHRoaXMuaG9sZGVyRWxlbWVudC5hcHBlbmRDaGlsZCh0aGlzLmNvbnRhaW5lciksdGhpcy56b29tQW5kUGFuVG9Jbml0aWFsKCksdGhpcy5wc3dwLmRpc3BhdGNoKCJmaXJzdFpvb21QYW4iLHtzbGlkZTp0aGlzfSksdGhpcy5hcHBseUN1cnJlbnRab29tUGFuKCksdGhpcy5wc3dwLmRpc3BhdGNoKCJhZnRlclNldENvbnRlbnQiLHtzbGlkZTp0aGlzfSksdGhpcy5pc0FjdGl2ZSYmdGhpcy5hY3RpdmF0ZSgpKX1sb2FkKCl7dGhpcy5jb250ZW50LmxvYWQoITEpLHRoaXMucHN3cC5kaXNwYXRjaCgic2xpZGVMb2FkIix7c2xpZGU6dGhpc30pfWFwcGVuZEhlYXZ5KCl7Y29uc3R7cHN3cDp0fT10aGlzOyF0aGlzLmhlYXZ5QXBwZW5kZWQmJnQub3BlbmVyLmlzT3BlbiYmIXQubWFpblNjcm9sbC5pc1NoaWZ0ZWQoKSYmKHRoaXMuaXNBY3RpdmUsMSkmJih0aGlzLnBzd3AuZGlzcGF0Y2goImFwcGVuZEhlYXZ5Iix7c2xpZGU6dGhpc30pLmRlZmF1bHRQcmV2ZW50ZWR8fCh0aGlzLmhlYXZ5QXBwZW5kZWQ9ITAsdGhpcy5jb250ZW50LmFwcGVuZCgpLHRoaXMucHN3cC5kaXNwYXRjaCgiYXBwZW5kSGVhdnlDb250ZW50Iix7c2xpZGU6dGhpc30pKSl9YWN0aXZhdGUoKXt0aGlzLmlzQWN0aXZlPSEwLHRoaXMuYXBwZW5kSGVhdnkoKSx0aGlzLmNvbnRlbnQuYWN0aXZhdGUoKSx0aGlzLnBzd3AuZGlzcGF0Y2goInNsaWRlQWN0aXZhdGUiLHtzbGlkZTp0aGlzfSl9ZGVhY3RpdmF0ZSgpe3RoaXMuaXNBY3RpdmU9ITEsdGhpcy5jb250ZW50LmRlYWN0aXZhdGUoKSx0aGlzLmN1cnJab29tTGV2ZWwhPT10aGlzLnpvb21MZXZlbHMuaW5pdGlhbCYmdGhpcy5jYWxjdWxhdGVTaXplKCksdGhpcy5jdXJyZW50UmVzb2x1dGlvbj0wLHRoaXMuem9vbUFuZFBhblRvSW5pdGlhbCgpLHRoaXMuYXBwbHlDdXJyZW50Wm9vbVBhbigpLHRoaXMudXBkYXRlQ29udGVudFNpemUoKSx0aGlzLnBzd3AuZGlzcGF0Y2goInNsaWRlRGVhY3RpdmF0ZSIse3NsaWRlOnRoaXN9KX1kZXN0cm95KCl7dGhpcy5jb250ZW50Lmhhc1NsaWRlPSExLHRoaXMuY29udGVudC5yZW1vdmUoKSx0aGlzLmNvbnRhaW5lci5yZW1vdmUoKSx0aGlzLnBzd3AuZGlzcGF0Y2goInNsaWRlRGVzdHJveSIse3NsaWRlOnRoaXN9KX1yZXNpemUoKXt0aGlzLmN1cnJab29tTGV2ZWwhPT10aGlzLnpvb21MZXZlbHMuaW5pdGlhbCYmdGhpcy5pc0FjdGl2ZT8odGhpcy5jYWxjdWxhdGVTaXplKCksdGhpcy5ib3VuZHMudXBkYXRlKHRoaXMuY3Vyclpvb21MZXZlbCksdGhpcy5wYW5Ubyh0aGlzLnBhbi54LHRoaXMucGFuLnkpKToodGhpcy5jYWxjdWxhdGVTaXplKCksdGhpcy5jdXJyZW50UmVzb2x1dGlvbj0wLHRoaXMuem9vbUFuZFBhblRvSW5pdGlhbCgpLHRoaXMuYXBwbHlDdXJyZW50Wm9vbVBhbigpLHRoaXMudXBkYXRlQ29udGVudFNpemUoKSl9dXBkYXRlQ29udGVudFNpemUodCl7Y29uc3QgaT10aGlzLmN1cnJlbnRSZXNvbHV0aW9ufHx0aGlzLnpvb21MZXZlbHMuaW5pdGlhbDtpZighaSlyZXR1cm47Y29uc3Qgcz1NYXRoLnJvdW5kKHRoaXMud2lkdGgqaSl8fHRoaXMucHN3cC52aWV3cG9ydFNpemUueCxoPU1hdGgucm91bmQodGhpcy5oZWlnaHQqaSl8fHRoaXMucHN3cC52aWV3cG9ydFNpemUueTsodGhpcy5zaXplQ2hhbmdlZChzLGgpfHx0KSYmdGhpcy5jb250ZW50LnNldERpc3BsYXllZFNpemUocyxoKX1zaXplQ2hhbmdlZCh0LGkpe3JldHVybih0IT09dGhpcy5wcmV2RGlzcGxheWVkV2lkdGh8fGkhPT10aGlzLnByZXZEaXNwbGF5ZWRIZWlnaHQpJiYodGhpcy5wcmV2RGlzcGxheWVkV2lkdGg9dCx0aGlzLnByZXZEaXNwbGF5ZWRIZWlnaHQ9aSwhMCl9Z2V0UGxhY2Vob2xkZXJFbGVtZW50KCl7dmFyIHQ7cmV0dXJuIG51bGw9PT0odD10aGlzLmNvbnRlbnQucGxhY2Vob2xkZXIpfHx2b2lkIDA9PT10P3ZvaWQgMDp0LmVsZW1lbnR9em9vbVRvKHQsaSxoLGUpe2NvbnN0e3Bzd3A6b309dGhpcztpZighdGhpcy5pc1pvb21hYmxlKCl8fG8ubWFpblNjcm9sbC5pc1NoaWZ0ZWQoKSlyZXR1cm47by5kaXNwYXRjaCgiYmVmb3JlWm9vbVRvIix7ZGVzdFpvb21MZXZlbDp0LGNlbnRlclBvaW50OmksdHJhbnNpdGlvbkR1cmF0aW9uOmh9KSxvLmFuaW1hdGlvbnMuc3RvcEFsbFBhbigpO2NvbnN0IHI9dGhpcy5jdXJyWm9vbUxldmVsO2V8fCh0PW4odCx0aGlzLnpvb21MZXZlbHMubWluLHRoaXMuem9vbUxldmVscy5tYXgpKSx0aGlzLnNldFpvb21MZXZlbCh0KSx0aGlzLnBhbi54PXRoaXMuY2FsY3VsYXRlWm9vbVRvUGFuT2Zmc2V0KCJ4IixpLHIpLHRoaXMucGFuLnk9dGhpcy5jYWxjdWxhdGVab29tVG9QYW5PZmZzZXQoInkiLGkscikscyh0aGlzLnBhbik7Y29uc3QgYT0oKT0+e3RoaXMudih0KSx0aGlzLmFwcGx5Q3VycmVudFpvb21QYW4oKX07aD9vLmFuaW1hdGlvbnMuc3RhcnRUcmFuc2l0aW9uKHtpc1BhbjohMCxuYW1lOiJ6b29tVG8iLHRhcmdldDp0aGlzLmNvbnRhaW5lcix0cmFuc2Zvcm06dGhpcy5nZXRDdXJyZW50VHJhbnNmb3JtKCksb25Db21wbGV0ZTphLGR1cmF0aW9uOmgsZWFzaW5nOm8ub3B0aW9ucy5lYXNpbmd9KTphKCl9dG9nZ2xlWm9vbSh0KXt0aGlzLnpvb21Ubyh0aGlzLmN1cnJab29tTGV2ZWw9PT10aGlzLnpvb21MZXZlbHMuaW5pdGlhbD90aGlzLnpvb21MZXZlbHMuc2Vjb25kYXJ5OnRoaXMuem9vbUxldmVscy5pbml0aWFsLHQsdGhpcy5wc3dwLm9wdGlvbnMuem9vbUFuaW1hdGlvbkR1cmF0aW9uKX1zZXRab29tTGV2ZWwodCl7dGhpcy5jdXJyWm9vbUxldmVsPXQsdGhpcy5ib3VuZHMudXBkYXRlKHRoaXMuY3Vyclpvb21MZXZlbCl9Y2FsY3VsYXRlWm9vbVRvUGFuT2Zmc2V0KHQsaSxzKXtpZigwPT09dGhpcy5ib3VuZHMubWF4W3RdLXRoaXMuYm91bmRzLm1pblt0XSlyZXR1cm4gdGhpcy5ib3VuZHMuY2VudGVyW3RdO2l8fChpPXRoaXMucHN3cC5nZXRWaWV3cG9ydENlbnRlclBvaW50KCkpLHN8fChzPXRoaXMuem9vbUxldmVscy5pbml0aWFsKTtjb25zdCBoPXRoaXMuY3Vyclpvb21MZXZlbC9zO3JldHVybiB0aGlzLmJvdW5kcy5jb3JyZWN0UGFuKHQsKHRoaXMucGFuW3RdLWlbdF0pKmgraVt0XSl9cGFuVG8odCxpKXt0aGlzLnBhbi54PXRoaXMuYm91bmRzLmNvcnJlY3RQYW4oIngiLHQpLHRoaXMucGFuLnk9dGhpcy5ib3VuZHMuY29ycmVjdFBhbigieSIsaSksdGhpcy5hcHBseUN1cnJlbnRab29tUGFuKCl9aXNQYW5uYWJsZSgpe3JldHVybiBCb29sZWFuKHRoaXMud2lkdGgpJiZ0aGlzLmN1cnJab29tTGV2ZWw+dGhpcy56b29tTGV2ZWxzLmZpdH1pc1pvb21hYmxlKCl7cmV0dXJuIEJvb2xlYW4odGhpcy53aWR0aCkmJnRoaXMuY29udGVudC5pc1pvb21hYmxlKCl9YXBwbHlDdXJyZW50Wm9vbVBhbigpe3RoaXMuZyh0aGlzLnBhbi54LHRoaXMucGFuLnksdGhpcy5jdXJyWm9vbUxldmVsKSx0aGlzPT09dGhpcy5wc3dwLmN1cnJTbGlkZSYmdGhpcy5wc3dwLmRpc3BhdGNoKCJ6b29tUGFuVXBkYXRlIix7c2xpZGU6dGhpc30pfXpvb21BbmRQYW5Ub0luaXRpYWwoKXt0aGlzLmN1cnJab29tTGV2ZWw9dGhpcy56b29tTGV2ZWxzLmluaXRpYWwsdGhpcy5ib3VuZHMudXBkYXRlKHRoaXMuY3Vyclpvb21MZXZlbCksaSh0aGlzLnBhbix0aGlzLmJvdW5kcy5jZW50ZXIpLHRoaXMucHN3cC5kaXNwYXRjaCgiaW5pdGlhbFpvb21QYW4iLHtzbGlkZTp0aGlzfSl9Zyh0LGkscyl7cy89dGhpcy5jdXJyZW50UmVzb2x1dGlvbnx8dGhpcy56b29tTGV2ZWxzLmluaXRpYWwscih0aGlzLmNvbnRhaW5lcix0LGkscyl9Y2FsY3VsYXRlU2l6ZSgpe2NvbnN0e3Bzd3A6dH09dGhpcztpKHRoaXMucGFuQXJlYVNpemUseSh0Lm9wdGlvbnMsdC52aWV3cG9ydFNpemUsdGhpcy5kYXRhLHRoaXMuaW5kZXgpKSx0aGlzLnpvb21MZXZlbHMudXBkYXRlKHRoaXMud2lkdGgsdGhpcy5oZWlnaHQsdGhpcy5wYW5BcmVhU2l6ZSksdC5kaXNwYXRjaCgiY2FsY1NsaWRlU2l6ZSIse3NsaWRlOnRoaXN9KX1nZXRDdXJyZW50VHJhbnNmb3JtKCl7Y29uc3QgdD10aGlzLmN1cnJab29tTGV2ZWwvKHRoaXMuY3VycmVudFJlc29sdXRpb258fHRoaXMuem9vbUxldmVscy5pbml0aWFsKTtyZXR1cm4gbyh0aGlzLnBhbi54LHRoaXMucGFuLnksdCl9dih0KXt0IT09dGhpcy5jdXJyZW50UmVzb2x1dGlvbiYmKHRoaXMuY3VycmVudFJlc29sdXRpb249dCx0aGlzLnVwZGF0ZUNvbnRlbnRTaXplKCksdGhpcy5wc3dwLmRpc3BhdGNoKCJyZXNvbHV0aW9uQ2hhbmdlZCIpKX19Y2xhc3MgU3tjb25zdHJ1Y3Rvcih0KXt0aGlzLmdlc3R1cmVzPXQsdGhpcy5wc3dwPXQucHN3cCx0aGlzLnN0YXJ0UGFuPXt4OjAseTowfX1zdGFydCgpe3RoaXMucHN3cC5jdXJyU2xpZGUmJmkodGhpcy5zdGFydFBhbix0aGlzLnBzd3AuY3VyclNsaWRlLnBhbiksdGhpcy5wc3dwLmFuaW1hdGlvbnMuc3RvcEFsbCgpfWNoYW5nZSgpe2NvbnN0e3AxOnQscHJldlAxOmksZHJhZ0F4aXM6aH09dGhpcy5nZXN0dXJlcyx7Y3VyclNsaWRlOmV9PXRoaXMucHN3cDtpZigieSI9PT1oJiZ0aGlzLnBzd3Aub3B0aW9ucy5jbG9zZU9uVmVydGljYWxEcmFnJiZlJiZlLmN1cnJab29tTGV2ZWw8PWUuem9vbUxldmVscy5maXQmJiF0aGlzLmdlc3R1cmVzLmlzTXVsdGl0b3VjaCl7Y29uc3Qgcz1lLnBhbi55Kyh0LnktaS55KTtpZighdGhpcy5wc3dwLmRpc3BhdGNoKCJ2ZXJ0aWNhbERyYWciLHtwYW5ZOnN9KS5kZWZhdWx0UHJldmVudGVkKXt0aGlzLl8oInkiLHMsLjYpO2NvbnN0IHQ9MS1NYXRoLmFicyh0aGlzLlMoZS5wYW4ueSkpO3RoaXMucHN3cC5hcHBseUJnT3BhY2l0eSh0KSxlLmFwcGx5Q3VycmVudFpvb21QYW4oKX19ZWxzZXt0aGlzLk0oIngiKXx8KHRoaXMuTSgieSIpLGUmJihzKGUucGFuKSxlLmFwcGx5Q3VycmVudFpvb21QYW4oKSkpfX1lbmQoKXtjb25zdHt2ZWxvY2l0eTp0fT10aGlzLmdlc3R1cmVzLHttYWluU2Nyb2xsOmksY3VyclNsaWRlOnN9PXRoaXMucHN3cDtsZXQgaD0wO2lmKHRoaXMucHN3cC5hbmltYXRpb25zLnN0b3BBbGwoKSxpLmlzU2hpZnRlZCgpKXtjb25zdCBzPShpLngtaS5nZXRDdXJyU2xpZGVYKCkpL3RoaXMucHN3cC52aWV3cG9ydFNpemUueDt0Lng8LS41JiZzPDB8fHQueDwuMSYmczwtLjU/KGg9MSx0Lng9TWF0aC5taW4odC54LDApKToodC54Pi41JiZzPjB8fHQueD4tLjEmJnM+LjUpJiYoaD0tMSx0Lng9TWF0aC5tYXgodC54LDApKSxpLm1vdmVJbmRleEJ5KGgsITAsdC54KX1zJiZzLmN1cnJab29tTGV2ZWw+cy56b29tTGV2ZWxzLm1heHx8dGhpcy5nZXN0dXJlcy5pc011bHRpdG91Y2g/dGhpcy5nZXN0dXJlcy56b29tTGV2ZWxzLmNvcnJlY3Rab29tUGFuKCEwKToodGhpcy5QKCJ4IiksdGhpcy5QKCJ5IikpfVAodCl7Y29uc3R7dmVsb2NpdHk6aX09dGhpcy5nZXN0dXJlcyx7Y3VyclNsaWRlOnN9PXRoaXMucHN3cDtpZighcylyZXR1cm47Y29uc3R7cGFuOmgsYm91bmRzOmV9PXMsbz1oW3RdLHI9dGhpcy5wc3dwLmJnT3BhY2l0eTwxJiYieSI9PT10LGE9bytmdW5jdGlvbih0LGkpe3JldHVybiB0KmkvKDEtaSl9KGlbdF0sLjk5NSk7aWYocil7Y29uc3QgdD10aGlzLlMobyksaT10aGlzLlMoYSk7aWYodDwwJiZpPC0uNHx8dD4wJiZpPi40KXJldHVybiB2b2lkIHRoaXMucHN3cC5jbG9zZSgpfWNvbnN0IGw9ZS5jb3JyZWN0UGFuKHQsYSk7aWYobz09PWwpcmV0dXJuO2NvbnN0IGM9bD09PWE/MTouODIsZD10aGlzLnBzd3AuYmdPcGFjaXR5LHU9bC1vO3RoaXMucHN3cC5hbmltYXRpb25zLnN0YXJ0U3ByaW5nKHtuYW1lOiJwYW5HZXN0dXJlIit0LGlzUGFuOiEwLHN0YXJ0Om8sZW5kOmwsdmVsb2NpdHk6aVt0XSxkYW1waW5nUmF0aW86YyxvblVwZGF0ZTppPT57aWYociYmdGhpcy5wc3dwLmJnT3BhY2l0eTwxKXtjb25zdCB0PTEtKGwtaSkvdTt0aGlzLnBzd3AuYXBwbHlCZ09wYWNpdHkobihkKygxLWQpKnQsMCwxKSl9aFt0XT1NYXRoLmZsb29yKGkpLHMuYXBwbHlDdXJyZW50Wm9vbVBhbigpfX0pfU0odCl7Y29uc3R7cDE6aSxkcmFnQXhpczpzLHByZXZQMTpoLGlzTXVsdGl0b3VjaDplfT10aGlzLmdlc3R1cmVzLHtjdXJyU2xpZGU6bixtYWluU2Nyb2xsOm99PXRoaXMucHN3cCxyPWlbdF0taFt0XSxhPW8ueCtyO2lmKCFyfHwhbilyZXR1cm4hMTtpZigieCI9PT10JiYhbi5pc1Bhbm5hYmxlKCkmJiFlKXJldHVybiBvLm1vdmVUbyhhLCEwKSwhMDtjb25zdHtib3VuZHM6bH09bixjPW4ucGFuW3RdK3I7aWYodGhpcy5wc3dwLm9wdGlvbnMuYWxsb3dQYW5Ub05leHQmJiJ4Ij09PXMmJiJ4Ij09PXQmJiFlKXtjb25zdCBpPW8uZ2V0Q3VyclNsaWRlWCgpLHM9by54LWksaD1yPjAsZT0haDtpZihjPmwubWluW3RdJiZoKXtpZihsLm1pblt0XTw9dGhpcy5zdGFydFBhblt0XSlyZXR1cm4gby5tb3ZlVG8oYSwhMCksITA7dGhpcy5fKHQsYyl9ZWxzZSBpZihjPGwubWF4W3RdJiZlKXtpZih0aGlzLnN0YXJ0UGFuW3RdPD1sLm1heFt0XSlyZXR1cm4gby5tb3ZlVG8oYSwhMCksITA7dGhpcy5fKHQsYyl9ZWxzZSBpZigwIT09cyl7aWYocz4wKXJldHVybiBvLm1vdmVUbyhNYXRoLm1heChhLGkpLCEwKSwhMDtpZihzPDApcmV0dXJuIG8ubW92ZVRvKE1hdGgubWluKGEsaSksITApLCEwfWVsc2UgdGhpcy5fKHQsYyl9ZWxzZSJ5Ij09PXQmJihvLmlzU2hpZnRlZCgpfHxsLm1pbi55PT09bC5tYXgueSl8fHRoaXMuXyh0LGMpO3JldHVybiExfVModCl7dmFyIGkscztyZXR1cm4odC0obnVsbCE9PShpPW51bGw9PT0ocz10aGlzLnBzd3AuY3VyclNsaWRlKXx8dm9pZCAwPT09cz92b2lkIDA6cy5ib3VuZHMuY2VudGVyLnkpJiZ2b2lkIDAhPT1pP2k6MCkpLyh0aGlzLnBzd3Audmlld3BvcnRTaXplLnkvMyl9Xyh0LGkscyl7Y29uc3R7Y3VyclNsaWRlOmh9PXRoaXMucHN3cDtpZighaClyZXR1cm47Y29uc3R7cGFuOmUsYm91bmRzOm59PWg7aWYobi5jb3JyZWN0UGFuKHQsaSkhPT1pfHxzKXtjb25zdCBoPU1hdGgucm91bmQoaS1lW3RdKTtlW3RdKz1oKihzfHwuMzUpfWVsc2UgZVt0XT1pfX1mdW5jdGlvbiB6KHQsaSxzKXtyZXR1cm4gdC54PShpLngrcy54KS8yLHQueT0oaS55K3MueSkvMix0fWNsYXNzIE17Y29uc3RydWN0b3IodCl7dGhpcy5nZXN0dXJlcz10LHRoaXMuQz17eDowLHk6MH0sdGhpcy5UPXt4OjAseTowfSx0aGlzLkE9e3g6MCx5OjB9LHRoaXMuRD0hMSx0aGlzLkk9MX1zdGFydCgpe2NvbnN0e2N1cnJTbGlkZTp0fT10aGlzLmdlc3R1cmVzLnBzd3A7dCYmKHRoaXMuST10LmN1cnJab29tTGV2ZWwsaSh0aGlzLkMsdC5wYW4pKSx0aGlzLmdlc3R1cmVzLnBzd3AuYW5pbWF0aW9ucy5zdG9wQWxsUGFuKCksdGhpcy5EPSExfWNoYW5nZSgpe2NvbnN0e3AxOnQsc3RhcnRQMTppLHAyOnMsc3RhcnRQMjplLHBzd3A6bn09dGhpcy5nZXN0dXJlcyx7Y3VyclNsaWRlOm99PW47aWYoIW8pcmV0dXJuO2NvbnN0IHI9by56b29tTGV2ZWxzLm1pbixhPW8uem9vbUxldmVscy5tYXg7aWYoIW8uaXNab29tYWJsZSgpfHxuLm1haW5TY3JvbGwuaXNTaGlmdGVkKCkpcmV0dXJuO3oodGhpcy5ULGksZSkseih0aGlzLkEsdCxzKTtsZXQgbD0xL2goaSxlKSpoKHQscykqdGhpcy5JO2lmKGw+by56b29tTGV2ZWxzLmluaXRpYWwrby56b29tTGV2ZWxzLmluaXRpYWwvMTUmJih0aGlzLkQ9ITApLGw8cilpZihuLm9wdGlvbnMucGluY2hUb0Nsb3NlJiYhdGhpcy5EJiZ0aGlzLkk8PW8uem9vbUxldmVscy5pbml0aWFsKXtjb25zdCB0PTEtKHItbCkvKHIvMS4yKTtuLmRpc3BhdGNoKCJwaW5jaENsb3NlIix7YmdPcGFjaXR5OnR9KS5kZWZhdWx0UHJldmVudGVkfHxuLmFwcGx5QmdPcGFjaXR5KHQpfWVsc2UgbD1yLS4xNSooci1sKTtlbHNlIGw+YSYmKGw9YSsuMDUqKGwtYSkpO28ucGFuLng9dGhpcy5MKCJ4IixsKSxvLnBhbi55PXRoaXMuTCgieSIsbCksby5zZXRab29tTGV2ZWwobCksby5hcHBseUN1cnJlbnRab29tUGFuKCl9ZW5kKCl7Y29uc3R7cHN3cDp0fT10aGlzLmdlc3R1cmVzLHtjdXJyU2xpZGU6aX09dDsoIWl8fGkuY3Vyclpvb21MZXZlbDxpLnpvb21MZXZlbHMuaW5pdGlhbCkmJiF0aGlzLkQmJnQub3B0aW9ucy5waW5jaFRvQ2xvc2U/dC5jbG9zZSgpOnRoaXMuY29ycmVjdFpvb21QYW4oKX1MKHQsaSl7Y29uc3Qgcz1pL3RoaXMuSTtyZXR1cm4gdGhpcy5BW3RdLSh0aGlzLlRbdF0tdGhpcy5DW3RdKSpzfWNvcnJlY3Rab29tUGFuKHQpe2NvbnN0e3Bzd3A6c309dGhpcy5nZXN0dXJlcyx7Y3VyclNsaWRlOmh9PXM7aWYobnVsbD09aHx8IWguaXNab29tYWJsZSgpKXJldHVybjswPT09dGhpcy5BLngmJih0PSEwKTtjb25zdCBvPWguY3Vyclpvb21MZXZlbDtsZXQgcixhPSEwO288aC56b29tTGV2ZWxzLmluaXRpYWw/cj1oLnpvb21MZXZlbHMuaW5pdGlhbDpvPmguem9vbUxldmVscy5tYXg/cj1oLnpvb21MZXZlbHMubWF4OihhPSExLHI9byk7Y29uc3QgbD1zLmJnT3BhY2l0eSxjPXMuYmdPcGFjaXR5PDEsZD1pKHt4OjAseTowfSxoLnBhbik7bGV0IHU9aSh7eDowLHk6MH0sZCk7dCYmKHRoaXMuQS54PTAsdGhpcy5BLnk9MCx0aGlzLlQueD0wLHRoaXMuVC55PTAsdGhpcy5JPW8saSh0aGlzLkMsZCkpLGEmJih1PXt4OnRoaXMuTCgieCIscikseTp0aGlzLkwoInkiLHIpfSksaC5zZXRab29tTGV2ZWwociksdT17eDpoLmJvdW5kcy5jb3JyZWN0UGFuKCJ4Iix1LngpLHk6aC5ib3VuZHMuY29ycmVjdFBhbigieSIsdS55KX0saC5zZXRab29tTGV2ZWwobyk7Y29uc3QgcD0hZSh1LGQpO2lmKCFwJiYhYSYmIWMpcmV0dXJuIGgudihyKSx2b2lkIGguYXBwbHlDdXJyZW50Wm9vbVBhbigpO3MuYW5pbWF0aW9ucy5zdG9wQWxsUGFuKCkscy5hbmltYXRpb25zLnN0YXJ0U3ByaW5nKHtpc1BhbjohMCxzdGFydDowLGVuZDoxZTMsdmVsb2NpdHk6MCxkYW1waW5nUmF0aW86MSxuYXR1cmFsRnJlcXVlbmN5OjQwLG9uVXBkYXRlOnQ9PntpZih0Lz0xZTMscHx8YSl7aWYocCYmKGgucGFuLng9ZC54Kyh1LngtZC54KSp0LGgucGFuLnk9ZC55Kyh1LnktZC55KSp0KSxhKXtjb25zdCBpPW8rKHItbykqdDtoLnNldFpvb21MZXZlbChpKX1oLmFwcGx5Q3VycmVudFpvb21QYW4oKX1jJiZzLmJnT3BhY2l0eTwxJiZzLmFwcGx5QmdPcGFjaXR5KG4obCsoMS1sKSp0LDAsMSkpfSxvbkNvbXBsZXRlOigpPT57aC52KHIpLGguYXBwbHlDdXJyZW50Wm9vbVBhbigpfX0pfX1mdW5jdGlvbiBQKHQpe3JldHVybiEhdC50YXJnZXQuY2xvc2VzdCgiLnBzd3BfX2NvbnRhaW5lciIpfWNsYXNzIEN7Y29uc3RydWN0b3IodCl7dGhpcy5nZXN0dXJlcz10fWNsaWNrKHQsaSl7Y29uc3Qgcz1pLnRhcmdldC5jbGFzc0xpc3QsaD1zLmNvbnRhaW5zKCJwc3dwX19pbWciKSxlPXMuY29udGFpbnMoInBzd3BfX2l0ZW0iKXx8cy5jb250YWlucygicHN3cF9fem9vbS13cmFwIik7aD90aGlzLmsoImltYWdlQ2xpY2siLHQsaSk6ZSYmdGhpcy5rKCJiZ0NsaWNrIix0LGkpfXRhcCh0LGkpe1AoaSkmJnRoaXMuaygidGFwIix0LGkpfWRvdWJsZVRhcCh0LGkpe1AoaSkmJnRoaXMuaygiZG91YmxlVGFwIix0LGkpfWsodCxpLHMpe3ZhciBoO2NvbnN0e3Bzd3A6ZX09dGhpcy5nZXN0dXJlcyx7Y3VyclNsaWRlOm59PWUsbz10KyJBY3Rpb24iLHI9ZS5vcHRpb25zW29dO2lmKCFlLmRpc3BhdGNoKG8se3BvaW50Omksb3JpZ2luYWxFdmVudDpzfSkuZGVmYXVsdFByZXZlbnRlZClpZigiZnVuY3Rpb24iIT10eXBlb2Ygcilzd2l0Y2gocil7Y2FzZSJjbG9zZSI6Y2FzZSJuZXh0IjplW3JdKCk7YnJlYWs7Y2FzZSJ6b29tIjpudWxsPT1ufHxuLnRvZ2dsZVpvb20oaSk7YnJlYWs7Y2FzZSJ6b29tLW9yLWNsb3NlIjpudWxsIT1uJiZuLmlzWm9vbWFibGUoKSYmbi56b29tTGV2ZWxzLnNlY29uZGFyeSE9PW4uem9vbUxldmVscy5pbml0aWFsP24udG9nZ2xlWm9vbShpKTplLm9wdGlvbnMuY2xpY2tUb0Nsb3NlTm9uWm9vbWFibGUmJmUuY2xvc2UoKTticmVhaztjYXNlInRvZ2dsZS1jb250cm9scyI6bnVsbD09PShoPXRoaXMuZ2VzdHVyZXMucHN3cC5lbGVtZW50KXx8dm9pZCAwPT09aHx8aC5jbGFzc0xpc3QudG9nZ2xlKCJwc3dwLS11aS12aXNpYmxlIil9ZWxzZSByLmNhbGwoZSxpLHMpfX1jbGFzcyBUe2NvbnN0cnVjdG9yKHQpe3RoaXMucHN3cD10LHRoaXMuZHJhZ0F4aXM9bnVsbCx0aGlzLnAxPXt4OjAseTowfSx0aGlzLnAyPXt4OjAseTowfSx0aGlzLnByZXZQMT17eDowLHk6MH0sdGhpcy5wcmV2UDI9e3g6MCx5OjB9LHRoaXMuc3RhcnRQMT17eDowLHk6MH0sdGhpcy5zdGFydFAyPXt4OjAseTowfSx0aGlzLnZlbG9jaXR5PXt4OjAseTowfSx0aGlzLlo9e3g6MCx5OjB9LHRoaXMuQj17eDowLHk6MH0sdGhpcy5GPTAsdGhpcy5PPVtdLHRoaXMuUj0ib250b3VjaHN0YXJ0ImluIHdpbmRvdyx0aGlzLk49ISF3aW5kb3cuUG9pbnRlckV2ZW50LHRoaXMuc3VwcG9ydHNUb3VjaD10aGlzLlJ8fHRoaXMuTiYmbmF2aWdhdG9yLm1heFRvdWNoUG9pbnRzPjEsdGhpcy5GPTAsdGhpcy5VPTAsdGhpcy5WPSExLHRoaXMuaXNNdWx0aXRvdWNoPSExLHRoaXMuaXNEcmFnZ2luZz0hMSx0aGlzLmlzWm9vbWluZz0hMSx0aGlzLnJhZj1udWxsLHRoaXMuRz1udWxsLHRoaXMuc3VwcG9ydHNUb3VjaHx8KHQub3B0aW9ucy5hbGxvd1BhblRvTmV4dD0hMSksdGhpcy5kcmFnPW5ldyBTKHRoaXMpLHRoaXMuem9vbUxldmVscz1uZXcgTSh0aGlzKSx0aGlzLnRhcEhhbmRsZXI9bmV3IEModGhpcyksdC5vbigiYmluZEV2ZW50cyIsKCgpPT57dC5ldmVudHMuYWRkKHQuc2Nyb2xsV3JhcCwiY2xpY2siLHRoaXMuJC5iaW5kKHRoaXMpKSx0aGlzLk4/dGhpcy5xKCJwb2ludGVyIiwiZG93biIsInVwIiwiY2FuY2VsIik6dGhpcy5SPyh0aGlzLnEoInRvdWNoIiwic3RhcnQiLCJlbmQiLCJjYW5jZWwiKSx0LnNjcm9sbFdyYXAmJih0LnNjcm9sbFdyYXAub250b3VjaG1vdmU9KCk9Pnt9LHQuc2Nyb2xsV3JhcC5vbnRvdWNoZW5kPSgpPT57fSkpOnRoaXMucSgibW91c2UiLCJkb3duIiwidXAiKX0pKX1xKHQsaSxzLGgpe2NvbnN0e3Bzd3A6ZX09dGhpcyx7ZXZlbnRzOm59PWUsbz1oP3QraDoiIjtuLmFkZChlLnNjcm9sbFdyYXAsdCtpLHRoaXMub25Qb2ludGVyRG93bi5iaW5kKHRoaXMpKSxuLmFkZCh3aW5kb3csdCsibW92ZSIsdGhpcy5vblBvaW50ZXJNb3ZlLmJpbmQodGhpcykpLG4uYWRkKHdpbmRvdyx0K3MsdGhpcy5vblBvaW50ZXJVcC5iaW5kKHRoaXMpKSxvJiZuLmFkZChlLnNjcm9sbFdyYXAsbyx0aGlzLm9uUG9pbnRlclVwLmJpbmQodGhpcykpfW9uUG9pbnRlckRvd24odCl7Y29uc3Qgcz0ibW91c2Vkb3duIj09PXQudHlwZXx8Im1vdXNlIj09PXQucG9pbnRlclR5cGU7aWYocyYmdC5idXR0b24+MClyZXR1cm47Y29uc3R7cHN3cDpofT10aGlzO2gub3BlbmVyLmlzT3Blbj9oLmRpc3BhdGNoKCJwb2ludGVyRG93biIse29yaWdpbmFsRXZlbnQ6dH0pLmRlZmF1bHRQcmV2ZW50ZWR8fChzJiYoaC5tb3VzZURldGVjdGVkKCksdGhpcy5IKHQsImRvd24iKSksaC5hbmltYXRpb25zLnN0b3BBbGwoKSx0aGlzLksodCwiZG93biIpLDE9PT10aGlzLkYmJih0aGlzLmRyYWdBeGlzPW51bGwsaSh0aGlzLnN0YXJ0UDEsdGhpcy5wMSkpLHRoaXMuRj4xPyh0aGlzLlcoKSx0aGlzLmlzTXVsdGl0b3VjaD0hMCk6dGhpcy5pc011bHRpdG91Y2g9ITEpOnQucHJldmVudERlZmF1bHQoKX1vblBvaW50ZXJNb3ZlKHQpe3RoaXMuSCh0LCJtb3ZlIiksdGhpcy5GJiYodGhpcy5LKHQsIm1vdmUiKSx0aGlzLnBzd3AuZGlzcGF0Y2goInBvaW50ZXJNb3ZlIix7b3JpZ2luYWxFdmVudDp0fSkuZGVmYXVsdFByZXZlbnRlZHx8KDEhPT10aGlzLkZ8fHRoaXMuaXNEcmFnZ2luZz90aGlzLkY+MSYmIXRoaXMuaXNab29taW5nJiYodGhpcy5qKCksdGhpcy5pc1pvb21pbmc9ITAsdGhpcy5YKCksdGhpcy56b29tTGV2ZWxzLnN0YXJ0KCksdGhpcy5ZKCksdGhpcy5KKCkpOih0aGlzLmRyYWdBeGlzfHx0aGlzLnR0KCksdGhpcy5kcmFnQXhpcyYmIXRoaXMuaXNEcmFnZ2luZyYmKHRoaXMuaXNab29taW5nJiYodGhpcy5pc1pvb21pbmc9ITEsdGhpcy56b29tTGV2ZWxzLmVuZCgpKSx0aGlzLmlzRHJhZ2dpbmc9ITAsdGhpcy5XKCksdGhpcy5YKCksdGhpcy5VPURhdGUubm93KCksdGhpcy5WPSExLGkodGhpcy5CLHRoaXMucDEpLHRoaXMudmVsb2NpdHkueD0wLHRoaXMudmVsb2NpdHkueT0wLHRoaXMuZHJhZy5zdGFydCgpLHRoaXMuWSgpLHRoaXMuSigpKSkpKX1qKCl7dGhpcy5pc0RyYWdnaW5nJiYodGhpcy5pc0RyYWdnaW5nPSExLHRoaXMuVnx8dGhpcy5pdCghMCksdGhpcy5kcmFnLmVuZCgpLHRoaXMuZHJhZ0F4aXM9bnVsbCl9b25Qb2ludGVyVXAodCl7dGhpcy5GJiYodGhpcy5LKHQsInVwIiksdGhpcy5wc3dwLmRpc3BhdGNoKCJwb2ludGVyVXAiLHtvcmlnaW5hbEV2ZW50OnR9KS5kZWZhdWx0UHJldmVudGVkfHwoMD09PXRoaXMuRiYmKHRoaXMuWSgpLHRoaXMuaXNEcmFnZ2luZz90aGlzLmooKTp0aGlzLmlzWm9vbWluZ3x8dGhpcy5pc011bHRpdG91Y2h8fHRoaXMuc3QodCkpLHRoaXMuRjwyJiZ0aGlzLmlzWm9vbWluZyYmKHRoaXMuaXNab29taW5nPSExLHRoaXMuem9vbUxldmVscy5lbmQoKSwxPT09dGhpcy5GJiYodGhpcy5kcmFnQXhpcz1udWxsLHRoaXMuWCgpKSkpKX1KKCl7KHRoaXMuaXNEcmFnZ2luZ3x8dGhpcy5pc1pvb21pbmcpJiYodGhpcy5pdCgpLHRoaXMuaXNEcmFnZ2luZz9lKHRoaXMucDEsdGhpcy5wcmV2UDEpfHx0aGlzLmRyYWcuY2hhbmdlKCk6ZSh0aGlzLnAxLHRoaXMucHJldlAxKSYmZSh0aGlzLnAyLHRoaXMucHJldlAyKXx8dGhpcy56b29tTGV2ZWxzLmNoYW5nZSgpLHRoaXMuaHQoKSx0aGlzLnJhZj1yZXF1ZXN0QW5pbWF0aW9uRnJhbWUodGhpcy5KLmJpbmQodGhpcykpKX1pdCh0KXtjb25zdCBzPURhdGUubm93KCksaD1zLXRoaXMuVTtoPDUwJiYhdHx8KHRoaXMudmVsb2NpdHkueD10aGlzLmV0KCJ4IixoKSx0aGlzLnZlbG9jaXR5Lnk9dGhpcy5ldCgieSIsaCksdGhpcy5VPXMsaSh0aGlzLkIsdGhpcy5wMSksdGhpcy5WPSEwKX1zdCh0KXtjb25zdHttYWluU2Nyb2xsOnN9PXRoaXMucHN3cDtpZihzLmlzU2hpZnRlZCgpKXJldHVybiB2b2lkIHMubW92ZUluZGV4QnkoMCwhMCk7aWYodC50eXBlLmluZGV4T2YoImNhbmNlbCIpPjApcmV0dXJuO2lmKCJtb3VzZXVwIj09PXQudHlwZXx8Im1vdXNlIj09PXQucG9pbnRlclR5cGUpcmV0dXJuIHZvaWQgdGhpcy50YXBIYW5kbGVyLmNsaWNrKHRoaXMuc3RhcnRQMSx0KTtjb25zdCBlPXRoaXMucHN3cC5vcHRpb25zLmRvdWJsZVRhcEFjdGlvbj8zMDA6MDt0aGlzLkc/KHRoaXMuVygpLGgodGhpcy5aLHRoaXMuc3RhcnRQMSk8MjUmJnRoaXMudGFwSGFuZGxlci5kb3VibGVUYXAodGhpcy5zdGFydFAxLHQpKTooaSh0aGlzLlosdGhpcy5zdGFydFAxKSx0aGlzLkc9c2V0VGltZW91dCgoKCk9Pnt0aGlzLnRhcEhhbmRsZXIudGFwKHRoaXMuc3RhcnRQMSx0KSx0aGlzLlcoKX0pLGUpKX1XKCl7dGhpcy5HJiYoY2xlYXJUaW1lb3V0KHRoaXMuRyksdGhpcy5HPW51bGwpfWV0KHQsaSl7Y29uc3Qgcz10aGlzLnAxW3RdLXRoaXMuQlt0XTtyZXR1cm4gTWF0aC5hYnMocyk+MSYmaT41P3MvaTowfVkoKXt0aGlzLnJhZiYmKGNhbmNlbEFuaW1hdGlvbkZyYW1lKHRoaXMucmFmKSx0aGlzLnJhZj1udWxsKX1IKHQsaSl7dGhpcy5wc3dwLmFwcGx5RmlsdGVycygicHJldmVudFBvaW50ZXJFdmVudCIsITAsdCxpKSYmdC5wcmV2ZW50RGVmYXVsdCgpfUsodCxzKXtpZih0aGlzLk4pe2NvbnN0IGg9dCxlPXRoaXMuTy5maW5kSW5kZXgoKHQ9PnQuaWQ9PT1oLnBvaW50ZXJJZCkpOyJ1cCI9PT1zJiZlPi0xP3RoaXMuTy5zcGxpY2UoZSwxKToiZG93biI9PT1zJiYtMT09PWU/dGhpcy5PLnB1c2godGhpcy5udChoLHt4OjAseTowfSkpOmU+LTEmJnRoaXMubnQoaCx0aGlzLk9bZV0pLHRoaXMuRj10aGlzLk8ubGVuZ3RoLHRoaXMuRj4wJiZpKHRoaXMucDEsdGhpcy5PWzBdKSx0aGlzLkY+MSYmaSh0aGlzLnAyLHRoaXMuT1sxXSl9ZWxzZXtjb25zdCBpPXQ7dGhpcy5GPTAsaS50eXBlLmluZGV4T2YoInRvdWNoIik+LTE/aS50b3VjaGVzJiZpLnRvdWNoZXMubGVuZ3RoPjAmJih0aGlzLm50KGkudG91Y2hlc1swXSx0aGlzLnAxKSx0aGlzLkYrKyxpLnRvdWNoZXMubGVuZ3RoPjEmJih0aGlzLm50KGkudG91Y2hlc1sxXSx0aGlzLnAyKSx0aGlzLkYrKykpOih0aGlzLm50KHQsdGhpcy5wMSksInVwIj09PXM/dGhpcy5GPTA6dGhpcy5GKyspfX1odCgpe2kodGhpcy5wcmV2UDEsdGhpcy5wMSksaSh0aGlzLnByZXZQMix0aGlzLnAyKX1YKCl7aSh0aGlzLnN0YXJ0UDEsdGhpcy5wMSksaSh0aGlzLnN0YXJ0UDIsdGhpcy5wMiksdGhpcy5odCgpfXR0KCl7aWYodGhpcy5wc3dwLm1haW5TY3JvbGwuaXNTaGlmdGVkKCkpdGhpcy5kcmFnQXhpcz0ieCI7ZWxzZXtjb25zdCB0PU1hdGguYWJzKHRoaXMucDEueC10aGlzLnN0YXJ0UDEueCktTWF0aC5hYnModGhpcy5wMS55LXRoaXMuc3RhcnRQMS55KTtpZigwIT09dCl7Y29uc3QgaT10PjA/IngiOiJ5IjtNYXRoLmFicyh0aGlzLnAxW2ldLXRoaXMuc3RhcnRQMVtpXSk+PTEwJiYodGhpcy5kcmFnQXhpcz1pKX19fW50KHQsaSl7cmV0dXJuIGkueD10LnBhZ2VYLXRoaXMucHN3cC5vZmZzZXQueCxpLnk9dC5wYWdlWS10aGlzLnBzd3Aub2Zmc2V0LnksInBvaW50ZXJJZCJpbiB0P2kuaWQ9dC5wb2ludGVySWQ6dm9pZCAwIT09dC5pZGVudGlmaWVyJiYoaS5pZD10LmlkZW50aWZpZXIpLGl9JCh0KXt0aGlzLnBzd3AubWFpblNjcm9sbC5pc1NoaWZ0ZWQoKSYmKHQucHJldmVudERlZmF1bHQoKSx0LnN0b3BQcm9wYWdhdGlvbigpKX19Y2xhc3MgQXtjb25zdHJ1Y3Rvcih0KXt0aGlzLnBzd3A9dCx0aGlzLng9MCx0aGlzLnNsaWRlV2lkdGg9MCx0aGlzLm90PTAsdGhpcy5ydD0wLHRoaXMubHQ9LTEsdGhpcy5pdGVtSG9sZGVycz1bXX1yZXNpemUodCl7Y29uc3R7cHN3cDppfT10aGlzLHM9TWF0aC5yb3VuZChpLnZpZXdwb3J0U2l6ZS54K2kudmlld3BvcnRTaXplLngqaS5vcHRpb25zLnNwYWNpbmcpLGg9cyE9PXRoaXMuc2xpZGVXaWR0aDtoJiYodGhpcy5zbGlkZVdpZHRoPXMsdGhpcy5tb3ZlVG8odGhpcy5nZXRDdXJyU2xpZGVYKCkpKSx0aGlzLml0ZW1Ib2xkZXJzLmZvckVhY2goKChpLHMpPT57aCYmcihpLmVsLChzK3RoaXMubHQpKnRoaXMuc2xpZGVXaWR0aCksdCYmaS5zbGlkZSYmaS5zbGlkZS5yZXNpemUoKX0pKX1yZXNldFBvc2l0aW9uKCl7dGhpcy5vdD0wLHRoaXMucnQ9MCx0aGlzLnNsaWRlV2lkdGg9MCx0aGlzLmx0PS0xfWFwcGVuZEhvbGRlcnMoKXt0aGlzLml0ZW1Ib2xkZXJzPVtdO2ZvcihsZXQgaT0wO2k8MztpKyspe2NvbnN0IHM9dCgicHN3cF9faXRlbSIsImRpdiIsdGhpcy5wc3dwLmNvbnRhaW5lcik7cy5zZXRBdHRyaWJ1dGUoInJvbGUiLCJncm91cCIpLHMuc2V0QXR0cmlidXRlKCJhcmlhLXJvbGVkZXNjcmlwdGlvbiIsInNsaWRlIikscy5zZXRBdHRyaWJ1dGUoImFyaWEtaGlkZGVuIiwidHJ1ZSIpLHMuc3R5bGUuZGlzcGxheT0xPT09aT8iYmxvY2siOiJub25lIix0aGlzLml0ZW1Ib2xkZXJzLnB1c2goe2VsOnN9KX19Y2FuQmVTd2lwZWQoKXtyZXR1cm4gdGhpcy5wc3dwLmdldE51bUl0ZW1zKCk+MX1tb3ZlSW5kZXhCeSh0LGkscyl7Y29uc3R7cHN3cDpofT10aGlzO2xldCBlPWgucG90ZW50aWFsSW5kZXgrdDtjb25zdCBuPWguZ2V0TnVtSXRlbXMoKTtpZihoLmNhbkxvb3AoKSl7ZT1oLmdldExvb3BlZEluZGV4KGUpO2NvbnN0IGk9KHQrbiklbjt0PWk8PW4vMj9pOmktbn1lbHNlIGU8MD9lPTA6ZT49biYmKGU9bi0xKSx0PWUtaC5wb3RlbnRpYWxJbmRleDtoLnBvdGVudGlhbEluZGV4PWUsdGhpcy5vdC09dCxoLmFuaW1hdGlvbnMuc3RvcE1haW5TY3JvbGwoKTtjb25zdCBvPXRoaXMuZ2V0Q3VyclNsaWRlWCgpO2lmKGkpe2guYW5pbWF0aW9ucy5zdGFydFNwcmluZyh7aXNNYWluU2Nyb2xsOiEwLHN0YXJ0OnRoaXMueCxlbmQ6byx2ZWxvY2l0eTpzfHwwLG5hdHVyYWxGcmVxdWVuY3k6MzAsZGFtcGluZ1JhdGlvOjEsb25VcGRhdGU6dD0+e3RoaXMubW92ZVRvKHQpfSxvbkNvbXBsZXRlOigpPT57dGhpcy51cGRhdGVDdXJySXRlbSgpLGguYXBwZW5kSGVhdnkoKX19KTtsZXQgdD1oLnBvdGVudGlhbEluZGV4LWguY3VyckluZGV4O2lmKGguY2FuTG9vcCgpKXtjb25zdCBpPSh0K24pJW47dD1pPD1uLzI/aTppLW59TWF0aC5hYnModCk+MSYmdGhpcy51cGRhdGVDdXJySXRlbSgpfWVsc2UgdGhpcy5tb3ZlVG8obyksdGhpcy51cGRhdGVDdXJySXRlbSgpO3JldHVybiBCb29sZWFuKHQpfWdldEN1cnJTbGlkZVgoKXtyZXR1cm4gdGhpcy5zbGlkZVdpZHRoKnRoaXMub3R9aXNTaGlmdGVkKCl7cmV0dXJuIHRoaXMueCE9PXRoaXMuZ2V0Q3VyclNsaWRlWCgpfXVwZGF0ZUN1cnJJdGVtKCl7dmFyIHQ7Y29uc3R7cHN3cDppfT10aGlzLHM9dGhpcy5ydC10aGlzLm90O2lmKCFzKXJldHVybjt0aGlzLnJ0PXRoaXMub3QsaS5jdXJySW5kZXg9aS5wb3RlbnRpYWxJbmRleDtsZXQgaCxlPU1hdGguYWJzKHMpO2U+PTMmJih0aGlzLmx0Kz1zKyhzPjA/LTM6MyksZT0zLHRoaXMuaXRlbUhvbGRlcnMuZm9yRWFjaCgodD0+e3ZhciBpO251bGw9PT0oaT10LnNsaWRlKXx8dm9pZCAwPT09aXx8aS5kZXN0cm95KCksdC5zbGlkZT12b2lkIDB9KSkpO2ZvcihsZXQgdD0wO3Q8ZTt0Kyspcz4wPyhoPXRoaXMuaXRlbUhvbGRlcnMuc2hpZnQoKSxoJiYodGhpcy5pdGVtSG9sZGVyc1syXT1oLHRoaXMubHQrKyxyKGguZWwsKHRoaXMubHQrMikqdGhpcy5zbGlkZVdpZHRoKSxpLnNldENvbnRlbnQoaCxpLmN1cnJJbmRleC1lK3QrMikpKTooaD10aGlzLml0ZW1Ib2xkZXJzLnBvcCgpLGgmJih0aGlzLml0ZW1Ib2xkZXJzLnVuc2hpZnQoaCksdGhpcy5sdC0tLHIoaC5lbCx0aGlzLmx0KnRoaXMuc2xpZGVXaWR0aCksaS5zZXRDb250ZW50KGgsaS5jdXJySW5kZXgrZS10LTIpKSk7TWF0aC5hYnModGhpcy5sdCk+NTAmJiF0aGlzLmlzU2hpZnRlZCgpJiYodGhpcy5yZXNldFBvc2l0aW9uKCksdGhpcy5yZXNpemUoKSksaS5hbmltYXRpb25zLnN0b3BBbGxQYW4oKSx0aGlzLml0ZW1Ib2xkZXJzLmZvckVhY2goKCh0LGkpPT57dC5zbGlkZSYmdC5zbGlkZS5zZXRJc0FjdGl2ZSgxPT09aSl9KSksaS5jdXJyU2xpZGU9bnVsbD09PSh0PXRoaXMuaXRlbUhvbGRlcnNbMV0pfHx2b2lkIDA9PT10P3ZvaWQgMDp0LnNsaWRlLGkuY29udGVudExvYWRlci51cGRhdGVMYXp5KHMpLGkuY3VyclNsaWRlJiZpLmN1cnJTbGlkZS5hcHBseUN1cnJlbnRab29tUGFuKCksaS5kaXNwYXRjaCgiY2hhbmdlIil9bW92ZVRvKHQsaSl7aWYoIXRoaXMucHN3cC5jYW5Mb29wKCkmJmkpe2xldCBpPSh0aGlzLnNsaWRlV2lkdGgqdGhpcy5vdC10KS90aGlzLnNsaWRlV2lkdGg7aSs9dGhpcy5wc3dwLmN1cnJJbmRleDtjb25zdCBzPU1hdGgucm91bmQodC10aGlzLngpOyhpPDAmJnM+MHx8aT49dGhpcy5wc3dwLmdldE51bUl0ZW1zKCktMSYmczwwKSYmKHQ9dGhpcy54Ky4zNSpzKX10aGlzLng9dCx0aGlzLnBzd3AuY29udGFpbmVyJiZyKHRoaXMucHN3cC5jb250YWluZXIsdCksdGhpcy5wc3dwLmRpc3BhdGNoKCJtb3ZlTWFpblNjcm9sbCIse3g6dCxkcmFnZ2luZzpudWxsIT1pJiZpfSl9fWNvbnN0IEQ9e0VzY2FwZToyNyx6OjkwLEFycm93TGVmdDozNyxBcnJvd1VwOjM4LEFycm93UmlnaHQ6MzksQXJyb3dEb3duOjQwLFRhYjo5fSxJPSh0LGkpPT5pP3Q6RFt0XTtjbGFzcyBFe2NvbnN0cnVjdG9yKHQpe3RoaXMucHN3cD10LHRoaXMuY3Q9ITEsdC5vbigiYmluZEV2ZW50cyIsKCgpPT57dC5vcHRpb25zLnRyYXBGb2N1cyYmKHQub3B0aW9ucy5pbml0aWFsUG9pbnRlclBvc3x8dGhpcy5kdCgpLHQuZXZlbnRzLmFkZChkb2N1bWVudCwiZm9jdXNpbiIsdGhpcy51dC5iaW5kKHRoaXMpKSksdC5ldmVudHMuYWRkKGRvY3VtZW50LCJrZXlkb3duIix0aGlzLnZ0LmJpbmQodGhpcykpfSkpO2NvbnN0IGk9ZG9jdW1lbnQuYWN0aXZlRWxlbWVudDt0Lm9uKCJkZXN0cm95IiwoKCk9Pnt0Lm9wdGlvbnMucmV0dXJuRm9jdXMmJmkmJnRoaXMuY3QmJmkuZm9jdXMoKX0pKX1kdCgpeyF0aGlzLmN0JiZ0aGlzLnBzd3AuZWxlbWVudCYmKHRoaXMucHN3cC5lbGVtZW50LmZvY3VzKCksdGhpcy5jdD0hMCl9dnQodCl7Y29uc3R7cHN3cDppfT10aGlzO2lmKGkuZGlzcGF0Y2goImtleWRvd24iLHtvcmlnaW5hbEV2ZW50OnR9KS5kZWZhdWx0UHJldmVudGVkKXJldHVybjtpZihmdW5jdGlvbih0KXtyZXR1cm4iYnV0dG9uImluIHQmJjE9PT10LmJ1dHRvbnx8dC5jdHJsS2V5fHx0Lm1ldGFLZXl8fHQuYWx0S2V5fHx0LnNoaWZ0S2V5fSh0KSlyZXR1cm47bGV0IHMsaCxlPSExO2NvbnN0IG49ImtleSJpbiB0O3N3aXRjaChuP3Qua2V5OnQua2V5Q29kZSl7Y2FzZSBJKCJFc2NhcGUiLG4pOmkub3B0aW9ucy5lc2NLZXkmJihzPSJjbG9zZSIpO2JyZWFrO2Nhc2UgSSgieiIsbik6cz0idG9nZ2xlWm9vbSI7YnJlYWs7Y2FzZSBJKCJBcnJvd0xlZnQiLG4pOmg9IngiO2JyZWFrO2Nhc2UgSSgiQXJyb3dVcCIsbik6aD0ieSI7YnJlYWs7Y2FzZSBJKCJBcnJvd1JpZ2h0IixuKTpoPSJ4IixlPSEwO2JyZWFrO2Nhc2UgSSgiQXJyb3dEb3duIixuKTplPSEwLGg9InkiO2JyZWFrO2Nhc2UgSSgiVGFiIixuKTp0aGlzLmR0KCl9aWYoaCl7dC5wcmV2ZW50RGVmYXVsdCgpO2NvbnN0e2N1cnJTbGlkZTpufT1pO2kub3B0aW9ucy5hcnJvd0tleXMmJiJ4Ij09PWgmJmkuZ2V0TnVtSXRlbXMoKT4xP3M9ZT8ibmV4dCI6InByZXYiOm4mJm4uY3Vyclpvb21MZXZlbD5uLnpvb21MZXZlbHMuZml0JiYobi5wYW5baF0rPWU/LTgwOjgwLG4ucGFuVG8obi5wYW4ueCxuLnBhbi55KSl9cyYmKHQucHJldmVudERlZmF1bHQoKSxpW3NdKCkpfXV0KHQpe2NvbnN0e3RlbXBsYXRlOml9PXRoaXMucHN3cDtpJiZkb2N1bWVudCE9PXQudGFyZ2V0JiZpIT09dC50YXJnZXQmJiFpLmNvbnRhaW5zKHQudGFyZ2V0KSYmaS5mb2N1cygpfX1jb25zdCBMPSJjdWJpYy1iZXppZXIoLjQsMCwuMjIsMSkiO2NsYXNzIGt7Y29uc3RydWN0b3IodCl7dmFyIGk7dGhpcy5wcm9wcz10O2NvbnN0e3RhcmdldDpzLG9uQ29tcGxldGU6aCx0cmFuc2Zvcm06ZSxvbkZpbmlzaDpuPSgoKT0+e30pLGR1cmF0aW9uOm89MzMzLGVhc2luZzpyPUx9PXQ7dGhpcy5vbkZpbmlzaD1uO2NvbnN0IGw9ZT8idHJhbnNmb3JtIjoib3BhY2l0eSIsYz1udWxsIT09KGk9dFtsXSkmJnZvaWQgMCE9PWk/aToiIjt0aGlzLmZ0PXMsdGhpcy53dD1oLHRoaXMuZ3Q9ITEsdGhpcy55dD10aGlzLnl0LmJpbmQodGhpcyksdGhpcy5fdD1zZXRUaW1lb3V0KCgoKT0+e2EocyxsLG8sciksdGhpcy5fdD1zZXRUaW1lb3V0KCgoKT0+e3MuYWRkRXZlbnRMaXN0ZW5lcigidHJhbnNpdGlvbmVuZCIsdGhpcy55dCwhMSkscy5hZGRFdmVudExpc3RlbmVyKCJ0cmFuc2l0aW9uY2FuY2VsIix0aGlzLnl0LCExKSx0aGlzLl90PXNldFRpbWVvdXQoKCgpPT57dGhpcy54dCgpfSksbys1MDApLHMuc3R5bGVbbF09Y30pLDMwKX0pLDApfXl0KHQpe3QudGFyZ2V0PT09dGhpcy5mdCYmdGhpcy54dCgpfXh0KCl7dGhpcy5ndHx8KHRoaXMuZ3Q9ITAsdGhpcy5vbkZpbmlzaCgpLHRoaXMud3QmJnRoaXMud3QoKSl9ZGVzdHJveSgpe3RoaXMuX3QmJmNsZWFyVGltZW91dCh0aGlzLl90KSxhKHRoaXMuZnQpLHRoaXMuZnQucmVtb3ZlRXZlbnRMaXN0ZW5lcigidHJhbnNpdGlvbmVuZCIsdGhpcy55dCwhMSksdGhpcy5mdC5yZW1vdmVFdmVudExpc3RlbmVyKCJ0cmFuc2l0aW9uY2FuY2VsIix0aGlzLnl0LCExKSx0aGlzLmd0fHx0aGlzLnh0KCl9fWNsYXNzIFp7Y29uc3RydWN0b3IodCxpLHMpe3RoaXMudmVsb2NpdHk9MWUzKnQsdGhpcy5idD1pfHwuNzUsdGhpcy5TdD1zfHwxMix0aGlzLnp0PXRoaXMuU3QsdGhpcy5idDwxJiYodGhpcy56dCo9TWF0aC5zcXJ0KDEtdGhpcy5idCp0aGlzLmJ0KSl9ZWFzZUZyYW1lKHQsaSl7bGV0IHMsaD0wO2kvPTFlMztjb25zdCBlPU1hdGguRSoqKC10aGlzLmJ0KnRoaXMuU3QqaSk7aWYoMT09PXRoaXMuYnQpcz10aGlzLnZlbG9jaXR5K3RoaXMuU3QqdCxoPSh0K3MqaSkqZSx0aGlzLnZlbG9jaXR5PWgqLXRoaXMuU3QrcyplO2Vsc2UgaWYodGhpcy5idDwxKXtzPTEvdGhpcy56dCoodGhpcy5idCp0aGlzLlN0KnQrdGhpcy52ZWxvY2l0eSk7Y29uc3Qgbj1NYXRoLmNvcyh0aGlzLnp0KmkpLG89TWF0aC5zaW4odGhpcy56dCppKTtoPWUqKHQqbitzKm8pLHRoaXMudmVsb2NpdHk9aCotdGhpcy5TdCp0aGlzLmJ0K2UqKC10aGlzLnp0KnQqbyt0aGlzLnp0KnMqbil9cmV0dXJuIGh9fWNsYXNzIEJ7Y29uc3RydWN0b3IodCl7dGhpcy5wcm9wcz10LHRoaXMuTXQ9MDtjb25zdHtzdGFydDppLGVuZDpzLHZlbG9jaXR5Omgsb25VcGRhdGU6ZSxvbkNvbXBsZXRlOm4sb25GaW5pc2g6bz0oKCk9Pnt9KSxkYW1waW5nUmF0aW86cixuYXR1cmFsRnJlcXVlbmN5OmF9PXQ7dGhpcy5vbkZpbmlzaD1vO2NvbnN0IGw9bmV3IFooaCxyLGEpO2xldCBjPURhdGUubm93KCksZD1pLXM7Y29uc3QgdT0oKT0+e3RoaXMuTXQmJihkPWwuZWFzZUZyYW1lKGQsRGF0ZS5ub3coKS1jKSxNYXRoLmFicyhkKTwxJiZNYXRoLmFicyhsLnZlbG9jaXR5KTw1MD8oZShzKSxuJiZuKCksdGhpcy5vbkZpbmlzaCgpKTooYz1EYXRlLm5vdygpLGUoZCtzKSx0aGlzLk10PXJlcXVlc3RBbmltYXRpb25GcmFtZSh1KSkpfTt0aGlzLk10PXJlcXVlc3RBbmltYXRpb25GcmFtZSh1KX1kZXN0cm95KCl7dGhpcy5NdD49MCYmY2FuY2VsQW5pbWF0aW9uRnJhbWUodGhpcy5NdCksdGhpcy5NdD0wfX1jbGFzcyBGe2NvbnN0cnVjdG9yKCl7dGhpcy5hY3RpdmVBbmltYXRpb25zPVtdfXN0YXJ0U3ByaW5nKHQpe3RoaXMuUHQodCwhMCl9c3RhcnRUcmFuc2l0aW9uKHQpe3RoaXMuUHQodCl9UHQodCxpKXtjb25zdCBzPWk/bmV3IEIodCk6bmV3IGsodCk7cmV0dXJuIHRoaXMuYWN0aXZlQW5pbWF0aW9ucy5wdXNoKHMpLHMub25GaW5pc2g9KCk9PnRoaXMuc3RvcChzKSxzfXN0b3AodCl7dC5kZXN0cm95KCk7Y29uc3QgaT10aGlzLmFjdGl2ZUFuaW1hdGlvbnMuaW5kZXhPZih0KTtpPi0xJiZ0aGlzLmFjdGl2ZUFuaW1hdGlvbnMuc3BsaWNlKGksMSl9c3RvcEFsbCgpe3RoaXMuYWN0aXZlQW5pbWF0aW9ucy5mb3JFYWNoKCh0PT57dC5kZXN0cm95KCl9KSksdGhpcy5hY3RpdmVBbmltYXRpb25zPVtdfXN0b3BBbGxQYW4oKXt0aGlzLmFjdGl2ZUFuaW1hdGlvbnM9dGhpcy5hY3RpdmVBbmltYXRpb25zLmZpbHRlcigodD0+IXQucHJvcHMuaXNQYW58fCh0LmRlc3Ryb3koKSwhMSkpKX1zdG9wTWFpblNjcm9sbCgpe3RoaXMuYWN0aXZlQW5pbWF0aW9ucz10aGlzLmFjdGl2ZUFuaW1hdGlvbnMuZmlsdGVyKCh0PT4hdC5wcm9wcy5pc01haW5TY3JvbGx8fCh0LmRlc3Ryb3koKSwhMSkpKX1pc1BhblJ1bm5pbmcoKXtyZXR1cm4gdGhpcy5hY3RpdmVBbmltYXRpb25zLnNvbWUoKHQ9PnQucHJvcHMuaXNQYW4pKX19Y2xhc3MgT3tjb25zdHJ1Y3Rvcih0KXt0aGlzLnBzd3A9dCx0LmV2ZW50cy5hZGQodC5lbGVtZW50LCJ3aGVlbCIsdGhpcy5DdC5iaW5kKHRoaXMpKX1DdCh0KXt0LnByZXZlbnREZWZhdWx0KCk7Y29uc3R7Y3VyclNsaWRlOml9PXRoaXMucHN3cDtsZXR7ZGVsdGFYOnMsZGVsdGFZOmh9PXQ7aWYoaSYmIXRoaXMucHN3cC5kaXNwYXRjaCgid2hlZWwiLHtvcmlnaW5hbEV2ZW50OnR9KS5kZWZhdWx0UHJldmVudGVkKWlmKHQuY3RybEtleXx8dGhpcy5wc3dwLm9wdGlvbnMud2hlZWxUb1pvb20pe2lmKGkuaXNab29tYWJsZSgpKXtsZXQgcz0taDsxPT09dC5kZWx0YU1vZGU/cyo9LjA1OnMqPXQuZGVsdGFNb2RlPzE6LjAwMixzPTIqKnM7Y29uc3QgZT1pLmN1cnJab29tTGV2ZWwqcztpLnpvb21UbyhlLHt4OnQuY2xpZW50WCx5OnQuY2xpZW50WX0pfX1lbHNlIGkuaXNQYW5uYWJsZSgpJiYoMT09PXQuZGVsdGFNb2RlJiYocyo9MTgsaCo9MTgpLGkucGFuVG8oaS5wYW4ueC1zLGkucGFuLnktaCkpfX1jbGFzcyBSe2NvbnN0cnVjdG9yKGkscyl7dmFyIGg7Y29uc3QgZT1zLm5hbWV8fHMuY2xhc3NOYW1lO2xldCBuPXMuaHRtbDtpZighMT09PWkub3B0aW9uc1tlXSlyZXR1cm47InN0cmluZyI9PXR5cGVvZiBpLm9wdGlvbnNbZSsiU1ZHIl0mJihuPWkub3B0aW9uc1tlKyJTVkciXSksaS5kaXNwYXRjaCgidWlFbGVtZW50Q3JlYXRlIix7ZGF0YTpzfSk7bGV0IG89IiI7cy5pc0J1dHRvbj8obys9InBzd3BfX2J1dHRvbiAiLG8rPXMuY2xhc3NOYW1lfHxgcHN3cF9fYnV0dG9uLS0ke3MubmFtZX1gKTpvKz1zLmNsYXNzTmFtZXx8YHBzd3BfXyR7cy5uYW1lfWA7bGV0IHI9cy5pc0J1dHRvbj9zLnRhZ05hbWV8fCJidXR0b24iOnMudGFnTmFtZXx8ImRpdiI7cj1yLnRvTG93ZXJDYXNlKCk7Y29uc3QgYT10KG8scik7aWYocy5pc0J1dHRvbil7ImJ1dHRvbiI9PT1yJiYoYS50eXBlPSJidXR0b24iKTtsZXR7dGl0bGU6dH09cztjb25zdHthcmlhTGFiZWw6aH09czsic3RyaW5nIj09dHlwZW9mIGkub3B0aW9uc1tlKyJUaXRsZSJdJiYodD1pLm9wdGlvbnNbZSsiVGl0bGUiXSksdCYmKGEudGl0bGU9dCk7Y29uc3Qgbj1ofHx0O24mJmEuc2V0QXR0cmlidXRlKCJhcmlhLWxhYmVsIixuKX1hLmlubmVySFRNTD1mdW5jdGlvbih0KXtpZigic3RyaW5nIj09dHlwZW9mIHQpcmV0dXJuIHQ7aWYoIXR8fCF0LmlzQ3VzdG9tU1ZHKXJldHVybiIiO2NvbnN0IGk9dDtsZXQgcz0nPHN2ZyBhcmlhLWhpZGRlbj0idHJ1ZSIgY2xhc3M9InBzd3BfX2ljbiIgdmlld0JveD0iMCAwICVkICVkIiB3aWR0aD0iJWQiIGhlaWdodD0iJWQiPic7cmV0dXJuIHM9cy5zcGxpdCgiJWQiKS5qb2luKGkuc2l6ZXx8MzIpLGkub3V0bGluZUlEJiYocys9Jzx1c2UgY2xhc3M9InBzd3BfX2ljbi1zaGFkb3ciIHhsaW5rOmhyZWY9IiMnK2kub3V0bGluZUlEKyciLz4nKSxzKz1pLmlubmVyLHMrPSI8L3N2Zz4iLHN9KG4pLHMub25Jbml0JiZzLm9uSW5pdChhLGkpLHMub25DbGljayYmKGEub25jbGljaz10PT57InN0cmluZyI9PXR5cGVvZiBzLm9uQ2xpY2s/aVtzLm9uQ2xpY2tdKCk6ImZ1bmN0aW9uIj09dHlwZW9mIHMub25DbGljayYmcy5vbkNsaWNrKHQsYSxpKX0pO2NvbnN0IGw9cy5hcHBlbmRUb3x8ImJhciI7bGV0IGM9aS5lbGVtZW50OyJiYXIiPT09bD8oaS50b3BCYXJ8fChpLnRvcEJhcj10KCJwc3dwX190b3AtYmFyIHBzd3BfX2hpZGUtb24tY2xvc2UiLCJkaXYiLGkuc2Nyb2xsV3JhcCkpLGM9aS50b3BCYXIpOihhLmNsYXNzTGlzdC5hZGQoInBzd3BfX2hpZGUtb24tY2xvc2UiKSwid3JhcHBlciI9PT1sJiYoYz1pLnNjcm9sbFdyYXApKSxudWxsPT09KGg9Yyl8fHZvaWQgMD09PWh8fGguYXBwZW5kQ2hpbGQoaS5hcHBseUZpbHRlcnMoInVpRWxlbWVudCIsYSxzKSl9fWZ1bmN0aW9uIE4odCxpLHMpe3QuY2xhc3NMaXN0LmFkZCgicHN3cF9fYnV0dG9uLS1hcnJvdyIpLHQuc2V0QXR0cmlidXRlKCJhcmlhLWNvbnRyb2xzIiwicHN3cF9faXRlbXMiKSxpLm9uKCJjaGFuZ2UiLCgoKT0+e2kub3B0aW9ucy5sb29wfHwodC5kaXNhYmxlZD1zPyEoaS5jdXJySW5kZXg8aS5nZXROdW1JdGVtcygpLTEpOiEoaS5jdXJySW5kZXg+MCkpfSkpfWNvbnN0IFU9e25hbWU6ImFycm93UHJldiIsY2xhc3NOYW1lOiJwc3dwX19idXR0b24tLWFycm93LS1wcmV2Iix0aXRsZToiUHJldmlvdXMiLG9yZGVyOjEwLGlzQnV0dG9uOiEwLGFwcGVuZFRvOiJ3cmFwcGVyIixodG1sOntpc0N1c3RvbVNWRzohMCxzaXplOjYwLGlubmVyOic8cGF0aCBkPSJNMjkgNDNsLTMgMy0xNi0xNiAxNi0xNiAzIDMtMTMgMTMgMTMgMTN6IiBpZD0icHN3cF9faWNuLWFycm93Ii8+JyxvdXRsaW5lSUQ6InBzd3BfX2ljbi1hcnJvdyJ9LG9uQ2xpY2s6InByZXYiLG9uSW5pdDpOfSxWPXtuYW1lOiJhcnJvd05leHQiLGNsYXNzTmFtZToicHN3cF9fYnV0dG9uLS1hcnJvdy0tbmV4dCIsdGl0bGU6Ik5leHQiLG9yZGVyOjExLGlzQnV0dG9uOiEwLGFwcGVuZFRvOiJ3cmFwcGVyIixodG1sOntpc0N1c3RvbVNWRzohMCxzaXplOjYwLGlubmVyOic8dXNlIHhsaW5rOmhyZWY9IiNwc3dwX19pY24tYXJyb3ciLz4nLG91dGxpbmVJRDoicHN3cF9faWNuLWFycm93In0sb25DbGljazoibmV4dCIsb25Jbml0Oih0LGkpPT57Tih0LGksITApfX0sRz17bmFtZToiY2xvc2UiLHRpdGxlOiJDbG9zZSIsb3JkZXI6MjAsaXNCdXR0b246ITAsaHRtbDp7aXNDdXN0b21TVkc6ITAsaW5uZXI6JzxwYXRoIGQ9Ik0yNCAxMGwtMi0yLTYgNi02LTYtMiAyIDYgNi02IDYgMiAyIDYtNiA2IDYgMi0yLTYtNnoiIGlkPSJwc3dwX19pY24tY2xvc2UiLz4nLG91dGxpbmVJRDoicHN3cF9faWNuLWNsb3NlIn0sb25DbGljazoiY2xvc2UifSwkPXtuYW1lOiJ6b29tIix0aXRsZToiWm9vbSIsb3JkZXI6MTAsaXNCdXR0b246ITAsaHRtbDp7aXNDdXN0b21TVkc6ITAsaW5uZXI6JzxwYXRoIGQ9Ik0xNy40MjYgMTkuOTI2YTYgNiAwIDEgMSAxLjUtMS41TDIzIDIyLjUgMjEuNSAyNGwtNC4wNzQtNC4wNzR6IiBpZD0icHN3cF9faWNuLXpvb20iLz48cGF0aCBmaWxsPSJjdXJyZW50Q29sb3IiIGNsYXNzPSJwc3dwX196b29tLWljbi1iYXItaCIgZD0iTTExIDE2di0yaDZ2MnoiLz48cGF0aCBmaWxsPSJjdXJyZW50Q29sb3IiIGNsYXNzPSJwc3dwX196b29tLWljbi1iYXItdiIgZD0iTTEzIDEyaDJ2NmgtMnoiLz4nLG91dGxpbmVJRDoicHN3cF9faWNuLXpvb20ifSxvbkNsaWNrOiJ0b2dnbGVab29tIn0scT17bmFtZToicHJlbG9hZGVyIixhcHBlbmRUbzoiYmFyIixvcmRlcjo3LGh0bWw6e2lzQ3VzdG9tU1ZHOiEwLGlubmVyOic8cGF0aCBmaWxsLXJ1bGU9ImV2ZW5vZGQiIGNsaXAtcnVsZT0iZXZlbm9kZCIgZD0iTTIxLjIgMTZhNS4yIDUuMiAwIDEgMS01LjItNS4yVjhhOCA4IDAgMSAwIDggOGgtMi44WiIgaWQ9InBzd3BfX2ljbi1sb2FkaW5nIi8+JyxvdXRsaW5lSUQ6InBzd3BfX2ljbi1sb2FkaW5nIn0sb25Jbml0Oih0LGkpPT57bGV0IHMsaD1udWxsO2NvbnN0IGU9aT0+e3ZhciBoLGU7cyE9PWkmJihzPWksaD0iYWN0aXZlIixlPWksdC5jbGFzc0xpc3QudG9nZ2xlKCJwc3dwX19wcmVsb2FkZXItLSIraCxlKSl9LG49KCk9Pnt2YXIgdDtpZihudWxsPT09KHQ9aS5jdXJyU2xpZGUpfHx2b2lkIDA9PT10fHwhdC5jb250ZW50LmlzTG9hZGluZygpKXJldHVybiBlKCExKSx2b2lkKGgmJihjbGVhclRpbWVvdXQoaCksaD1udWxsKSk7aHx8KGg9c2V0VGltZW91dCgoKCk9Pnt2YXIgdDtlKEJvb2xlYW4obnVsbD09PSh0PWkuY3VyclNsaWRlKXx8dm9pZCAwPT09dD92b2lkIDA6dC5jb250ZW50LmlzTG9hZGluZygpKSksaD1udWxsfSksaS5vcHRpb25zLnByZWxvYWRlckRlbGF5KSl9O2kub24oImNoYW5nZSIsbiksaS5vbigibG9hZENvbXBsZXRlIiwodD0+e2kuY3VyclNsaWRlPT09dC5zbGlkZSYmbigpfSkpLGkudWkmJihpLnVpLnVwZGF0ZVByZWxvYWRlclZpc2liaWxpdHk9bil9fSxIPXtuYW1lOiJjb3VudGVyIixvcmRlcjo1LG9uSW5pdDoodCxpKT0+e2kub24oImNoYW5nZSIsKCgpPT57dC5pbm5lclRleHQ9aS5jdXJySW5kZXgrMStpLm9wdGlvbnMuaW5kZXhJbmRpY2F0b3JTZXAraS5nZXROdW1JdGVtcygpfSkpfX07ZnVuY3Rpb24gSyh0LGkpe3QuY2xhc3NMaXN0LnRvZ2dsZSgicHN3cC0tem9vbWVkLWluIixpKX1jbGFzcyBXe2NvbnN0cnVjdG9yKHQpe3RoaXMucHN3cD10LHRoaXMuaXNSZWdpc3RlcmVkPSExLHRoaXMudWlFbGVtZW50c0RhdGE9W10sdGhpcy5pdGVtcz1bXSx0aGlzLnVwZGF0ZVByZWxvYWRlclZpc2liaWxpdHk9KCk9Pnt9LHRoaXMuVHQ9dm9pZCAwfWluaXQoKXtjb25zdHtwc3dwOnR9PXRoaXM7dGhpcy5pc1JlZ2lzdGVyZWQ9ITEsdGhpcy51aUVsZW1lbnRzRGF0YT1bRyxVLFYsJCxxLEhdLHQuZGlzcGF0Y2goInVpUmVnaXN0ZXIiKSx0aGlzLnVpRWxlbWVudHNEYXRhLnNvcnQoKCh0LGkpPT4odC5vcmRlcnx8MCktKGkub3JkZXJ8fDApKSksdGhpcy5pdGVtcz1bXSx0aGlzLmlzUmVnaXN0ZXJlZD0hMCx0aGlzLnVpRWxlbWVudHNEYXRhLmZvckVhY2goKHQ9Pnt0aGlzLnJlZ2lzdGVyRWxlbWVudCh0KX0pKSx0Lm9uKCJjaGFuZ2UiLCgoKT0+e3ZhciBpO251bGw9PT0oaT10LmVsZW1lbnQpfHx2b2lkIDA9PT1pfHxpLmNsYXNzTGlzdC50b2dnbGUoInBzd3AtLW9uZS1zbGlkZSIsMT09PXQuZ2V0TnVtSXRlbXMoKSl9KSksdC5vbigiem9vbVBhblVwZGF0ZSIsKCgpPT50aGlzLkF0KCkpKX1yZWdpc3RlckVsZW1lbnQodCl7dGhpcy5pc1JlZ2lzdGVyZWQ/dGhpcy5pdGVtcy5wdXNoKG5ldyBSKHRoaXMucHN3cCx0KSk6dGhpcy51aUVsZW1lbnRzRGF0YS5wdXNoKHQpfUF0KCl7Y29uc3R7dGVtcGxhdGU6dCxjdXJyU2xpZGU6aSxvcHRpb25zOnN9PXRoaXMucHN3cDtpZih0aGlzLnBzd3Aub3BlbmVyLmlzQ2xvc2luZ3x8IXR8fCFpKXJldHVybjtsZXR7Y3Vyclpvb21MZXZlbDpofT1pO2lmKHRoaXMucHN3cC5vcGVuZXIuaXNPcGVufHwoaD1pLnpvb21MZXZlbHMuaW5pdGlhbCksaD09PXRoaXMuVHQpcmV0dXJuO3RoaXMuVHQ9aDtjb25zdCBlPWkuem9vbUxldmVscy5pbml0aWFsLWkuem9vbUxldmVscy5zZWNvbmRhcnk7aWYoTWF0aC5hYnMoZSk8LjAxfHwhaS5pc1pvb21hYmxlKCkpcmV0dXJuIEsodCwhMSksdm9pZCB0LmNsYXNzTGlzdC5yZW1vdmUoInBzd3AtLXpvb20tYWxsb3dlZCIpO3QuY2xhc3NMaXN0LmFkZCgicHN3cC0tem9vbS1hbGxvd2VkIik7Syh0LChoPT09aS56b29tTGV2ZWxzLmluaXRpYWw/aS56b29tTGV2ZWxzLnNlY29uZGFyeTppLnpvb21MZXZlbHMuaW5pdGlhbCk8PWgpLCJ6b29tIiE9PXMuaW1hZ2VDbGlja0FjdGlvbiYmInpvb20tb3ItY2xvc2UiIT09cy5pbWFnZUNsaWNrQWN0aW9ufHx0LmNsYXNzTGlzdC5hZGQoInBzd3AtLWNsaWNrLXRvLXpvb20iKX19Y2xhc3Mgantjb25zdHJ1Y3Rvcih0LGkpe3RoaXMudHlwZT10LHRoaXMuZGVmYXVsdFByZXZlbnRlZD0hMSxpJiZPYmplY3QuYXNzaWduKHRoaXMsaSl9cHJldmVudERlZmF1bHQoKXt0aGlzLmRlZmF1bHRQcmV2ZW50ZWQ9ITB9fWNsYXNzIFh7Y29uc3RydWN0b3IoaSxzKXtpZih0aGlzLmVsZW1lbnQ9dCgicHN3cF9faW1nIHBzd3BfX2ltZy0tcGxhY2Vob2xkZXIiLGk/ImltZyI6ImRpdiIscyksaSl7Y29uc3QgdD10aGlzLmVsZW1lbnQ7dC5kZWNvZGluZz0iYXN5bmMiLHQuYWx0PSIiLHQuc3JjPWksdC5zZXRBdHRyaWJ1dGUoInJvbGUiLCJwcmVzZW50YXRpb24iKX10aGlzLmVsZW1lbnQuc2V0QXR0cmlidXRlKCJhcmlhLWhpZGRlbiIsInRydWUiKX1zZXREaXNwbGF5ZWRTaXplKHQsaSl7dGhpcy5lbGVtZW50JiYoIklNRyI9PT10aGlzLmVsZW1lbnQudGFnTmFtZT8obCh0aGlzLmVsZW1lbnQsMjUwLCJhdXRvIiksdGhpcy5lbGVtZW50LnN0eWxlLnRyYW5zZm9ybU9yaWdpbj0iMCAwIix0aGlzLmVsZW1lbnQuc3R5bGUudHJhbnNmb3JtPW8oMCwwLHQvMjUwKSk6bCh0aGlzLmVsZW1lbnQsdCxpKSl9ZGVzdHJveSgpe3ZhciB0O251bGwhPT0odD10aGlzLmVsZW1lbnQpJiZ2b2lkIDAhPT10JiZ0LnBhcmVudE5vZGUmJnRoaXMuZWxlbWVudC5yZW1vdmUoKSx0aGlzLmVsZW1lbnQ9bnVsbH19Y2xhc3MgWXtjb25zdHJ1Y3Rvcih0LGkscyl7dGhpcy5pbnN0YW5jZT1pLHRoaXMuZGF0YT10LHRoaXMuaW5kZXg9cyx0aGlzLmVsZW1lbnQ9dm9pZCAwLHRoaXMucGxhY2Vob2xkZXI9dm9pZCAwLHRoaXMuc2xpZGU9dm9pZCAwLHRoaXMuZGlzcGxheWVkSW1hZ2VXaWR0aD0wLHRoaXMuZGlzcGxheWVkSW1hZ2VIZWlnaHQ9MCx0aGlzLndpZHRoPU51bWJlcih0aGlzLmRhdGEudyl8fE51bWJlcih0aGlzLmRhdGEud2lkdGgpfHwwLHRoaXMuaGVpZ2h0PU51bWJlcih0aGlzLmRhdGEuaCl8fE51bWJlcih0aGlzLmRhdGEuaGVpZ2h0KXx8MCx0aGlzLmlzQXR0YWNoZWQ9ITEsdGhpcy5oYXNTbGlkZT0hMSx0aGlzLmlzRGVjb2Rpbmc9ITEsdGhpcy5zdGF0ZT1jLHRoaXMuZGF0YS50eXBlP3RoaXMudHlwZT10aGlzLmRhdGEudHlwZTp0aGlzLmRhdGEuc3JjP3RoaXMudHlwZT0iaW1hZ2UiOnRoaXMudHlwZT0iaHRtbCIsdGhpcy5pbnN0YW5jZS5kaXNwYXRjaCgiY29udGVudEluaXQiLHtjb250ZW50OnRoaXN9KX1yZW1vdmVQbGFjZWhvbGRlcigpe3RoaXMucGxhY2Vob2xkZXImJiF0aGlzLmtlZXBQbGFjZWhvbGRlcigpJiZzZXRUaW1lb3V0KCgoKT0+e3RoaXMucGxhY2Vob2xkZXImJih0aGlzLnBsYWNlaG9sZGVyLmRlc3Ryb3koKSx0aGlzLnBsYWNlaG9sZGVyPXZvaWQgMCl9KSwxZTMpfWxvYWQoaSxzKXtpZih0aGlzLnNsaWRlJiZ0aGlzLnVzZVBsYWNlaG9sZGVyKCkpaWYodGhpcy5wbGFjZWhvbGRlcil7Y29uc3QgdD10aGlzLnBsYWNlaG9sZGVyLmVsZW1lbnQ7dCYmIXQucGFyZW50RWxlbWVudCYmdGhpcy5zbGlkZS5jb250YWluZXIucHJlcGVuZCh0KX1lbHNle2NvbnN0IHQ9dGhpcy5pbnN0YW5jZS5hcHBseUZpbHRlcnMoInBsYWNlaG9sZGVyU3JjIiwhKCF0aGlzLmRhdGEubXNyY3x8IXRoaXMuc2xpZGUuaXNGaXJzdFNsaWRlKSYmdGhpcy5kYXRhLm1zcmMsdGhpcyk7dGhpcy5wbGFjZWhvbGRlcj1uZXcgWCh0LHRoaXMuc2xpZGUuY29udGFpbmVyKX10aGlzLmVsZW1lbnQmJiFzfHx0aGlzLmluc3RhbmNlLmRpc3BhdGNoKCJjb250ZW50TG9hZCIse2NvbnRlbnQ6dGhpcyxpc0xhenk6aX0pLmRlZmF1bHRQcmV2ZW50ZWR8fCh0aGlzLmlzSW1hZ2VDb250ZW50KCk/KHRoaXMuZWxlbWVudD10KCJwc3dwX19pbWciLCJpbWciKSx0aGlzLmRpc3BsYXllZEltYWdlV2lkdGgmJnRoaXMubG9hZEltYWdlKGkpKToodGhpcy5lbGVtZW50PXQoInBzd3BfX2NvbnRlbnQiLCJkaXYiKSx0aGlzLmVsZW1lbnQuaW5uZXJIVE1MPXRoaXMuZGF0YS5odG1sfHwiIikscyYmdGhpcy5zbGlkZSYmdGhpcy5zbGlkZS51cGRhdGVDb250ZW50U2l6ZSghMCkpfWxvYWRJbWFnZSh0KXt2YXIgaSxzO2lmKCF0aGlzLmlzSW1hZ2VDb250ZW50KCl8fCF0aGlzLmVsZW1lbnR8fHRoaXMuaW5zdGFuY2UuZGlzcGF0Y2goImNvbnRlbnRMb2FkSW1hZ2UiLHtjb250ZW50OnRoaXMsaXNMYXp5OnR9KS5kZWZhdWx0UHJldmVudGVkKXJldHVybjtjb25zdCBoPXRoaXMuZWxlbWVudDt0aGlzLnVwZGF0ZVNyY3NldFNpemVzKCksdGhpcy5kYXRhLnNyY3NldCYmKGguc3Jjc2V0PXRoaXMuZGF0YS5zcmNzZXQpLGguc3JjPW51bGwhPT0oaT10aGlzLmRhdGEuc3JjKSYmdm9pZCAwIT09aT9pOiIiLGguYWx0PW51bGwhPT0ocz10aGlzLmRhdGEuYWx0KSYmdm9pZCAwIT09cz9zOiIiLHRoaXMuc3RhdGU9ZCxoLmNvbXBsZXRlP3RoaXMub25Mb2FkZWQoKTooaC5vbmxvYWQ9KCk9Pnt0aGlzLm9uTG9hZGVkKCl9LGgub25lcnJvcj0oKT0+e3RoaXMub25FcnJvcigpfSl9c2V0U2xpZGUodCl7dGhpcy5zbGlkZT10LHRoaXMuaGFzU2xpZGU9ITAsdGhpcy5pbnN0YW5jZT10LnBzd3B9b25Mb2FkZWQoKXt0aGlzLnN0YXRlPXUsdGhpcy5zbGlkZSYmdGhpcy5lbGVtZW50JiYodGhpcy5pbnN0YW5jZS5kaXNwYXRjaCgibG9hZENvbXBsZXRlIix7c2xpZGU6dGhpcy5zbGlkZSxjb250ZW50OnRoaXN9KSx0aGlzLnNsaWRlLmlzQWN0aXZlJiZ0aGlzLnNsaWRlLmhlYXZ5QXBwZW5kZWQmJiF0aGlzLmVsZW1lbnQucGFyZW50Tm9kZSYmKHRoaXMuYXBwZW5kKCksdGhpcy5zbGlkZS51cGRhdGVDb250ZW50U2l6ZSghMCkpLHRoaXMuc3RhdGUhPT11JiZ0aGlzLnN0YXRlIT09cHx8dGhpcy5yZW1vdmVQbGFjZWhvbGRlcigpKX1vbkVycm9yKCl7dGhpcy5zdGF0ZT1wLHRoaXMuc2xpZGUmJih0aGlzLmRpc3BsYXlFcnJvcigpLHRoaXMuaW5zdGFuY2UuZGlzcGF0Y2goImxvYWRDb21wbGV0ZSIse3NsaWRlOnRoaXMuc2xpZGUsaXNFcnJvcjohMCxjb250ZW50OnRoaXN9KSx0aGlzLmluc3RhbmNlLmRpc3BhdGNoKCJsb2FkRXJyb3IiLHtzbGlkZTp0aGlzLnNsaWRlLGNvbnRlbnQ6dGhpc30pKX1pc0xvYWRpbmcoKXtyZXR1cm4gdGhpcy5pbnN0YW5jZS5hcHBseUZpbHRlcnMoImlzQ29udGVudExvYWRpbmciLHRoaXMuc3RhdGU9PT1kLHRoaXMpfWlzRXJyb3IoKXtyZXR1cm4gdGhpcy5zdGF0ZT09PXB9aXNJbWFnZUNvbnRlbnQoKXtyZXR1cm4iaW1hZ2UiPT09dGhpcy50eXBlfXNldERpc3BsYXllZFNpemUodCxpKXtpZih0aGlzLmVsZW1lbnQmJih0aGlzLnBsYWNlaG9sZGVyJiZ0aGlzLnBsYWNlaG9sZGVyLnNldERpc3BsYXllZFNpemUodCxpKSwhdGhpcy5pbnN0YW5jZS5kaXNwYXRjaCgiY29udGVudFJlc2l6ZSIse2NvbnRlbnQ6dGhpcyx3aWR0aDp0LGhlaWdodDppfSkuZGVmYXVsdFByZXZlbnRlZCYmKGwodGhpcy5lbGVtZW50LHQsaSksdGhpcy5pc0ltYWdlQ29udGVudCgpJiYhdGhpcy5pc0Vycm9yKCkpKSl7Y29uc3Qgcz0hdGhpcy5kaXNwbGF5ZWRJbWFnZVdpZHRoJiZ0O3RoaXMuZGlzcGxheWVkSW1hZ2VXaWR0aD10LHRoaXMuZGlzcGxheWVkSW1hZ2VIZWlnaHQ9aSxzP3RoaXMubG9hZEltYWdlKCExKTp0aGlzLnVwZGF0ZVNyY3NldFNpemVzKCksdGhpcy5zbGlkZSYmdGhpcy5pbnN0YW5jZS5kaXNwYXRjaCgiaW1hZ2VTaXplQ2hhbmdlIix7c2xpZGU6dGhpcy5zbGlkZSx3aWR0aDp0LGhlaWdodDppLGNvbnRlbnQ6dGhpc30pfX1pc1pvb21hYmxlKCl7cmV0dXJuIHRoaXMuaW5zdGFuY2UuYXBwbHlGaWx0ZXJzKCJpc0NvbnRlbnRab29tYWJsZSIsdGhpcy5pc0ltYWdlQ29udGVudCgpJiZ0aGlzLnN0YXRlIT09cCx0aGlzKX11cGRhdGVTcmNzZXRTaXplcygpe2lmKCF0aGlzLmlzSW1hZ2VDb250ZW50KCl8fCF0aGlzLmVsZW1lbnR8fCF0aGlzLmRhdGEuc3Jjc2V0KXJldHVybjtjb25zdCB0PXRoaXMuZWxlbWVudCxpPXRoaXMuaW5zdGFuY2UuYXBwbHlGaWx0ZXJzKCJzcmNzZXRTaXplc1dpZHRoIix0aGlzLmRpc3BsYXllZEltYWdlV2lkdGgsdGhpcyk7KCF0LmRhdGFzZXQubGFyZ2VzdFVzZWRTaXplfHxpPnBhcnNlSW50KHQuZGF0YXNldC5sYXJnZXN0VXNlZFNpemUsMTApKSYmKHQuc2l6ZXM9aSsicHgiLHQuZGF0YXNldC5sYXJnZXN0VXNlZFNpemU9U3RyaW5nKGkpKX11c2VQbGFjZWhvbGRlcigpe3JldHVybiB0aGlzLmluc3RhbmNlLmFwcGx5RmlsdGVycygidXNlQ29udGVudFBsYWNlaG9sZGVyIix0aGlzLmlzSW1hZ2VDb250ZW50KCksdGhpcyl9bGF6eUxvYWQoKXt0aGlzLmluc3RhbmNlLmRpc3BhdGNoKCJjb250ZW50TGF6eUxvYWQiLHtjb250ZW50OnRoaXN9KS5kZWZhdWx0UHJldmVudGVkfHx0aGlzLmxvYWQoITApfWtlZXBQbGFjZWhvbGRlcigpe3JldHVybiB0aGlzLmluc3RhbmNlLmFwcGx5RmlsdGVycygiaXNLZWVwaW5nUGxhY2Vob2xkZXIiLHRoaXMuaXNMb2FkaW5nKCksdGhpcyl9ZGVzdHJveSgpe3RoaXMuaGFzU2xpZGU9ITEsdGhpcy5zbGlkZT12b2lkIDAsdGhpcy5pbnN0YW5jZS5kaXNwYXRjaCgiY29udGVudERlc3Ryb3kiLHtjb250ZW50OnRoaXN9KS5kZWZhdWx0UHJldmVudGVkfHwodGhpcy5yZW1vdmUoKSx0aGlzLnBsYWNlaG9sZGVyJiYodGhpcy5wbGFjZWhvbGRlci5kZXN0cm95KCksdGhpcy5wbGFjZWhvbGRlcj12b2lkIDApLHRoaXMuaXNJbWFnZUNvbnRlbnQoKSYmdGhpcy5lbGVtZW50JiYodGhpcy5lbGVtZW50Lm9ubG9hZD1udWxsLHRoaXMuZWxlbWVudC5vbmVycm9yPW51bGwsdGhpcy5lbGVtZW50PXZvaWQgMCkpfWRpc3BsYXlFcnJvcigpe2lmKHRoaXMuc2xpZGUpe3ZhciBpLHM7bGV0IGg9dCgicHN3cF9fZXJyb3ItbXNnIiwiZGl2Iik7aC5pbm5lclRleHQ9bnVsbCE9PShpPW51bGw9PT0ocz10aGlzLmluc3RhbmNlLm9wdGlvbnMpfHx2b2lkIDA9PT1zP3ZvaWQgMDpzLmVycm9yTXNnKSYmdm9pZCAwIT09aT9pOiIiLGg9dGhpcy5pbnN0YW5jZS5hcHBseUZpbHRlcnMoImNvbnRlbnRFcnJvckVsZW1lbnQiLGgsdGhpcyksdGhpcy5lbGVtZW50PXQoInBzd3BfX2NvbnRlbnQgcHN3cF9fZXJyb3ItbXNnLWNvbnRhaW5lciIsImRpdiIpLHRoaXMuZWxlbWVudC5hcHBlbmRDaGlsZChoKSx0aGlzLnNsaWRlLmNvbnRhaW5lci5pbm5lclRleHQ9IiIsdGhpcy5zbGlkZS5jb250YWluZXIuYXBwZW5kQ2hpbGQodGhpcy5lbGVtZW50KSx0aGlzLnNsaWRlLnVwZGF0ZUNvbnRlbnRTaXplKCEwKSx0aGlzLnJlbW92ZVBsYWNlaG9sZGVyKCl9fWFwcGVuZCgpe2lmKHRoaXMuaXNBdHRhY2hlZHx8IXRoaXMuZWxlbWVudClyZXR1cm47aWYodGhpcy5pc0F0dGFjaGVkPSEwLHRoaXMuc3RhdGU9PT1wKXJldHVybiB2b2lkIHRoaXMuZGlzcGxheUVycm9yKCk7aWYodGhpcy5pbnN0YW5jZS5kaXNwYXRjaCgiY29udGVudEFwcGVuZCIse2NvbnRlbnQ6dGhpc30pLmRlZmF1bHRQcmV2ZW50ZWQpcmV0dXJuO2NvbnN0IHQ9ImRlY29kZSJpbiB0aGlzLmVsZW1lbnQ7dGhpcy5pc0ltYWdlQ29udGVudCgpP3QmJnRoaXMuc2xpZGUmJighdGhpcy5zbGlkZS5pc0FjdGl2ZXx8bSgpKT8odGhpcy5pc0RlY29kaW5nPSEwLHRoaXMuZWxlbWVudC5kZWNvZGUoKS5jYXRjaCgoKCk9Pnt9KSkuZmluYWxseSgoKCk9Pnt0aGlzLmlzRGVjb2Rpbmc9ITEsdGhpcy5hcHBlbmRJbWFnZSgpfSkpKTp0aGlzLmFwcGVuZEltYWdlKCk6dGhpcy5zbGlkZSYmIXRoaXMuZWxlbWVudC5wYXJlbnROb2RlJiZ0aGlzLnNsaWRlLmNvbnRhaW5lci5hcHBlbmRDaGlsZCh0aGlzLmVsZW1lbnQpfWFjdGl2YXRlKCl7IXRoaXMuaW5zdGFuY2UuZGlzcGF0Y2goImNvbnRlbnRBY3RpdmF0ZSIse2NvbnRlbnQ6dGhpc30pLmRlZmF1bHRQcmV2ZW50ZWQmJnRoaXMuc2xpZGUmJih0aGlzLmlzSW1hZ2VDb250ZW50KCkmJnRoaXMuaXNEZWNvZGluZyYmIW0oKT90aGlzLmFwcGVuZEltYWdlKCk6dGhpcy5pc0Vycm9yKCkmJnRoaXMubG9hZCghMSwhMCksdGhpcy5zbGlkZS5ob2xkZXJFbGVtZW50JiZ0aGlzLnNsaWRlLmhvbGRlckVsZW1lbnQuc2V0QXR0cmlidXRlKCJhcmlhLWhpZGRlbiIsImZhbHNlIikpfWRlYWN0aXZhdGUoKXt0aGlzLmluc3RhbmNlLmRpc3BhdGNoKCJjb250ZW50RGVhY3RpdmF0ZSIse2NvbnRlbnQ6dGhpc30pLHRoaXMuc2xpZGUmJnRoaXMuc2xpZGUuaG9sZGVyRWxlbWVudCYmdGhpcy5zbGlkZS5ob2xkZXJFbGVtZW50LnNldEF0dHJpYnV0ZSgiYXJpYS1oaWRkZW4iLCJ0cnVlIil9cmVtb3ZlKCl7dGhpcy5pc0F0dGFjaGVkPSExLHRoaXMuaW5zdGFuY2UuZGlzcGF0Y2goImNvbnRlbnRSZW1vdmUiLHtjb250ZW50OnRoaXN9KS5kZWZhdWx0UHJldmVudGVkfHwodGhpcy5lbGVtZW50JiZ0aGlzLmVsZW1lbnQucGFyZW50Tm9kZSYmdGhpcy5lbGVtZW50LnJlbW92ZSgpLHRoaXMucGxhY2Vob2xkZXImJnRoaXMucGxhY2Vob2xkZXIuZWxlbWVudCYmdGhpcy5wbGFjZWhvbGRlci5lbGVtZW50LnJlbW92ZSgpKX1hcHBlbmRJbWFnZSgpe3RoaXMuaXNBdHRhY2hlZCYmKHRoaXMuaW5zdGFuY2UuZGlzcGF0Y2goImNvbnRlbnRBcHBlbmRJbWFnZSIse2NvbnRlbnQ6dGhpc30pLmRlZmF1bHRQcmV2ZW50ZWR8fCh0aGlzLnNsaWRlJiZ0aGlzLmVsZW1lbnQmJiF0aGlzLmVsZW1lbnQucGFyZW50Tm9kZSYmdGhpcy5zbGlkZS5jb250YWluZXIuYXBwZW5kQ2hpbGQodGhpcy5lbGVtZW50KSx0aGlzLnN0YXRlIT09dSYmdGhpcy5zdGF0ZSE9PXB8fHRoaXMucmVtb3ZlUGxhY2Vob2xkZXIoKSkpfX1mdW5jdGlvbiBKKHQsaSxzKXtjb25zdCBoPWkuY3JlYXRlQ29udGVudEZyb21EYXRhKHQscyk7bGV0IGU7Y29uc3R7b3B0aW9uczpufT1pO2lmKG4pe2xldCBvO2U9bmV3IHgobix0LC0xKSxvPWkucHN3cD9pLnBzd3Audmlld3BvcnRTaXplOncobixpKTtjb25zdCByPXkobixvLHQscyk7ZS51cGRhdGUoaC53aWR0aCxoLmhlaWdodCxyKX1yZXR1cm4gaC5sYXp5TG9hZCgpLGUmJmguc2V0RGlzcGxheWVkU2l6ZShNYXRoLmNlaWwoaC53aWR0aCplLmluaXRpYWwpLE1hdGguY2VpbChoLmhlaWdodCplLmluaXRpYWwpKSxofWNsYXNzIFF7Y29uc3RydWN0b3IodCl7dGhpcy5wc3dwPXQsdGhpcy5saW1pdD1NYXRoLm1heCh0Lm9wdGlvbnMucHJlbG9hZFswXSt0Lm9wdGlvbnMucHJlbG9hZFsxXSsxLDUpLHRoaXMuRHQ9W119dXBkYXRlTGF6eSh0KXtjb25zdHtwc3dwOml9PXRoaXM7aWYoaS5kaXNwYXRjaCgibGF6eUxvYWQiKS5kZWZhdWx0UHJldmVudGVkKXJldHVybjtjb25zdHtwcmVsb2FkOnN9PWkub3B0aW9ucyxoPXZvaWQgMD09PXR8fHQ+PTA7bGV0IGU7Zm9yKGU9MDtlPD1zWzFdO2UrKyl0aGlzLmxvYWRTbGlkZUJ5SW5kZXgoaS5jdXJySW5kZXgrKGg/ZTotZSkpO2ZvcihlPTE7ZTw9c1swXTtlKyspdGhpcy5sb2FkU2xpZGVCeUluZGV4KGkuY3VyckluZGV4KyhoPy1lOmUpKX1sb2FkU2xpZGVCeUluZGV4KHQpe2NvbnN0IGk9dGhpcy5wc3dwLmdldExvb3BlZEluZGV4KHQpO2xldCBzPXRoaXMuZ2V0Q29udGVudEJ5SW5kZXgoaSk7c3x8KHM9ZnVuY3Rpb24odCxpKXtjb25zdCBzPWkuZ2V0SXRlbURhdGEodCk7aWYoIWkuZGlzcGF0Y2goImxhenlMb2FkU2xpZGUiLHtpbmRleDp0LGl0ZW1EYXRhOnN9KS5kZWZhdWx0UHJldmVudGVkKXJldHVybiBKKHMsaSx0KX0oaSx0aGlzLnBzd3ApLHMmJnRoaXMuYWRkVG9DYWNoZShzKSl9Z2V0Q29udGVudEJ5U2xpZGUodCl7bGV0IGk9dGhpcy5nZXRDb250ZW50QnlJbmRleCh0LmluZGV4KTtyZXR1cm4gaXx8KGk9dGhpcy5wc3dwLmNyZWF0ZUNvbnRlbnRGcm9tRGF0YSh0LmRhdGEsdC5pbmRleCksdGhpcy5hZGRUb0NhY2hlKGkpKSxpLnNldFNsaWRlKHQpLGl9YWRkVG9DYWNoZSh0KXtpZih0aGlzLnJlbW92ZUJ5SW5kZXgodC5pbmRleCksdGhpcy5EdC5wdXNoKHQpLHRoaXMuRHQubGVuZ3RoPnRoaXMubGltaXQpe2NvbnN0IHQ9dGhpcy5EdC5maW5kSW5kZXgoKHQ9PiF0LmlzQXR0YWNoZWQmJiF0Lmhhc1NsaWRlKSk7aWYoLTEhPT10KXt0aGlzLkR0LnNwbGljZSh0LDEpWzBdLmRlc3Ryb3koKX19fXJlbW92ZUJ5SW5kZXgodCl7Y29uc3QgaT10aGlzLkR0LmZpbmRJbmRleCgoaT0+aS5pbmRleD09PXQpKTstMSE9PWkmJnRoaXMuRHQuc3BsaWNlKGksMSl9Z2V0Q29udGVudEJ5SW5kZXgodCl7cmV0dXJuIHRoaXMuRHQuZmluZCgoaT0+aS5pbmRleD09PXQpKX1kZXN0cm95KCl7dGhpcy5EdC5mb3JFYWNoKCh0PT50LmRlc3Ryb3koKSkpLHRoaXMuRHQ9W119fWNsYXNzIHR0e2NvbnN0cnVjdG9yKHQpe3RoaXMucHN3cD10LHRoaXMuaXNDbG9zZWQ9ITAsdGhpcy5pc09wZW49ITEsdGhpcy5pc0Nsb3Npbmc9ITEsdGhpcy5pc09wZW5pbmc9ITEsdGhpcy5JdD12b2lkIDAsdGhpcy5FdD0hMSx0aGlzLkx0PSExLHRoaXMua3Q9ITEsdGhpcy5adD0hMSx0aGlzLkJ0PXZvaWQgMCx0aGlzLkZ0PXZvaWQgMCx0aGlzLk90PXZvaWQgMCx0aGlzLlJ0PXZvaWQgMCx0aGlzLk50PXZvaWQgMCx0aGlzLlV0PXRoaXMuVXQuYmluZCh0aGlzKSx0Lm9uKCJmaXJzdFpvb21QYW4iLHRoaXMuVXQpfW9wZW4oKXt0aGlzLlV0KCksdGhpcy5QdCgpfWNsb3NlKCl7aWYodGhpcy5pc0Nsb3NlZHx8dGhpcy5pc0Nsb3Npbmd8fHRoaXMuaXNPcGVuaW5nKXJldHVybjtjb25zdCB0PXRoaXMucHN3cC5jdXJyU2xpZGU7dGhpcy5pc09wZW49ITEsdGhpcy5pc09wZW5pbmc9ITEsdGhpcy5pc0Nsb3Npbmc9ITAsdGhpcy5JdD10aGlzLnBzd3Aub3B0aW9ucy5oaWRlQW5pbWF0aW9uRHVyYXRpb24sdCYmdC5jdXJyWm9vbUxldmVsKnQud2lkdGg+PXRoaXMucHN3cC5vcHRpb25zLm1heFdpZHRoVG9BbmltYXRlJiYodGhpcy5JdD0wKSx0aGlzLlZ0KCksc2V0VGltZW91dCgoKCk9Pnt0aGlzLlB0KCl9KSx0aGlzLkx0PzMwOjApfVV0KCl7aWYodGhpcy5wc3dwLm9mZigiZmlyc3Rab29tUGFuIix0aGlzLlV0KSwhdGhpcy5pc09wZW5pbmcpe2NvbnN0IHQ9dGhpcy5wc3dwLmN1cnJTbGlkZTt0aGlzLmlzT3BlbmluZz0hMCx0aGlzLmlzQ2xvc2luZz0hMSx0aGlzLkl0PXRoaXMucHN3cC5vcHRpb25zLnNob3dBbmltYXRpb25EdXJhdGlvbix0JiZ0Lnpvb21MZXZlbHMuaW5pdGlhbCp0LndpZHRoPj10aGlzLnBzd3Aub3B0aW9ucy5tYXhXaWR0aFRvQW5pbWF0ZSYmKHRoaXMuSXQ9MCksdGhpcy5WdCgpfX1WdCgpe2NvbnN0e3Bzd3A6dH09dGhpcyxpPXRoaXMucHN3cC5jdXJyU2xpZGUse29wdGlvbnM6c309dDt2YXIgaCxlOygiZmFkZSI9PT1zLnNob3dIaWRlQW5pbWF0aW9uVHlwZT8ocy5zaG93SGlkZU9wYWNpdHk9ITAsdGhpcy5OdD12b2lkIDApOiJub25lIj09PXMuc2hvd0hpZGVBbmltYXRpb25UeXBlPyhzLnNob3dIaWRlT3BhY2l0eT0hMSx0aGlzLkl0PTAsdGhpcy5OdD12b2lkIDApOnRoaXMuaXNPcGVuaW5nJiZ0Lkd0P3RoaXMuTnQ9dC5HdDp0aGlzLk50PXRoaXMucHN3cC5nZXRUaHVtYkJvdW5kcygpLHRoaXMuQnQ9bnVsbD09aT92b2lkIDA6aS5nZXRQbGFjZWhvbGRlckVsZW1lbnQoKSx0LmFuaW1hdGlvbnMuc3RvcEFsbCgpLHRoaXMuRXQ9Qm9vbGVhbih0aGlzLkl0JiZ0aGlzLkl0PjUwKSx0aGlzLiR0PUJvb2xlYW4odGhpcy5OdCkmJihudWxsPT1pP3ZvaWQgMDppLmNvbnRlbnQudXNlUGxhY2Vob2xkZXIoKSkmJighdGhpcy5pc0Nsb3Npbmd8fCF0Lm1haW5TY3JvbGwuaXNTaGlmdGVkKCkpLHRoaXMuJHQpP3RoaXMua3Q9bnVsbCE9PShoPXMuc2hvd0hpZGVPcGFjaXR5KSYmdm9pZCAwIT09aCYmaDoodGhpcy5rdD0hMCx0aGlzLmlzT3BlbmluZyYmaSYmKGkuem9vbUFuZFBhblRvSW5pdGlhbCgpLGkuYXBwbHlDdXJyZW50Wm9vbVBhbigpKSk7aWYodGhpcy5adD0hdGhpcy5rdCYmdGhpcy5wc3dwLm9wdGlvbnMuYmdPcGFjaXR5Pi4wMDMsdGhpcy5GdD10aGlzLmt0P3QuZWxlbWVudDp0LmJnLCF0aGlzLkV0KXJldHVybiB0aGlzLkl0PTAsdGhpcy4kdD0hMSx0aGlzLlp0PSExLHRoaXMua3Q9ITAsdm9pZCh0aGlzLmlzT3BlbmluZyYmKHQuZWxlbWVudCYmKHQuZWxlbWVudC5zdHlsZS5vcGFjaXR5PVN0cmluZyguMDAzKSksdC5hcHBseUJnT3BhY2l0eSgxKSkpO3RoaXMuJHQmJnRoaXMuTnQmJnRoaXMuTnQuaW5uZXJSZWN0Pyh0aGlzLkx0PSEwLHRoaXMuT3Q9dGhpcy5wc3dwLmNvbnRhaW5lcix0aGlzLlJ0PW51bGw9PT0oZT10aGlzLnBzd3AuY3VyclNsaWRlKXx8dm9pZCAwPT09ZT92b2lkIDA6ZS5ob2xkZXJFbGVtZW50LHQuY29udGFpbmVyJiYodC5jb250YWluZXIuc3R5bGUub3ZlcmZsb3c9ImhpZGRlbiIsdC5jb250YWluZXIuc3R5bGUud2lkdGg9dC52aWV3cG9ydFNpemUueCsicHgiKSk6dGhpcy5MdD0hMTt0aGlzLmlzT3BlbmluZz8odGhpcy5rdD8odC5lbGVtZW50JiYodC5lbGVtZW50LnN0eWxlLm9wYWNpdHk9U3RyaW5nKC4wMDMpKSx0LmFwcGx5QmdPcGFjaXR5KDEpKToodGhpcy5adCYmdC5iZyYmKHQuYmcuc3R5bGUub3BhY2l0eT1TdHJpbmcoLjAwMykpLHQuZWxlbWVudCYmKHQuZWxlbWVudC5zdHlsZS5vcGFjaXR5PSIxIikpLHRoaXMuJHQmJih0aGlzLnF0KCksdGhpcy5CdCYmKHRoaXMuQnQuc3R5bGUud2lsbENoYW5nZT0idHJhbnNmb3JtIix0aGlzLkJ0LnN0eWxlLm9wYWNpdHk9U3RyaW5nKC4wMDMpKSkpOnRoaXMuaXNDbG9zaW5nJiYodC5tYWluU2Nyb2xsLml0ZW1Ib2xkZXJzWzBdJiYodC5tYWluU2Nyb2xsLml0ZW1Ib2xkZXJzWzBdLmVsLnN0eWxlLmRpc3BsYXk9Im5vbmUiKSx0Lm1haW5TY3JvbGwuaXRlbUhvbGRlcnNbMl0mJih0Lm1haW5TY3JvbGwuaXRlbUhvbGRlcnNbMl0uZWwuc3R5bGUuZGlzcGxheT0ibm9uZSIpLHRoaXMuTHQmJjAhPT10Lm1haW5TY3JvbGwueCYmKHQubWFpblNjcm9sbC5yZXNldFBvc2l0aW9uKCksdC5tYWluU2Nyb2xsLnJlc2l6ZSgpKSl9UHQoKXt0aGlzLmlzT3BlbmluZyYmdGhpcy5FdCYmdGhpcy5CdCYmIklNRyI9PT10aGlzLkJ0LnRhZ05hbWU/bmV3IFByb21pc2UoKHQ9PntsZXQgaT0hMSxzPSEwO3ZhciBoOyhoPXRoaXMuQnQsImRlY29kZSJpbiBoP2guZGVjb2RlKCkuY2F0Y2goKCgpPT57fSkpOmguY29tcGxldGU/UHJvbWlzZS5yZXNvbHZlKGgpOm5ldyBQcm9taXNlKCgodCxpKT0+e2gub25sb2FkPSgpPT50KGgpLGgub25lcnJvcj1pfSkpKS5maW5hbGx5KCgoKT0+e2k9ITAsc3x8dCghMCl9KSksc2V0VGltZW91dCgoKCk9PntzPSExLGkmJnQoITApfSksNTApLHNldFRpbWVvdXQodCwyNTApfSkpLmZpbmFsbHkoKCgpPT50aGlzLkh0KCkpKTp0aGlzLkh0KCl9SHQoKXt2YXIgdCxpO251bGw9PT0odD10aGlzLnBzd3AuZWxlbWVudCl8fHZvaWQgMD09PXR8fHQuc3R5bGUuc2V0UHJvcGVydHkoIi0tcHN3cC10cmFuc2l0aW9uLWR1cmF0aW9uIix0aGlzLkl0KyJtcyIpLHRoaXMucHN3cC5kaXNwYXRjaCh0aGlzLmlzT3BlbmluZz8ib3BlbmluZ0FuaW1hdGlvblN0YXJ0IjoiY2xvc2luZ0FuaW1hdGlvblN0YXJ0IiksdGhpcy5wc3dwLmRpc3BhdGNoKCJpbml0aWFsWm9vbSIrKHRoaXMuaXNPcGVuaW5nPyJJbiI6Ik91dCIpKSxudWxsPT09KGk9dGhpcy5wc3dwLmVsZW1lbnQpfHx2b2lkIDA9PT1pfHxpLmNsYXNzTGlzdC50b2dnbGUoInBzd3AtLXVpLXZpc2libGUiLHRoaXMuaXNPcGVuaW5nKSx0aGlzLmlzT3BlbmluZz8odGhpcy5CdCYmKHRoaXMuQnQuc3R5bGUub3BhY2l0eT0iMSIpLHRoaXMuS3QoKSk6dGhpcy5pc0Nsb3NpbmcmJnRoaXMuV3QoKSx0aGlzLkV0fHx0aGlzLmp0KCl9anQoKXtjb25zdHtwc3dwOnR9PXRoaXM7aWYodGhpcy5pc09wZW49dGhpcy5pc09wZW5pbmcsdGhpcy5pc0Nsb3NlZD10aGlzLmlzQ2xvc2luZyx0aGlzLmlzT3BlbmluZz0hMSx0aGlzLmlzQ2xvc2luZz0hMSx0LmRpc3BhdGNoKHRoaXMuaXNPcGVuPyJvcGVuaW5nQW5pbWF0aW9uRW5kIjoiY2xvc2luZ0FuaW1hdGlvbkVuZCIpLHQuZGlzcGF0Y2goImluaXRpYWxab29tIisodGhpcy5pc09wZW4/IkluRW5kIjoiT3V0RW5kIikpLHRoaXMuaXNDbG9zZWQpdC5kZXN0cm95KCk7ZWxzZSBpZih0aGlzLmlzT3Blbil7dmFyIGk7dGhpcy4kdCYmdC5jb250YWluZXImJih0LmNvbnRhaW5lci5zdHlsZS5vdmVyZmxvdz0idmlzaWJsZSIsdC5jb250YWluZXIuc3R5bGUud2lkdGg9IjEwMCUiKSxudWxsPT09KGk9dC5jdXJyU2xpZGUpfHx2b2lkIDA9PT1pfHxpLmFwcGx5Q3VycmVudFpvb21QYW4oKX19S3QoKXtjb25zdHtwc3dwOnR9PXRoaXM7dGhpcy4kdCYmKHRoaXMuTHQmJnRoaXMuT3QmJnRoaXMuUnQmJih0aGlzLlh0KHRoaXMuT3QsInRyYW5zZm9ybSIsInRyYW5zbGF0ZTNkKDAsMCwwKSIpLHRoaXMuWHQodGhpcy5SdCwidHJhbnNmb3JtIiwibm9uZSIpKSx0LmN1cnJTbGlkZSYmKHQuY3VyclNsaWRlLnpvb21BbmRQYW5Ub0luaXRpYWwoKSx0aGlzLlh0KHQuY3VyclNsaWRlLmNvbnRhaW5lciwidHJhbnNmb3JtIix0LmN1cnJTbGlkZS5nZXRDdXJyZW50VHJhbnNmb3JtKCkpKSksdGhpcy5adCYmdC5iZyYmdGhpcy5YdCh0LmJnLCJvcGFjaXR5IixTdHJpbmcodC5vcHRpb25zLmJnT3BhY2l0eSkpLHRoaXMua3QmJnQuZWxlbWVudCYmdGhpcy5YdCh0LmVsZW1lbnQsIm9wYWNpdHkiLCIxIil9V3QoKXtjb25zdHtwc3dwOnR9PXRoaXM7dGhpcy4kdCYmdGhpcy5xdCghMCksdGhpcy5adCYmdC5iZ09wYWNpdHk+LjAxJiZ0LmJnJiZ0aGlzLlh0KHQuYmcsIm9wYWNpdHkiLCIwIiksdGhpcy5rdCYmdC5lbGVtZW50JiZ0aGlzLlh0KHQuZWxlbWVudCwib3BhY2l0eSIsIjAiKX1xdCh0KXtpZighdGhpcy5OdClyZXR1cm47Y29uc3R7cHN3cDpzfT10aGlzLHtpbm5lclJlY3Q6aH09dGhpcy5OdCx7Y3VyclNsaWRlOmUsdmlld3BvcnRTaXplOm59PXM7aWYodGhpcy5MdCYmaCYmdGhpcy5PdCYmdGhpcy5SdCl7Y29uc3QgaT0tbi54Kyh0aGlzLk50LngtaC54KStoLncscz0tbi55Kyh0aGlzLk50LnktaC55KStoLmgsZT1uLngtaC53LGE9bi55LWguaDt0Pyh0aGlzLlh0KHRoaXMuT3QsInRyYW5zZm9ybSIsbyhpLHMpKSx0aGlzLlh0KHRoaXMuUnQsInRyYW5zZm9ybSIsbyhlLGEpKSk6KHIodGhpcy5PdCxpLHMpLHIodGhpcy5SdCxlLGEpKX1lJiYoaShlLnBhbixofHx0aGlzLk50KSxlLmN1cnJab29tTGV2ZWw9dGhpcy5OdC53L2Uud2lkdGgsdD90aGlzLlh0KGUuY29udGFpbmVyLCJ0cmFuc2Zvcm0iLGUuZ2V0Q3VycmVudFRyYW5zZm9ybSgpKTplLmFwcGx5Q3VycmVudFpvb21QYW4oKSl9WHQodCxpLHMpe2lmKCF0aGlzLkl0KXJldHVybiB2b2lkKHQuc3R5bGVbaV09cyk7Y29uc3R7YW5pbWF0aW9uczpofT10aGlzLnBzd3AsZT17ZHVyYXRpb246dGhpcy5JdCxlYXNpbmc6dGhpcy5wc3dwLm9wdGlvbnMuZWFzaW5nLG9uQ29tcGxldGU6KCk9PntoLmFjdGl2ZUFuaW1hdGlvbnMubGVuZ3RofHx0aGlzLmp0KCl9LHRhcmdldDp0fTtlW2ldPXMsaC5zdGFydFRyYW5zaXRpb24oZSl9fWNvbnN0IGl0PXthbGxvd1BhblRvTmV4dDohMCxzcGFjaW5nOi4xLGxvb3A6ITAscGluY2hUb0Nsb3NlOiEwLGNsb3NlT25WZXJ0aWNhbERyYWc6ITAsaGlkZUFuaW1hdGlvbkR1cmF0aW9uOjMzMyxzaG93QW5pbWF0aW9uRHVyYXRpb246MzMzLHpvb21BbmltYXRpb25EdXJhdGlvbjozMzMsZXNjS2V5OiEwLGFycm93S2V5czohMCx0cmFwRm9jdXM6ITAscmV0dXJuRm9jdXM6ITAsbWF4V2lkdGhUb0FuaW1hdGU6NGUzLGNsaWNrVG9DbG9zZU5vblpvb21hYmxlOiEwLGltYWdlQ2xpY2tBY3Rpb246Inpvb20tb3ItY2xvc2UiLGJnQ2xpY2tBY3Rpb246ImNsb3NlIix0YXBBY3Rpb246InRvZ2dsZS1jb250cm9scyIsZG91YmxlVGFwQWN0aW9uOiJ6b29tIixpbmRleEluZGljYXRvclNlcDoiIC8gIixwcmVsb2FkZXJEZWxheToyZTMsYmdPcGFjaXR5Oi44LGluZGV4OjAsZXJyb3JNc2c6IlRoZSBpbWFnZSBjYW5ub3QgYmUgbG9hZGVkIixwcmVsb2FkOlsxLDJdLGVhc2luZzoiY3ViaWMtYmV6aWVyKC40LDAsLjIyLDEpIn07Y2xhc3Mgc3QgZXh0ZW5kcyBjbGFzcyBleHRlbmRzIGNsYXNze2NvbnN0cnVjdG9yKCl7dGhpcy5ZdD17fSx0aGlzLkp0PXt9LHRoaXMucHN3cD12b2lkIDAsdGhpcy5vcHRpb25zPXZvaWQgMH1hZGRGaWx0ZXIodCxpLHM9MTAwKXt2YXIgaCxlLG47dGhpcy5KdFt0XXx8KHRoaXMuSnRbdF09W10pLG51bGw9PT0oaD10aGlzLkp0W3RdKXx8dm9pZCAwPT09aHx8aC5wdXNoKHtmbjppLHByaW9yaXR5OnN9KSxudWxsPT09KGU9dGhpcy5KdFt0XSl8fHZvaWQgMD09PWV8fGUuc29ydCgoKHQsaSk9PnQucHJpb3JpdHktaS5wcmlvcml0eSkpLG51bGw9PT0obj10aGlzLnBzd3ApfHx2b2lkIDA9PT1ufHxuLmFkZEZpbHRlcih0LGkscyl9cmVtb3ZlRmlsdGVyKHQsaSl7dGhpcy5KdFt0XSYmKHRoaXMuSnRbdF09dGhpcy5KdFt0XS5maWx0ZXIoKHQ9PnQuZm4hPT1pKSkpLHRoaXMucHN3cCYmdGhpcy5wc3dwLnJlbW92ZUZpbHRlcih0LGkpfWFwcGx5RmlsdGVycyh0LC4uLmkpe3ZhciBzO3JldHVybiBudWxsPT09KHM9dGhpcy5KdFt0XSl8fHZvaWQgMD09PXN8fHMuZm9yRWFjaCgodD0+e2lbMF09dC5mbi5hcHBseSh0aGlzLGkpfSkpLGlbMF19b24odCxpKXt2YXIgcyxoO3RoaXMuWXRbdF18fCh0aGlzLll0W3RdPVtdKSxudWxsPT09KHM9dGhpcy5ZdFt0XSl8fHZvaWQgMD09PXN8fHMucHVzaChpKSxudWxsPT09KGg9dGhpcy5wc3dwKXx8dm9pZCAwPT09aHx8aC5vbih0LGkpfW9mZih0LGkpe3ZhciBzO3RoaXMuWXRbdF0mJih0aGlzLll0W3RdPXRoaXMuWXRbdF0uZmlsdGVyKCh0PT5pIT09dCkpKSxudWxsPT09KHM9dGhpcy5wc3dwKXx8dm9pZCAwPT09c3x8cy5vZmYodCxpKX1kaXNwYXRjaCh0LGkpe3ZhciBzO2lmKHRoaXMucHN3cClyZXR1cm4gdGhpcy5wc3dwLmRpc3BhdGNoKHQsaSk7Y29uc3QgaD1uZXcgaih0LGkpO3JldHVybiBudWxsPT09KHM9dGhpcy5ZdFt0XSl8fHZvaWQgMD09PXN8fHMuZm9yRWFjaCgodD0+e3QuY2FsbCh0aGlzLGgpfSkpLGh9fXtnZXROdW1JdGVtcygpe3ZhciB0O2xldCBpPTA7Y29uc3Qgcz1udWxsPT09KHQ9dGhpcy5vcHRpb25zKXx8dm9pZCAwPT09dD92b2lkIDA6dC5kYXRhU291cmNlO3MmJiJsZW5ndGgiaW4gcz9pPXMubGVuZ3RoOnMmJiJnYWxsZXJ5ImluIHMmJihzLml0ZW1zfHwocy5pdGVtcz10aGlzLlF0KHMuZ2FsbGVyeSkpLHMuaXRlbXMmJihpPXMuaXRlbXMubGVuZ3RoKSk7Y29uc3QgaD10aGlzLmRpc3BhdGNoKCJudW1JdGVtcyIse2RhdGFTb3VyY2U6cyxudW1JdGVtczppfSk7cmV0dXJuIHRoaXMuYXBwbHlGaWx0ZXJzKCJudW1JdGVtcyIsaC5udW1JdGVtcyxzKX1jcmVhdGVDb250ZW50RnJvbURhdGEodCxpKXtyZXR1cm4gbmV3IFkodCx0aGlzLGkpfWdldEl0ZW1EYXRhKHQpe3ZhciBpO2NvbnN0IHM9bnVsbD09PShpPXRoaXMub3B0aW9ucyl8fHZvaWQgMD09PWk/dm9pZCAwOmkuZGF0YVNvdXJjZTtsZXQgaD17fTtBcnJheS5pc0FycmF5KHMpP2g9c1t0XTpzJiYiZ2FsbGVyeSJpbiBzJiYocy5pdGVtc3x8KHMuaXRlbXM9dGhpcy5RdChzLmdhbGxlcnkpKSxoPXMuaXRlbXNbdF0pO2xldCBlPWg7ZSBpbnN0YW5jZW9mIEVsZW1lbnQmJihlPXRoaXMudGkoZSkpO2NvbnN0IG49dGhpcy5kaXNwYXRjaCgiaXRlbURhdGEiLHtpdGVtRGF0YTplfHx7fSxpbmRleDp0fSk7cmV0dXJuIHRoaXMuYXBwbHlGaWx0ZXJzKCJpdGVtRGF0YSIsbi5pdGVtRGF0YSx0KX1RdCh0KXt2YXIgaSxzO3JldHVybiBudWxsIT09KGk9dGhpcy5vcHRpb25zKSYmdm9pZCAwIT09aSYmaS5jaGlsZHJlbnx8bnVsbCE9PShzPXRoaXMub3B0aW9ucykmJnZvaWQgMCE9PXMmJnMuY2hpbGRTZWxlY3Rvcj9mdW5jdGlvbih0LGkscz1kb2N1bWVudCl7bGV0IGg9W107aWYodCBpbnN0YW5jZW9mIEVsZW1lbnQpaD1bdF07ZWxzZSBpZih0IGluc3RhbmNlb2YgTm9kZUxpc3R8fEFycmF5LmlzQXJyYXkodCkpaD1BcnJheS5mcm9tKHQpO2Vsc2V7Y29uc3QgZT0ic3RyaW5nIj09dHlwZW9mIHQ/dDppO2UmJihoPUFycmF5LmZyb20ocy5xdWVyeVNlbGVjdG9yQWxsKGUpKSl9cmV0dXJuIGh9KHRoaXMub3B0aW9ucy5jaGlsZHJlbix0aGlzLm9wdGlvbnMuY2hpbGRTZWxlY3Rvcix0KXx8W106W3RdfXRpKHQpe2NvbnN0IGk9e2VsZW1lbnQ6dH0scz0iQSI9PT10LnRhZ05hbWU/dDp0LnF1ZXJ5U2VsZWN0b3IoImEiKTtpZihzKXtpLnNyYz1zLmRhdGFzZXQucHN3cFNyY3x8cy5ocmVmLHMuZGF0YXNldC5wc3dwU3Jjc2V0JiYoaS5zcmNzZXQ9cy5kYXRhc2V0LnBzd3BTcmNzZXQpLGkud2lkdGg9cy5kYXRhc2V0LnBzd3BXaWR0aD9wYXJzZUludChzLmRhdGFzZXQucHN3cFdpZHRoLDEwKTowLGkuaGVpZ2h0PXMuZGF0YXNldC5wc3dwSGVpZ2h0P3BhcnNlSW50KHMuZGF0YXNldC5wc3dwSGVpZ2h0LDEwKTowLGkudz1pLndpZHRoLGkuaD1pLmhlaWdodCxzLmRhdGFzZXQucHN3cFR5cGUmJihpLnR5cGU9cy5kYXRhc2V0LnBzd3BUeXBlKTtjb25zdCBlPXQucXVlcnlTZWxlY3RvcigiaW1nIik7dmFyIGg7aWYoZSlpLm1zcmM9ZS5jdXJyZW50U3JjfHxlLnNyYyxpLmFsdD1udWxsIT09KGg9ZS5nZXRBdHRyaWJ1dGUoImFsdCIpKSYmdm9pZCAwIT09aD9oOiIiOyhzLmRhdGFzZXQucHN3cENyb3BwZWR8fHMuZGF0YXNldC5jcm9wcGVkKSYmKGkudGh1bWJDcm9wcGVkPSEwKX1yZXR1cm4gdGhpcy5hcHBseUZpbHRlcnMoImRvbUl0ZW1EYXRhIixpLHQscyl9bGF6eUxvYWREYXRhKHQsaSl7cmV0dXJuIEoodCx0aGlzLGkpfX17Y29uc3RydWN0b3IodCl7c3VwZXIoKSx0aGlzLm9wdGlvbnM9dGhpcy5paSh0fHx7fSksdGhpcy5vZmZzZXQ9e3g6MCx5OjB9LHRoaXMuc2k9e3g6MCx5OjB9LHRoaXMudmlld3BvcnRTaXplPXt4OjAseTowfSx0aGlzLmJnT3BhY2l0eT0xLHRoaXMuY3VyckluZGV4PTAsdGhpcy5wb3RlbnRpYWxJbmRleD0wLHRoaXMuaXNPcGVuPSExLHRoaXMuaXNEZXN0cm95aW5nPSExLHRoaXMuaGFzTW91c2U9ITEsdGhpcy5oaT17fSx0aGlzLkd0PXZvaWQgMCx0aGlzLnRvcEJhcj12b2lkIDAsdGhpcy5lbGVtZW50PXZvaWQgMCx0aGlzLnRlbXBsYXRlPXZvaWQgMCx0aGlzLmNvbnRhaW5lcj12b2lkIDAsdGhpcy5zY3JvbGxXcmFwPXZvaWQgMCx0aGlzLmN1cnJTbGlkZT12b2lkIDAsdGhpcy5ldmVudHM9bmV3IGYsdGhpcy5hbmltYXRpb25zPW5ldyBGLHRoaXMubWFpblNjcm9sbD1uZXcgQSh0aGlzKSx0aGlzLmdlc3R1cmVzPW5ldyBUKHRoaXMpLHRoaXMub3BlbmVyPW5ldyB0dCh0aGlzKSx0aGlzLmtleWJvYXJkPW5ldyBFKHRoaXMpLHRoaXMuY29udGVudExvYWRlcj1uZXcgUSh0aGlzKX1pbml0KCl7aWYodGhpcy5pc09wZW58fHRoaXMuaXNEZXN0cm95aW5nKXJldHVybiExO3RoaXMuaXNPcGVuPSEwLHRoaXMuZGlzcGF0Y2goImluaXQiKSx0aGlzLmRpc3BhdGNoKCJiZWZvcmVPcGVuIiksdGhpcy5laSgpO2xldCB0PSJwc3dwLS1vcGVuIjtyZXR1cm4gdGhpcy5nZXN0dXJlcy5zdXBwb3J0c1RvdWNoJiYodCs9IiBwc3dwLS10b3VjaCIpLHRoaXMub3B0aW9ucy5tYWluQ2xhc3MmJih0Kz0iICIrdGhpcy5vcHRpb25zLm1haW5DbGFzcyksdGhpcy5lbGVtZW50JiYodGhpcy5lbGVtZW50LmNsYXNzTmFtZSs9IiAiK3QpLHRoaXMuY3VyckluZGV4PXRoaXMub3B0aW9ucy5pbmRleHx8MCx0aGlzLnBvdGVudGlhbEluZGV4PXRoaXMuY3VyckluZGV4LHRoaXMuZGlzcGF0Y2goImZpcnN0VXBkYXRlIiksdGhpcy5zY3JvbGxXaGVlbD1uZXcgTyh0aGlzKSwoTnVtYmVyLmlzTmFOKHRoaXMuY3VyckluZGV4KXx8dGhpcy5jdXJySW5kZXg8MHx8dGhpcy5jdXJySW5kZXg+PXRoaXMuZ2V0TnVtSXRlbXMoKSkmJih0aGlzLmN1cnJJbmRleD0wKSx0aGlzLmdlc3R1cmVzLnN1cHBvcnRzVG91Y2h8fHRoaXMubW91c2VEZXRlY3RlZCgpLHRoaXMudXBkYXRlU2l6ZSgpLHRoaXMub2Zmc2V0Lnk9d2luZG93LnBhZ2VZT2Zmc2V0LHRoaXMuaGk9dGhpcy5nZXRJdGVtRGF0YSh0aGlzLmN1cnJJbmRleCksdGhpcy5kaXNwYXRjaCgiZ2V0dGluZ0RhdGEiLHtpbmRleDp0aGlzLmN1cnJJbmRleCxkYXRhOnRoaXMuaGksc2xpZGU6dm9pZCAwfSksdGhpcy5HdD10aGlzLmdldFRodW1iQm91bmRzKCksdGhpcy5kaXNwYXRjaCgiaW5pdGlhbExheW91dCIpLHRoaXMub24oIm9wZW5pbmdBbmltYXRpb25FbmQiLCgoKT0+e2NvbnN0e2l0ZW1Ib2xkZXJzOnR9PXRoaXMubWFpblNjcm9sbDt0WzBdJiYodFswXS5lbC5zdHlsZS5kaXNwbGF5PSJibG9jayIsdGhpcy5zZXRDb250ZW50KHRbMF0sdGhpcy5jdXJySW5kZXgtMSkpLHRbMl0mJih0WzJdLmVsLnN0eWxlLmRpc3BsYXk9ImJsb2NrIix0aGlzLnNldENvbnRlbnQodFsyXSx0aGlzLmN1cnJJbmRleCsxKSksdGhpcy5hcHBlbmRIZWF2eSgpLHRoaXMuY29udGVudExvYWRlci51cGRhdGVMYXp5KCksdGhpcy5ldmVudHMuYWRkKHdpbmRvdywicmVzaXplIix0aGlzLm5pLmJpbmQodGhpcykpLHRoaXMuZXZlbnRzLmFkZCh3aW5kb3csInNjcm9sbCIsdGhpcy5vaS5iaW5kKHRoaXMpKSx0aGlzLmRpc3BhdGNoKCJiaW5kRXZlbnRzIil9KSksdGhpcy5tYWluU2Nyb2xsLml0ZW1Ib2xkZXJzWzFdJiZ0aGlzLnNldENvbnRlbnQodGhpcy5tYWluU2Nyb2xsLml0ZW1Ib2xkZXJzWzFdLHRoaXMuY3VyckluZGV4KSx0aGlzLmRpc3BhdGNoKCJjaGFuZ2UiKSx0aGlzLm9wZW5lci5vcGVuKCksdGhpcy5kaXNwYXRjaCgiYWZ0ZXJJbml0IiksITB9Z2V0TG9vcGVkSW5kZXgodCl7Y29uc3QgaT10aGlzLmdldE51bUl0ZW1zKCk7cmV0dXJuIHRoaXMub3B0aW9ucy5sb29wJiYodD5pLTEmJih0LT1pKSx0PDAmJih0Kz1pKSksbih0LDAsaS0xKX1hcHBlbmRIZWF2eSgpe3RoaXMubWFpblNjcm9sbC5pdGVtSG9sZGVycy5mb3JFYWNoKCh0PT57dmFyIGk7bnVsbD09PShpPXQuc2xpZGUpfHx2b2lkIDA9PT1pfHxpLmFwcGVuZEhlYXZ5KCl9KSl9Z29Ubyh0KXt0aGlzLm1haW5TY3JvbGwubW92ZUluZGV4QnkodGhpcy5nZXRMb29wZWRJbmRleCh0KS10aGlzLnBvdGVudGlhbEluZGV4KX1uZXh0KCl7dGhpcy5nb1RvKHRoaXMucG90ZW50aWFsSW5kZXgrMSl9cHJldigpe3RoaXMuZ29Ubyh0aGlzLnBvdGVudGlhbEluZGV4LTEpfXpvb21UbyguLi50KXt2YXIgaTtudWxsPT09KGk9dGhpcy5jdXJyU2xpZGUpfHx2b2lkIDA9PT1pfHxpLnpvb21UbyguLi50KX10b2dnbGVab29tKCl7dmFyIHQ7bnVsbD09PSh0PXRoaXMuY3VyclNsaWRlKXx8dm9pZCAwPT09dHx8dC50b2dnbGVab29tKCl9Y2xvc2UoKXt0aGlzLm9wZW5lci5pc09wZW4mJiF0aGlzLmlzRGVzdHJveWluZyYmKHRoaXMuaXNEZXN0cm95aW5nPSEwLHRoaXMuZGlzcGF0Y2goImNsb3NlIiksdGhpcy5ldmVudHMucmVtb3ZlQWxsKCksdGhpcy5vcGVuZXIuY2xvc2UoKSl9ZGVzdHJveSgpe3ZhciB0O2lmKCF0aGlzLmlzRGVzdHJveWluZylyZXR1cm4gdGhpcy5vcHRpb25zLnNob3dIaWRlQW5pbWF0aW9uVHlwZT0ibm9uZSIsdm9pZCB0aGlzLmNsb3NlKCk7dGhpcy5kaXNwYXRjaCgiZGVzdHJveSIpLHRoaXMuWXQ9e30sdGhpcy5zY3JvbGxXcmFwJiYodGhpcy5zY3JvbGxXcmFwLm9udG91Y2htb3ZlPW51bGwsdGhpcy5zY3JvbGxXcmFwLm9udG91Y2hlbmQ9bnVsbCksbnVsbD09PSh0PXRoaXMuZWxlbWVudCl8fHZvaWQgMD09PXR8fHQucmVtb3ZlKCksdGhpcy5tYWluU2Nyb2xsLml0ZW1Ib2xkZXJzLmZvckVhY2goKHQ9Pnt2YXIgaTtudWxsPT09KGk9dC5zbGlkZSl8fHZvaWQgMD09PWl8fGkuZGVzdHJveSgpfSkpLHRoaXMuY29udGVudExvYWRlci5kZXN0cm95KCksdGhpcy5ldmVudHMucmVtb3ZlQWxsKCl9cmVmcmVzaFNsaWRlQ29udGVudCh0KXt0aGlzLmNvbnRlbnRMb2FkZXIucmVtb3ZlQnlJbmRleCh0KSx0aGlzLm1haW5TY3JvbGwuaXRlbUhvbGRlcnMuZm9yRWFjaCgoKGkscyk9Pnt2YXIgaCxlO2xldCBuPShudWxsIT09KGg9bnVsbD09PShlPXRoaXMuY3VyclNsaWRlKXx8dm9pZCAwPT09ZT92b2lkIDA6ZS5pbmRleCkmJnZvaWQgMCE9PWg/aDowKS0xK3M7dmFyIG87KHRoaXMuY2FuTG9vcCgpJiYobj10aGlzLmdldExvb3BlZEluZGV4KG4pKSxuPT09dCkmJih0aGlzLnNldENvbnRlbnQoaSx0LCEwKSwxPT09cyYmKHRoaXMuY3VyclNsaWRlPWkuc2xpZGUsbnVsbD09PShvPWkuc2xpZGUpfHx2b2lkIDA9PT1vfHxvLnNldElzQWN0aXZlKCEwKSkpfSkpLHRoaXMuZGlzcGF0Y2goImNoYW5nZSIpfXNldENvbnRlbnQodCxpLHMpe2lmKHRoaXMuY2FuTG9vcCgpJiYoaT10aGlzLmdldExvb3BlZEluZGV4KGkpKSx0LnNsaWRlKXtpZih0LnNsaWRlLmluZGV4PT09aSYmIXMpcmV0dXJuO3Quc2xpZGUuZGVzdHJveSgpLHQuc2xpZGU9dm9pZCAwfWlmKCF0aGlzLmNhbkxvb3AoKSYmKGk8MHx8aT49dGhpcy5nZXROdW1JdGVtcygpKSlyZXR1cm47Y29uc3QgaD10aGlzLmdldEl0ZW1EYXRhKGkpO3Quc2xpZGU9bmV3IGIoaCxpLHRoaXMpLGk9PT10aGlzLmN1cnJJbmRleCYmKHRoaXMuY3VyclNsaWRlPXQuc2xpZGUpLHQuc2xpZGUuYXBwZW5kKHQuZWwpfWdldFZpZXdwb3J0Q2VudGVyUG9pbnQoKXtyZXR1cm57eDp0aGlzLnZpZXdwb3J0U2l6ZS54LzIseTp0aGlzLnZpZXdwb3J0U2l6ZS55LzJ9fXVwZGF0ZVNpemUodCl7aWYodGhpcy5pc0Rlc3Ryb3lpbmcpcmV0dXJuO2NvbnN0IHM9dyh0aGlzLm9wdGlvbnMsdGhpcyk7IXQmJmUocyx0aGlzLnNpKXx8KGkodGhpcy5zaSxzKSx0aGlzLmRpc3BhdGNoKCJiZWZvcmVSZXNpemUiKSxpKHRoaXMudmlld3BvcnRTaXplLHRoaXMuc2kpLHRoaXMub2koKSx0aGlzLmRpc3BhdGNoKCJ2aWV3cG9ydFNpemUiKSx0aGlzLm1haW5TY3JvbGwucmVzaXplKHRoaXMub3BlbmVyLmlzT3BlbiksIXRoaXMuaGFzTW91c2UmJndpbmRvdy5tYXRjaE1lZGlhKCIoYW55LWhvdmVyOiBob3ZlcikiKS5tYXRjaGVzJiZ0aGlzLm1vdXNlRGV0ZWN0ZWQoKSx0aGlzLmRpc3BhdGNoKCJyZXNpemUiKSl9YXBwbHlCZ09wYWNpdHkodCl7dGhpcy5iZ09wYWNpdHk9TWF0aC5tYXgodCwwKSx0aGlzLmJnJiYodGhpcy5iZy5zdHlsZS5vcGFjaXR5PVN0cmluZyh0aGlzLmJnT3BhY2l0eSp0aGlzLm9wdGlvbnMuYmdPcGFjaXR5KSl9bW91c2VEZXRlY3RlZCgpe3ZhciB0O3RoaXMuaGFzTW91c2V8fCh0aGlzLmhhc01vdXNlPSEwLG51bGw9PT0odD10aGlzLmVsZW1lbnQpfHx2b2lkIDA9PT10fHx0LmNsYXNzTGlzdC5hZGQoInBzd3AtLWhhc19tb3VzZSIpKX1uaSgpe3RoaXMudXBkYXRlU2l6ZSgpLC9pUGhvbmV8aVBhZHxpUG9kL2kudGVzdCh3aW5kb3cubmF2aWdhdG9yLnVzZXJBZ2VudCkmJnNldFRpbWVvdXQoKCgpPT57dGhpcy51cGRhdGVTaXplKCl9KSw1MDApfW9pKCl7dGhpcy5zZXRTY3JvbGxPZmZzZXQoMCx3aW5kb3cucGFnZVlPZmZzZXQpfXNldFNjcm9sbE9mZnNldCh0LGkpe3RoaXMub2Zmc2V0Lng9dCx0aGlzLm9mZnNldC55PWksdGhpcy5kaXNwYXRjaCgidXBkYXRlU2Nyb2xsT2Zmc2V0Iil9ZWkoKXt0aGlzLmVsZW1lbnQ9dCgicHN3cCIsImRpdiIpLHRoaXMuZWxlbWVudC5zZXRBdHRyaWJ1dGUoInRhYmluZGV4IiwiLTEiKSx0aGlzLmVsZW1lbnQuc2V0QXR0cmlidXRlKCJyb2xlIiwiZGlhbG9nIiksdGhpcy50ZW1wbGF0ZT10aGlzLmVsZW1lbnQsdGhpcy5iZz10KCJwc3dwX19iZyIsImRpdiIsdGhpcy5lbGVtZW50KSx0aGlzLnNjcm9sbFdyYXA9dCgicHN3cF9fc2Nyb2xsLXdyYXAiLCJzZWN0aW9uIix0aGlzLmVsZW1lbnQpLHRoaXMuY29udGFpbmVyPXQoInBzd3BfX2NvbnRhaW5lciIsImRpdiIsdGhpcy5zY3JvbGxXcmFwKSx0aGlzLnNjcm9sbFdyYXAuc2V0QXR0cmlidXRlKCJhcmlhLXJvbGVkZXNjcmlwdGlvbiIsImNhcm91c2VsIiksdGhpcy5jb250YWluZXIuc2V0QXR0cmlidXRlKCJhcmlhLWxpdmUiLCJvZmYiKSx0aGlzLmNvbnRhaW5lci5zZXRBdHRyaWJ1dGUoImlkIiwicHN3cF9faXRlbXMiKSx0aGlzLm1haW5TY3JvbGwuYXBwZW5kSG9sZGVycygpLHRoaXMudWk9bmV3IFcodGhpcyksdGhpcy51aS5pbml0KCksKHRoaXMub3B0aW9ucy5hcHBlbmRUb0VsfHxkb2N1bWVudC5ib2R5KS5hcHBlbmRDaGlsZCh0aGlzLmVsZW1lbnQpfWdldFRodW1iQm91bmRzKCl7cmV0dXJuIGZ1bmN0aW9uKHQsaSxzKXtjb25zdCBoPXMuZGlzcGF0Y2goInRodW1iQm91bmRzIix7aW5kZXg6dCxpdGVtRGF0YTppLGluc3RhbmNlOnN9KTtpZihoLnRodW1iQm91bmRzKXJldHVybiBoLnRodW1iQm91bmRzO2NvbnN0e2VsZW1lbnQ6ZX09aTtsZXQgbixvO2lmKGUmJiExIT09cy5vcHRpb25zLnRodW1iU2VsZWN0b3Ipe2NvbnN0IHQ9cy5vcHRpb25zLnRodW1iU2VsZWN0b3J8fCJpbWciO289ZS5tYXRjaGVzKHQpP2U6ZS5xdWVyeVNlbGVjdG9yKHQpfXJldHVybiBvPXMuYXBwbHlGaWx0ZXJzKCJ0aHVtYkVsIixvLGksdCksbyYmKG49aS50aHVtYkNyb3BwZWQ/ZnVuY3Rpb24odCxpLHMpe2NvbnN0IGg9dC5nZXRCb3VuZGluZ0NsaWVudFJlY3QoKSxlPWgud2lkdGgvaSxuPWguaGVpZ2h0L3Msbz1lPm4/ZTpuLHI9KGgud2lkdGgtaSpvKS8yLGE9KGguaGVpZ2h0LXMqbykvMixsPXt4OmgubGVmdCtyLHk6aC50b3ArYSx3Omkqb307cmV0dXJuIGwuaW5uZXJSZWN0PXt3Omgud2lkdGgsaDpoLmhlaWdodCx4OnIseTphfSxsfShvLGkud2lkdGh8fGkud3x8MCxpLmhlaWdodHx8aS5ofHwwKTpmdW5jdGlvbih0KXtjb25zdCBpPXQuZ2V0Qm91bmRpbmdDbGllbnRSZWN0KCk7cmV0dXJue3g6aS5sZWZ0LHk6aS50b3AsdzppLndpZHRofX0obykpLHMuYXBwbHlGaWx0ZXJzKCJ0aHVtYkJvdW5kcyIsbixpLHQpfSh0aGlzLmN1cnJJbmRleCx0aGlzLmN1cnJTbGlkZT90aGlzLmN1cnJTbGlkZS5kYXRhOnRoaXMuaGksdGhpcyl9Y2FuTG9vcCgpe3JldHVybiB0aGlzLm9wdGlvbnMubG9vcCYmdGhpcy5nZXROdW1JdGVtcygpPjJ9aWkodCl7cmV0dXJuIHdpbmRvdy5tYXRjaE1lZGlhKCIocHJlZmVycy1yZWR1Y2VkLW1vdGlvbiksICh1cGRhdGU6IHNsb3cpIikubWF0Y2hlcyYmKHQuc2hvd0hpZGVBbmltYXRpb25UeXBlPSJub25lIix0Lnpvb21BbmltYXRpb25EdXJhdGlvbj0wKSx7Li4uaXQsLi4udH19fWV4cG9ydHtzdCBhcyBkZWZhdWx0fTsK",
          "photoswipe-lightbox": "data:text/javascript;base64,LyohCiAgKiBQaG90b1N3aXBlIExpZ2h0Ym94IDUuNC40IC0gaHR0cHM6Ly9waG90b3N3aXBlLmNvbQogICogKGMpIDIwMjQgRG15dHJvIFNlbWVub3YKICAqLwpmdW5jdGlvbiB0KHQsaSxzKXtjb25zdCBoPWRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoaSk7cmV0dXJuIHQmJihoLmNsYXNzTmFtZT10KSxzJiZzLmFwcGVuZENoaWxkKGgpLGh9ZnVuY3Rpb24gaSh0LGkscyl7dC5zdHlsZS53aWR0aD0ibnVtYmVyIj09dHlwZW9mIGk/YCR7aX1weGA6aSx0LnN0eWxlLmhlaWdodD0ibnVtYmVyIj09dHlwZW9mIHM/YCR7c31weGA6c31jb25zdCBzPSJpZGxlIixoPSJsb2FkaW5nIixlPSJsb2FkZWQiLG49ImVycm9yIjtmdW5jdGlvbiBvKHQsaSxzPWRvY3VtZW50KXtsZXQgaD1bXTtpZih0IGluc3RhbmNlb2YgRWxlbWVudCloPVt0XTtlbHNlIGlmKHQgaW5zdGFuY2VvZiBOb2RlTGlzdHx8QXJyYXkuaXNBcnJheSh0KSloPUFycmF5LmZyb20odCk7ZWxzZXtjb25zdCBlPSJzdHJpbmciPT10eXBlb2YgdD90Omk7ZSYmKGg9QXJyYXkuZnJvbShzLnF1ZXJ5U2VsZWN0b3JBbGwoZSkpKX1yZXR1cm4gaH1mdW5jdGlvbiByKCl7cmV0dXJuISghbmF2aWdhdG9yLnZlbmRvcnx8IW5hdmlnYXRvci52ZW5kb3IubWF0Y2goL2FwcGxlL2kpKX1jbGFzcyBse2NvbnN0cnVjdG9yKHQsaSl7dGhpcy50eXBlPXQsdGhpcy5kZWZhdWx0UHJldmVudGVkPSExLGkmJk9iamVjdC5hc3NpZ24odGhpcyxpKX1wcmV2ZW50RGVmYXVsdCgpe3RoaXMuZGVmYXVsdFByZXZlbnRlZD0hMH19Y2xhc3MgYXtjb25zdHJ1Y3RvcihpLHMpe2lmKHRoaXMuZWxlbWVudD10KCJwc3dwX19pbWcgcHN3cF9faW1nLS1wbGFjZWhvbGRlciIsaT8iaW1nIjoiZGl2IixzKSxpKXtjb25zdCB0PXRoaXMuZWxlbWVudDt0LmRlY29kaW5nPSJhc3luYyIsdC5hbHQ9IiIsdC5zcmM9aSx0LnNldEF0dHJpYnV0ZSgicm9sZSIsInByZXNlbnRhdGlvbiIpfXRoaXMuZWxlbWVudC5zZXRBdHRyaWJ1dGUoImFyaWEtaGlkZGVuIiwidHJ1ZSIpfXNldERpc3BsYXllZFNpemUodCxzKXt0aGlzLmVsZW1lbnQmJigiSU1HIj09PXRoaXMuZWxlbWVudC50YWdOYW1lPyhpKHRoaXMuZWxlbWVudCwyNTAsImF1dG8iKSx0aGlzLmVsZW1lbnQuc3R5bGUudHJhbnNmb3JtT3JpZ2luPSIwIDAiLHRoaXMuZWxlbWVudC5zdHlsZS50cmFuc2Zvcm09ZnVuY3Rpb24odCxpLHMpe2xldCBoPWB0cmFuc2xhdGUzZCgke3R9cHgsJHtpfHwwfXB4LDApYDtyZXR1cm4gdm9pZCAwIT09cyYmKGgrPWAgc2NhbGUzZCgke3N9LCR7c30sMSlgKSxofSgwLDAsdC8yNTApKTppKHRoaXMuZWxlbWVudCx0LHMpKX1kZXN0cm95KCl7dmFyIHQ7bnVsbCE9PSh0PXRoaXMuZWxlbWVudCkmJnZvaWQgMCE9PXQmJnQucGFyZW50Tm9kZSYmdGhpcy5lbGVtZW50LnJlbW92ZSgpLHRoaXMuZWxlbWVudD1udWxsfX1jbGFzcyBke2NvbnN0cnVjdG9yKHQsaSxoKXt0aGlzLmluc3RhbmNlPWksdGhpcy5kYXRhPXQsdGhpcy5pbmRleD1oLHRoaXMuZWxlbWVudD12b2lkIDAsdGhpcy5wbGFjZWhvbGRlcj12b2lkIDAsdGhpcy5zbGlkZT12b2lkIDAsdGhpcy5kaXNwbGF5ZWRJbWFnZVdpZHRoPTAsdGhpcy5kaXNwbGF5ZWRJbWFnZUhlaWdodD0wLHRoaXMud2lkdGg9TnVtYmVyKHRoaXMuZGF0YS53KXx8TnVtYmVyKHRoaXMuZGF0YS53aWR0aCl8fDAsdGhpcy5oZWlnaHQ9TnVtYmVyKHRoaXMuZGF0YS5oKXx8TnVtYmVyKHRoaXMuZGF0YS5oZWlnaHQpfHwwLHRoaXMuaXNBdHRhY2hlZD0hMSx0aGlzLmhhc1NsaWRlPSExLHRoaXMuaXNEZWNvZGluZz0hMSx0aGlzLnN0YXRlPXMsdGhpcy5kYXRhLnR5cGU/dGhpcy50eXBlPXRoaXMuZGF0YS50eXBlOnRoaXMuZGF0YS5zcmM/dGhpcy50eXBlPSJpbWFnZSI6dGhpcy50eXBlPSJodG1sIix0aGlzLmluc3RhbmNlLmRpc3BhdGNoKCJjb250ZW50SW5pdCIse2NvbnRlbnQ6dGhpc30pfXJlbW92ZVBsYWNlaG9sZGVyKCl7dGhpcy5wbGFjZWhvbGRlciYmIXRoaXMua2VlcFBsYWNlaG9sZGVyKCkmJnNldFRpbWVvdXQoKCgpPT57dGhpcy5wbGFjZWhvbGRlciYmKHRoaXMucGxhY2Vob2xkZXIuZGVzdHJveSgpLHRoaXMucGxhY2Vob2xkZXI9dm9pZCAwKX0pLDFlMyl9bG9hZChpLHMpe2lmKHRoaXMuc2xpZGUmJnRoaXMudXNlUGxhY2Vob2xkZXIoKSlpZih0aGlzLnBsYWNlaG9sZGVyKXtjb25zdCB0PXRoaXMucGxhY2Vob2xkZXIuZWxlbWVudDt0JiYhdC5wYXJlbnRFbGVtZW50JiZ0aGlzLnNsaWRlLmNvbnRhaW5lci5wcmVwZW5kKHQpfWVsc2V7Y29uc3QgdD10aGlzLmluc3RhbmNlLmFwcGx5RmlsdGVycygicGxhY2Vob2xkZXJTcmMiLCEoIXRoaXMuZGF0YS5tc3JjfHwhdGhpcy5zbGlkZS5pc0ZpcnN0U2xpZGUpJiZ0aGlzLmRhdGEubXNyYyx0aGlzKTt0aGlzLnBsYWNlaG9sZGVyPW5ldyBhKHQsdGhpcy5zbGlkZS5jb250YWluZXIpfXRoaXMuZWxlbWVudCYmIXN8fHRoaXMuaW5zdGFuY2UuZGlzcGF0Y2goImNvbnRlbnRMb2FkIix7Y29udGVudDp0aGlzLGlzTGF6eTppfSkuZGVmYXVsdFByZXZlbnRlZHx8KHRoaXMuaXNJbWFnZUNvbnRlbnQoKT8odGhpcy5lbGVtZW50PXQoInBzd3BfX2ltZyIsImltZyIpLHRoaXMuZGlzcGxheWVkSW1hZ2VXaWR0aCYmdGhpcy5sb2FkSW1hZ2UoaSkpOih0aGlzLmVsZW1lbnQ9dCgicHN3cF9fY29udGVudCIsImRpdiIpLHRoaXMuZWxlbWVudC5pbm5lckhUTUw9dGhpcy5kYXRhLmh0bWx8fCIiKSxzJiZ0aGlzLnNsaWRlJiZ0aGlzLnNsaWRlLnVwZGF0ZUNvbnRlbnRTaXplKCEwKSl9bG9hZEltYWdlKHQpe3ZhciBpLHM7aWYoIXRoaXMuaXNJbWFnZUNvbnRlbnQoKXx8IXRoaXMuZWxlbWVudHx8dGhpcy5pbnN0YW5jZS5kaXNwYXRjaCgiY29udGVudExvYWRJbWFnZSIse2NvbnRlbnQ6dGhpcyxpc0xhenk6dH0pLmRlZmF1bHRQcmV2ZW50ZWQpcmV0dXJuO2NvbnN0IGU9dGhpcy5lbGVtZW50O3RoaXMudXBkYXRlU3Jjc2V0U2l6ZXMoKSx0aGlzLmRhdGEuc3Jjc2V0JiYoZS5zcmNzZXQ9dGhpcy5kYXRhLnNyY3NldCksZS5zcmM9bnVsbCE9PShpPXRoaXMuZGF0YS5zcmMpJiZ2b2lkIDAhPT1pP2k6IiIsZS5hbHQ9bnVsbCE9PShzPXRoaXMuZGF0YS5hbHQpJiZ2b2lkIDAhPT1zP3M6IiIsdGhpcy5zdGF0ZT1oLGUuY29tcGxldGU/dGhpcy5vbkxvYWRlZCgpOihlLm9ubG9hZD0oKT0+e3RoaXMub25Mb2FkZWQoKX0sZS5vbmVycm9yPSgpPT57dGhpcy5vbkVycm9yKCl9KX1zZXRTbGlkZSh0KXt0aGlzLnNsaWRlPXQsdGhpcy5oYXNTbGlkZT0hMCx0aGlzLmluc3RhbmNlPXQucHN3cH1vbkxvYWRlZCgpe3RoaXMuc3RhdGU9ZSx0aGlzLnNsaWRlJiZ0aGlzLmVsZW1lbnQmJih0aGlzLmluc3RhbmNlLmRpc3BhdGNoKCJsb2FkQ29tcGxldGUiLHtzbGlkZTp0aGlzLnNsaWRlLGNvbnRlbnQ6dGhpc30pLHRoaXMuc2xpZGUuaXNBY3RpdmUmJnRoaXMuc2xpZGUuaGVhdnlBcHBlbmRlZCYmIXRoaXMuZWxlbWVudC5wYXJlbnROb2RlJiYodGhpcy5hcHBlbmQoKSx0aGlzLnNsaWRlLnVwZGF0ZUNvbnRlbnRTaXplKCEwKSksdGhpcy5zdGF0ZSE9PWUmJnRoaXMuc3RhdGUhPT1ufHx0aGlzLnJlbW92ZVBsYWNlaG9sZGVyKCkpfW9uRXJyb3IoKXt0aGlzLnN0YXRlPW4sdGhpcy5zbGlkZSYmKHRoaXMuZGlzcGxheUVycm9yKCksdGhpcy5pbnN0YW5jZS5kaXNwYXRjaCgibG9hZENvbXBsZXRlIix7c2xpZGU6dGhpcy5zbGlkZSxpc0Vycm9yOiEwLGNvbnRlbnQ6dGhpc30pLHRoaXMuaW5zdGFuY2UuZGlzcGF0Y2goImxvYWRFcnJvciIse3NsaWRlOnRoaXMuc2xpZGUsY29udGVudDp0aGlzfSkpfWlzTG9hZGluZygpe3JldHVybiB0aGlzLmluc3RhbmNlLmFwcGx5RmlsdGVycygiaXNDb250ZW50TG9hZGluZyIsdGhpcy5zdGF0ZT09PWgsdGhpcyl9aXNFcnJvcigpe3JldHVybiB0aGlzLnN0YXRlPT09bn1pc0ltYWdlQ29udGVudCgpe3JldHVybiJpbWFnZSI9PT10aGlzLnR5cGV9c2V0RGlzcGxheWVkU2l6ZSh0LHMpe2lmKHRoaXMuZWxlbWVudCYmKHRoaXMucGxhY2Vob2xkZXImJnRoaXMucGxhY2Vob2xkZXIuc2V0RGlzcGxheWVkU2l6ZSh0LHMpLCF0aGlzLmluc3RhbmNlLmRpc3BhdGNoKCJjb250ZW50UmVzaXplIix7Y29udGVudDp0aGlzLHdpZHRoOnQsaGVpZ2h0OnN9KS5kZWZhdWx0UHJldmVudGVkJiYoaSh0aGlzLmVsZW1lbnQsdCxzKSx0aGlzLmlzSW1hZ2VDb250ZW50KCkmJiF0aGlzLmlzRXJyb3IoKSkpKXtjb25zdCBpPSF0aGlzLmRpc3BsYXllZEltYWdlV2lkdGgmJnQ7dGhpcy5kaXNwbGF5ZWRJbWFnZVdpZHRoPXQsdGhpcy5kaXNwbGF5ZWRJbWFnZUhlaWdodD1zLGk/dGhpcy5sb2FkSW1hZ2UoITEpOnRoaXMudXBkYXRlU3Jjc2V0U2l6ZXMoKSx0aGlzLnNsaWRlJiZ0aGlzLmluc3RhbmNlLmRpc3BhdGNoKCJpbWFnZVNpemVDaGFuZ2UiLHtzbGlkZTp0aGlzLnNsaWRlLHdpZHRoOnQsaGVpZ2h0OnMsY29udGVudDp0aGlzfSl9fWlzWm9vbWFibGUoKXtyZXR1cm4gdGhpcy5pbnN0YW5jZS5hcHBseUZpbHRlcnMoImlzQ29udGVudFpvb21hYmxlIix0aGlzLmlzSW1hZ2VDb250ZW50KCkmJnRoaXMuc3RhdGUhPT1uLHRoaXMpfXVwZGF0ZVNyY3NldFNpemVzKCl7aWYoIXRoaXMuaXNJbWFnZUNvbnRlbnQoKXx8IXRoaXMuZWxlbWVudHx8IXRoaXMuZGF0YS5zcmNzZXQpcmV0dXJuO2NvbnN0IHQ9dGhpcy5lbGVtZW50LGk9dGhpcy5pbnN0YW5jZS5hcHBseUZpbHRlcnMoInNyY3NldFNpemVzV2lkdGgiLHRoaXMuZGlzcGxheWVkSW1hZ2VXaWR0aCx0aGlzKTsoIXQuZGF0YXNldC5sYXJnZXN0VXNlZFNpemV8fGk+cGFyc2VJbnQodC5kYXRhc2V0Lmxhcmdlc3RVc2VkU2l6ZSwxMCkpJiYodC5zaXplcz1pKyJweCIsdC5kYXRhc2V0Lmxhcmdlc3RVc2VkU2l6ZT1TdHJpbmcoaSkpfXVzZVBsYWNlaG9sZGVyKCl7cmV0dXJuIHRoaXMuaW5zdGFuY2UuYXBwbHlGaWx0ZXJzKCJ1c2VDb250ZW50UGxhY2Vob2xkZXIiLHRoaXMuaXNJbWFnZUNvbnRlbnQoKSx0aGlzKX1sYXp5TG9hZCgpe3RoaXMuaW5zdGFuY2UuZGlzcGF0Y2goImNvbnRlbnRMYXp5TG9hZCIse2NvbnRlbnQ6dGhpc30pLmRlZmF1bHRQcmV2ZW50ZWR8fHRoaXMubG9hZCghMCl9a2VlcFBsYWNlaG9sZGVyKCl7cmV0dXJuIHRoaXMuaW5zdGFuY2UuYXBwbHlGaWx0ZXJzKCJpc0tlZXBpbmdQbGFjZWhvbGRlciIsdGhpcy5pc0xvYWRpbmcoKSx0aGlzKX1kZXN0cm95KCl7dGhpcy5oYXNTbGlkZT0hMSx0aGlzLnNsaWRlPXZvaWQgMCx0aGlzLmluc3RhbmNlLmRpc3BhdGNoKCJjb250ZW50RGVzdHJveSIse2NvbnRlbnQ6dGhpc30pLmRlZmF1bHRQcmV2ZW50ZWR8fCh0aGlzLnJlbW92ZSgpLHRoaXMucGxhY2Vob2xkZXImJih0aGlzLnBsYWNlaG9sZGVyLmRlc3Ryb3koKSx0aGlzLnBsYWNlaG9sZGVyPXZvaWQgMCksdGhpcy5pc0ltYWdlQ29udGVudCgpJiZ0aGlzLmVsZW1lbnQmJih0aGlzLmVsZW1lbnQub25sb2FkPW51bGwsdGhpcy5lbGVtZW50Lm9uZXJyb3I9bnVsbCx0aGlzLmVsZW1lbnQ9dm9pZCAwKSl9ZGlzcGxheUVycm9yKCl7aWYodGhpcy5zbGlkZSl7dmFyIGkscztsZXQgaD10KCJwc3dwX19lcnJvci1tc2ciLCJkaXYiKTtoLmlubmVyVGV4dD1udWxsIT09KGk9bnVsbD09PShzPXRoaXMuaW5zdGFuY2Uub3B0aW9ucyl8fHZvaWQgMD09PXM/dm9pZCAwOnMuZXJyb3JNc2cpJiZ2b2lkIDAhPT1pP2k6IiIsaD10aGlzLmluc3RhbmNlLmFwcGx5RmlsdGVycygiY29udGVudEVycm9yRWxlbWVudCIsaCx0aGlzKSx0aGlzLmVsZW1lbnQ9dCgicHN3cF9fY29udGVudCBwc3dwX19lcnJvci1tc2ctY29udGFpbmVyIiwiZGl2IiksdGhpcy5lbGVtZW50LmFwcGVuZENoaWxkKGgpLHRoaXMuc2xpZGUuY29udGFpbmVyLmlubmVyVGV4dD0iIix0aGlzLnNsaWRlLmNvbnRhaW5lci5hcHBlbmRDaGlsZCh0aGlzLmVsZW1lbnQpLHRoaXMuc2xpZGUudXBkYXRlQ29udGVudFNpemUoITApLHRoaXMucmVtb3ZlUGxhY2Vob2xkZXIoKX19YXBwZW5kKCl7aWYodGhpcy5pc0F0dGFjaGVkfHwhdGhpcy5lbGVtZW50KXJldHVybjtpZih0aGlzLmlzQXR0YWNoZWQ9ITAsdGhpcy5zdGF0ZT09PW4pcmV0dXJuIHZvaWQgdGhpcy5kaXNwbGF5RXJyb3IoKTtpZih0aGlzLmluc3RhbmNlLmRpc3BhdGNoKCJjb250ZW50QXBwZW5kIix7Y29udGVudDp0aGlzfSkuZGVmYXVsdFByZXZlbnRlZClyZXR1cm47Y29uc3QgdD0iZGVjb2RlImluIHRoaXMuZWxlbWVudDt0aGlzLmlzSW1hZ2VDb250ZW50KCk/dCYmdGhpcy5zbGlkZSYmKCF0aGlzLnNsaWRlLmlzQWN0aXZlfHxyKCkpPyh0aGlzLmlzRGVjb2Rpbmc9ITAsdGhpcy5lbGVtZW50LmRlY29kZSgpLmNhdGNoKCgoKT0+e30pKS5maW5hbGx5KCgoKT0+e3RoaXMuaXNEZWNvZGluZz0hMSx0aGlzLmFwcGVuZEltYWdlKCl9KSkpOnRoaXMuYXBwZW5kSW1hZ2UoKTp0aGlzLnNsaWRlJiYhdGhpcy5lbGVtZW50LnBhcmVudE5vZGUmJnRoaXMuc2xpZGUuY29udGFpbmVyLmFwcGVuZENoaWxkKHRoaXMuZWxlbWVudCl9YWN0aXZhdGUoKXshdGhpcy5pbnN0YW5jZS5kaXNwYXRjaCgiY29udGVudEFjdGl2YXRlIix7Y29udGVudDp0aGlzfSkuZGVmYXVsdFByZXZlbnRlZCYmdGhpcy5zbGlkZSYmKHRoaXMuaXNJbWFnZUNvbnRlbnQoKSYmdGhpcy5pc0RlY29kaW5nJiYhcigpP3RoaXMuYXBwZW5kSW1hZ2UoKTp0aGlzLmlzRXJyb3IoKSYmdGhpcy5sb2FkKCExLCEwKSx0aGlzLnNsaWRlLmhvbGRlckVsZW1lbnQmJnRoaXMuc2xpZGUuaG9sZGVyRWxlbWVudC5zZXRBdHRyaWJ1dGUoImFyaWEtaGlkZGVuIiwiZmFsc2UiKSl9ZGVhY3RpdmF0ZSgpe3RoaXMuaW5zdGFuY2UuZGlzcGF0Y2goImNvbnRlbnREZWFjdGl2YXRlIix7Y29udGVudDp0aGlzfSksdGhpcy5zbGlkZSYmdGhpcy5zbGlkZS5ob2xkZXJFbGVtZW50JiZ0aGlzLnNsaWRlLmhvbGRlckVsZW1lbnQuc2V0QXR0cmlidXRlKCJhcmlhLWhpZGRlbiIsInRydWUiKX1yZW1vdmUoKXt0aGlzLmlzQXR0YWNoZWQ9ITEsdGhpcy5pbnN0YW5jZS5kaXNwYXRjaCgiY29udGVudFJlbW92ZSIse2NvbnRlbnQ6dGhpc30pLmRlZmF1bHRQcmV2ZW50ZWR8fCh0aGlzLmVsZW1lbnQmJnRoaXMuZWxlbWVudC5wYXJlbnROb2RlJiZ0aGlzLmVsZW1lbnQucmVtb3ZlKCksdGhpcy5wbGFjZWhvbGRlciYmdGhpcy5wbGFjZWhvbGRlci5lbGVtZW50JiZ0aGlzLnBsYWNlaG9sZGVyLmVsZW1lbnQucmVtb3ZlKCkpfWFwcGVuZEltYWdlKCl7dGhpcy5pc0F0dGFjaGVkJiYodGhpcy5pbnN0YW5jZS5kaXNwYXRjaCgiY29udGVudEFwcGVuZEltYWdlIix7Y29udGVudDp0aGlzfSkuZGVmYXVsdFByZXZlbnRlZHx8KHRoaXMuc2xpZGUmJnRoaXMuZWxlbWVudCYmIXRoaXMuZWxlbWVudC5wYXJlbnROb2RlJiZ0aGlzLnNsaWRlLmNvbnRhaW5lci5hcHBlbmRDaGlsZCh0aGlzLmVsZW1lbnQpLHRoaXMuc3RhdGUhPT1lJiZ0aGlzLnN0YXRlIT09bnx8dGhpcy5yZW1vdmVQbGFjZWhvbGRlcigpKSl9fWZ1bmN0aW9uIGModCxpLHMsaCxlKXtsZXQgbj0wO2lmKGkucGFkZGluZ0ZuKW49aS5wYWRkaW5nRm4ocyxoLGUpW3RdO2Vsc2UgaWYoaS5wYWRkaW5nKW49aS5wYWRkaW5nW3RdO2Vsc2V7Y29uc3Qgcz0icGFkZGluZyIrdFswXS50b1VwcGVyQ2FzZSgpK3Quc2xpY2UoMSk7aVtzXSYmKG49aVtzXSl9cmV0dXJuIE51bWJlcihuKXx8MH1jbGFzcyB1e2NvbnN0cnVjdG9yKHQsaSxzLGgpe3RoaXMucHN3cD1oLHRoaXMub3B0aW9ucz10LHRoaXMuaXRlbURhdGE9aSx0aGlzLmluZGV4PXMsdGhpcy5wYW5BcmVhU2l6ZT1udWxsLHRoaXMuZWxlbWVudFNpemU9bnVsbCx0aGlzLmZpdD0xLHRoaXMuZmlsbD0xLHRoaXMudkZpbGw9MSx0aGlzLmluaXRpYWw9MSx0aGlzLnNlY29uZGFyeT0xLHRoaXMubWF4PTEsdGhpcy5taW49MX11cGRhdGUodCxpLHMpe2NvbnN0IGg9e3g6dCx5Oml9O3RoaXMuZWxlbWVudFNpemU9aCx0aGlzLnBhbkFyZWFTaXplPXM7Y29uc3QgZT1zLngvaC54LG49cy55L2gueTt0aGlzLmZpdD1NYXRoLm1pbigxLGU8bj9lOm4pLHRoaXMuZmlsbD1NYXRoLm1pbigxLGU+bj9lOm4pLHRoaXMudkZpbGw9TWF0aC5taW4oMSxuKSx0aGlzLmluaXRpYWw9dGhpcy50KCksdGhpcy5zZWNvbmRhcnk9dGhpcy5pKCksdGhpcy5tYXg9TWF0aC5tYXgodGhpcy5pbml0aWFsLHRoaXMuc2Vjb25kYXJ5LHRoaXMubygpKSx0aGlzLm1pbj1NYXRoLm1pbih0aGlzLmZpdCx0aGlzLmluaXRpYWwsdGhpcy5zZWNvbmRhcnkpLHRoaXMucHN3cCYmdGhpcy5wc3dwLmRpc3BhdGNoKCJ6b29tTGV2ZWxzVXBkYXRlIix7em9vbUxldmVsczp0aGlzLHNsaWRlRGF0YTp0aGlzLml0ZW1EYXRhfSl9bCh0KXtjb25zdCBpPXQrIlpvb21MZXZlbCIscz10aGlzLm9wdGlvbnNbaV07aWYocylyZXR1cm4iZnVuY3Rpb24iPT10eXBlb2Ygcz9zKHRoaXMpOiJmaWxsIj09PXM/dGhpcy5maWxsOiJmaXQiPT09cz90aGlzLmZpdDpOdW1iZXIocyl9aSgpe2xldCB0PXRoaXMubCgic2Vjb25kYXJ5Iik7cmV0dXJuIHR8fCh0PU1hdGgubWluKDEsMyp0aGlzLmZpdCksdGhpcy5lbGVtZW50U2l6ZSYmdCp0aGlzLmVsZW1lbnRTaXplLng+NGUzJiYodD00ZTMvdGhpcy5lbGVtZW50U2l6ZS54KSx0KX10KCl7cmV0dXJuIHRoaXMubCgiaW5pdGlhbCIpfHx0aGlzLmZpdH1vKCl7cmV0dXJuIHRoaXMubCgibWF4Iil8fE1hdGgubWF4KDEsNCp0aGlzLmZpdCl9fWZ1bmN0aW9uIHAodCxpLHMpe2NvbnN0IGg9aS5jcmVhdGVDb250ZW50RnJvbURhdGEodCxzKTtsZXQgZTtjb25zdHtvcHRpb25zOm59PWk7aWYobil7bGV0IG87ZT1uZXcgdShuLHQsLTEpLG89aS5wc3dwP2kucHN3cC52aWV3cG9ydFNpemU6ZnVuY3Rpb24odCxpKXtpZih0LmdldFZpZXdwb3J0U2l6ZUZuKXtjb25zdCBzPXQuZ2V0Vmlld3BvcnRTaXplRm4odCxpKTtpZihzKXJldHVybiBzfXJldHVybnt4OmRvY3VtZW50LmRvY3VtZW50RWxlbWVudC5jbGllbnRXaWR0aCx5OndpbmRvdy5pbm5lckhlaWdodH19KG4saSk7Y29uc3Qgcj1mdW5jdGlvbih0LGkscyxoKXtyZXR1cm57eDppLngtYygibGVmdCIsdCxpLHMsaCktYygicmlnaHQiLHQsaSxzLGgpLHk6aS55LWMoInRvcCIsdCxpLHMsaCktYygiYm90dG9tIix0LGkscyxoKX19KG4sbyx0LHMpO2UudXBkYXRlKGgud2lkdGgsaC5oZWlnaHQscil9cmV0dXJuIGgubGF6eUxvYWQoKSxlJiZoLnNldERpc3BsYXllZFNpemUoTWF0aC5jZWlsKGgud2lkdGgqZS5pbml0aWFsKSxNYXRoLmNlaWwoaC5oZWlnaHQqZS5pbml0aWFsKSksaH1jbGFzcyB2IGV4dGVuZHMgY2xhc3MgZXh0ZW5kcyBjbGFzc3tjb25zdHJ1Y3Rvcigpe3RoaXMudT17fSx0aGlzLnA9e30sdGhpcy5wc3dwPXZvaWQgMCx0aGlzLm9wdGlvbnM9dm9pZCAwfWFkZEZpbHRlcih0LGkscz0xMDApe3ZhciBoLGUsbjt0aGlzLnBbdF18fCh0aGlzLnBbdF09W10pLG51bGw9PT0oaD10aGlzLnBbdF0pfHx2b2lkIDA9PT1ofHxoLnB1c2goe2ZuOmkscHJpb3JpdHk6c30pLG51bGw9PT0oZT10aGlzLnBbdF0pfHx2b2lkIDA9PT1lfHxlLnNvcnQoKCh0LGkpPT50LnByaW9yaXR5LWkucHJpb3JpdHkpKSxudWxsPT09KG49dGhpcy5wc3dwKXx8dm9pZCAwPT09bnx8bi5hZGRGaWx0ZXIodCxpLHMpfXJlbW92ZUZpbHRlcih0LGkpe3RoaXMucFt0XSYmKHRoaXMucFt0XT10aGlzLnBbdF0uZmlsdGVyKCh0PT50LmZuIT09aSkpKSx0aGlzLnBzd3AmJnRoaXMucHN3cC5yZW1vdmVGaWx0ZXIodCxpKX1hcHBseUZpbHRlcnModCwuLi5pKXt2YXIgcztyZXR1cm4gbnVsbD09PShzPXRoaXMucFt0XSl8fHZvaWQgMD09PXN8fHMuZm9yRWFjaCgodD0+e2lbMF09dC5mbi5hcHBseSh0aGlzLGkpfSkpLGlbMF19b24odCxpKXt2YXIgcyxoO3RoaXMudVt0XXx8KHRoaXMudVt0XT1bXSksbnVsbD09PShzPXRoaXMudVt0XSl8fHZvaWQgMD09PXN8fHMucHVzaChpKSxudWxsPT09KGg9dGhpcy5wc3dwKXx8dm9pZCAwPT09aHx8aC5vbih0LGkpfW9mZih0LGkpe3ZhciBzO3RoaXMudVt0XSYmKHRoaXMudVt0XT10aGlzLnVbdF0uZmlsdGVyKCh0PT5pIT09dCkpKSxudWxsPT09KHM9dGhpcy5wc3dwKXx8dm9pZCAwPT09c3x8cy5vZmYodCxpKX1kaXNwYXRjaCh0LGkpe3ZhciBzO2lmKHRoaXMucHN3cClyZXR1cm4gdGhpcy5wc3dwLmRpc3BhdGNoKHQsaSk7Y29uc3QgaD1uZXcgbCh0LGkpO3JldHVybiBudWxsPT09KHM9dGhpcy51W3RdKXx8dm9pZCAwPT09c3x8cy5mb3JFYWNoKCh0PT57dC5jYWxsKHRoaXMsaCl9KSksaH19e2dldE51bUl0ZW1zKCl7dmFyIHQ7bGV0IGk9MDtjb25zdCBzPW51bGw9PT0odD10aGlzLm9wdGlvbnMpfHx2b2lkIDA9PT10P3ZvaWQgMDp0LmRhdGFTb3VyY2U7cyYmImxlbmd0aCJpbiBzP2k9cy5sZW5ndGg6cyYmImdhbGxlcnkiaW4gcyYmKHMuaXRlbXN8fChzLml0ZW1zPXRoaXMudihzLmdhbGxlcnkpKSxzLml0ZW1zJiYoaT1zLml0ZW1zLmxlbmd0aCkpO2NvbnN0IGg9dGhpcy5kaXNwYXRjaCgibnVtSXRlbXMiLHtkYXRhU291cmNlOnMsbnVtSXRlbXM6aX0pO3JldHVybiB0aGlzLmFwcGx5RmlsdGVycygibnVtSXRlbXMiLGgubnVtSXRlbXMscyl9Y3JlYXRlQ29udGVudEZyb21EYXRhKHQsaSl7cmV0dXJuIG5ldyBkKHQsdGhpcyxpKX1nZXRJdGVtRGF0YSh0KXt2YXIgaTtjb25zdCBzPW51bGw9PT0oaT10aGlzLm9wdGlvbnMpfHx2b2lkIDA9PT1pP3ZvaWQgMDppLmRhdGFTb3VyY2U7bGV0IGg9e307QXJyYXkuaXNBcnJheShzKT9oPXNbdF06cyYmImdhbGxlcnkiaW4gcyYmKHMuaXRlbXN8fChzLml0ZW1zPXRoaXMudihzLmdhbGxlcnkpKSxoPXMuaXRlbXNbdF0pO2xldCBlPWg7ZSBpbnN0YW5jZW9mIEVsZW1lbnQmJihlPXRoaXMubShlKSk7Y29uc3Qgbj10aGlzLmRpc3BhdGNoKCJpdGVtRGF0YSIse2l0ZW1EYXRhOmV8fHt9LGluZGV4OnR9KTtyZXR1cm4gdGhpcy5hcHBseUZpbHRlcnMoIml0ZW1EYXRhIixuLml0ZW1EYXRhLHQpfXYodCl7dmFyIGkscztyZXR1cm4gbnVsbCE9PShpPXRoaXMub3B0aW9ucykmJnZvaWQgMCE9PWkmJmkuY2hpbGRyZW58fG51bGwhPT0ocz10aGlzLm9wdGlvbnMpJiZ2b2lkIDAhPT1zJiZzLmNoaWxkU2VsZWN0b3I/byh0aGlzLm9wdGlvbnMuY2hpbGRyZW4sdGhpcy5vcHRpb25zLmNoaWxkU2VsZWN0b3IsdCl8fFtdOlt0XX1tKHQpe2NvbnN0IGk9e2VsZW1lbnQ6dH0scz0iQSI9PT10LnRhZ05hbWU/dDp0LnF1ZXJ5U2VsZWN0b3IoImEiKTtpZihzKXtpLnNyYz1zLmRhdGFzZXQucHN3cFNyY3x8cy5ocmVmLHMuZGF0YXNldC5wc3dwU3Jjc2V0JiYoaS5zcmNzZXQ9cy5kYXRhc2V0LnBzd3BTcmNzZXQpLGkud2lkdGg9cy5kYXRhc2V0LnBzd3BXaWR0aD9wYXJzZUludChzLmRhdGFzZXQucHN3cFdpZHRoLDEwKTowLGkuaGVpZ2h0PXMuZGF0YXNldC5wc3dwSGVpZ2h0P3BhcnNlSW50KHMuZGF0YXNldC5wc3dwSGVpZ2h0LDEwKTowLGkudz1pLndpZHRoLGkuaD1pLmhlaWdodCxzLmRhdGFzZXQucHN3cFR5cGUmJihpLnR5cGU9cy5kYXRhc2V0LnBzd3BUeXBlKTtjb25zdCBlPXQucXVlcnlTZWxlY3RvcigiaW1nIik7dmFyIGg7aWYoZSlpLm1zcmM9ZS5jdXJyZW50U3JjfHxlLnNyYyxpLmFsdD1udWxsIT09KGg9ZS5nZXRBdHRyaWJ1dGUoImFsdCIpKSYmdm9pZCAwIT09aD9oOiIiOyhzLmRhdGFzZXQucHN3cENyb3BwZWR8fHMuZGF0YXNldC5jcm9wcGVkKSYmKGkudGh1bWJDcm9wcGVkPSEwKX1yZXR1cm4gdGhpcy5hcHBseUZpbHRlcnMoImRvbUl0ZW1EYXRhIixpLHQscyl9bGF6eUxvYWREYXRhKHQsaSl7cmV0dXJuIHAodCx0aGlzLGkpfX17Y29uc3RydWN0b3IodCl7c3VwZXIoKSx0aGlzLm9wdGlvbnM9dHx8e30sdGhpcy5nPTAsdGhpcy5zaG91bGRPcGVuPSExLHRoaXMuXz12b2lkIDAsdGhpcy5vblRodW1ibmFpbHNDbGljaz10aGlzLm9uVGh1bWJuYWlsc0NsaWNrLmJpbmQodGhpcyl9aW5pdCgpe28odGhpcy5vcHRpb25zLmdhbGxlcnksdGhpcy5vcHRpb25zLmdhbGxlcnlTZWxlY3RvcikuZm9yRWFjaCgodD0+e3QuYWRkRXZlbnRMaXN0ZW5lcigiY2xpY2siLHRoaXMub25UaHVtYm5haWxzQ2xpY2ssITEpfSkpfW9uVGh1bWJuYWlsc0NsaWNrKHQpe2lmKGZ1bmN0aW9uKHQpe3JldHVybiJidXR0b24iaW4gdCYmMT09PXQuYnV0dG9ufHx0LmN0cmxLZXl8fHQubWV0YUtleXx8dC5hbHRLZXl8fHQuc2hpZnRLZXl9KHQpfHx3aW5kb3cucHN3cClyZXR1cm47bGV0IGk9e3g6dC5jbGllbnRYLHk6dC5jbGllbnRZfTtpLnh8fGkueXx8KGk9bnVsbCk7bGV0IHM9dGhpcy5nZXRDbGlja2VkSW5kZXgodCk7cz10aGlzLmFwcGx5RmlsdGVycygiY2xpY2tlZEluZGV4IixzLHQsdGhpcyk7Y29uc3QgaD17Z2FsbGVyeTp0LmN1cnJlbnRUYXJnZXR9O3M+PTAmJih0LnByZXZlbnREZWZhdWx0KCksdGhpcy5sb2FkQW5kT3BlbihzLGgsaSkpfWdldENsaWNrZWRJbmRleCh0KXtpZih0aGlzLm9wdGlvbnMuZ2V0Q2xpY2tlZEluZGV4Rm4pcmV0dXJuIHRoaXMub3B0aW9ucy5nZXRDbGlja2VkSW5kZXhGbi5jYWxsKHRoaXMsdCk7Y29uc3QgaT10LnRhcmdldCxzPW8odGhpcy5vcHRpb25zLmNoaWxkcmVuLHRoaXMub3B0aW9ucy5jaGlsZFNlbGVjdG9yLHQuY3VycmVudFRhcmdldCkuZmluZEluZGV4KCh0PT50PT09aXx8dC5jb250YWlucyhpKSkpO3JldHVybi0xIT09cz9zOnRoaXMub3B0aW9ucy5jaGlsZHJlbnx8dGhpcy5vcHRpb25zLmNoaWxkU2VsZWN0b3I/LTE6MH1sb2FkQW5kT3Blbih0LGkscyl7aWYod2luZG93LnBzd3B8fCF0aGlzLm9wdGlvbnMpcmV0dXJuITE7aWYoIWkmJnRoaXMub3B0aW9ucy5nYWxsZXJ5JiZ0aGlzLm9wdGlvbnMuY2hpbGRyZW4pe2NvbnN0IHQ9byh0aGlzLm9wdGlvbnMuZ2FsbGVyeSk7dFswXSYmKGk9e2dhbGxlcnk6dFswXX0pfXJldHVybiB0aGlzLm9wdGlvbnMuaW5kZXg9dCx0aGlzLm9wdGlvbnMuaW5pdGlhbFBvaW50ZXJQb3M9cyx0aGlzLnNob3VsZE9wZW49ITAsdGhpcy5wcmVsb2FkKHQsaSksITB9cHJlbG9hZCh0LGkpe2NvbnN0e29wdGlvbnM6c309dGhpcztpJiYocy5kYXRhU291cmNlPWkpO2NvbnN0IGg9W10sZT10eXBlb2Ygcy5wc3dwTW9kdWxlO2lmKCJmdW5jdGlvbiI9PXR5cGVvZihuPXMucHN3cE1vZHVsZSkmJm4ucHJvdG90eXBlJiZuLnByb3RvdHlwZS5nb1RvKWgucHVzaChQcm9taXNlLnJlc29sdmUocy5wc3dwTW9kdWxlKSk7ZWxzZXtpZigic3RyaW5nIj09PWUpdGhyb3cgbmV3IEVycm9yKCJwc3dwTW9kdWxlIGFzIHN0cmluZyBpcyBubyBsb25nZXIgc3VwcG9ydGVkIik7aWYoImZ1bmN0aW9uIiE9PWUpdGhyb3cgbmV3IEVycm9yKCJwc3dwTW9kdWxlIGlzIG5vdCB2YWxpZCIpO2gucHVzaChzLnBzd3BNb2R1bGUoKSl9dmFyIG47ImZ1bmN0aW9uIj09dHlwZW9mIHMub3BlblByb21pc2UmJmgucHVzaChzLm9wZW5Qcm9taXNlKCkpLCExIT09cy5wcmVsb2FkRmlyc3RTbGlkZSYmdD49MCYmKHRoaXMuXz1mdW5jdGlvbih0LGkpe2NvbnN0IHM9aS5nZXRJdGVtRGF0YSh0KTtpZighaS5kaXNwYXRjaCgibGF6eUxvYWRTbGlkZSIse2luZGV4OnQsaXRlbURhdGE6c30pLmRlZmF1bHRQcmV2ZW50ZWQpcmV0dXJuIHAocyxpLHQpfSh0LHRoaXMpKTtjb25zdCBvPSsrdGhpcy5nO1Byb21pc2UuYWxsKGgpLnRoZW4oKHQ9PntpZih0aGlzLnNob3VsZE9wZW4pe2NvbnN0IGk9dFswXTt0aGlzLkkoaSxvKX19KSl9SSh0LGkpe2lmKGkhPT10aGlzLmcmJnRoaXMuc2hvdWxkT3BlbilyZXR1cm47aWYodGhpcy5zaG91bGRPcGVuPSExLHdpbmRvdy5wc3dwKXJldHVybjtjb25zdCBzPSJvYmplY3QiPT10eXBlb2YgdD9uZXcgdC5kZWZhdWx0KHRoaXMub3B0aW9ucyk6bmV3IHQodGhpcy5vcHRpb25zKTt0aGlzLnBzd3A9cyx3aW5kb3cucHN3cD1zLE9iamVjdC5rZXlzKHRoaXMudSkuZm9yRWFjaCgodD0+e3ZhciBpO251bGw9PT0oaT10aGlzLnVbdF0pfHx2b2lkIDA9PT1pfHxpLmZvckVhY2goKGk9PntzLm9uKHQsaSl9KSl9KSksT2JqZWN0LmtleXModGhpcy5wKS5mb3JFYWNoKCh0PT57dmFyIGk7bnVsbD09PShpPXRoaXMucFt0XSl8fHZvaWQgMD09PWl8fGkuZm9yRWFjaCgoaT0+e3MuYWRkRmlsdGVyKHQsaS5mbixpLnByaW9yaXR5KX0pKX0pKSx0aGlzLl8mJihzLmNvbnRlbnRMb2FkZXIuYWRkVG9DYWNoZSh0aGlzLl8pLHRoaXMuXz12b2lkIDApLHMub24oImRlc3Ryb3kiLCgoKT0+e3RoaXMucHN3cD12b2lkIDAsZGVsZXRlIHdpbmRvdy5wc3dwfSkpLHMuaW5pdCgpfWRlc3Ryb3koKXt2YXIgdDtudWxsPT09KHQ9dGhpcy5wc3dwKXx8dm9pZCAwPT09dHx8dC5kZXN0cm95KCksdGhpcy5zaG91bGRPcGVuPSExLHRoaXMudT17fSxvKHRoaXMub3B0aW9ucy5nYWxsZXJ5LHRoaXMub3B0aW9ucy5nYWxsZXJ5U2VsZWN0b3IpLmZvckVhY2goKHQ9Pnt0LnJlbW92ZUV2ZW50TGlzdGVuZXIoImNsaWNrIix0aGlzLm9uVGh1bWJuYWlsc0NsaWNrLCExKX0pKX19ZXhwb3J0e3YgYXMgZGVmYXVsdH07Cg=="
        }
      }
    </script>
    <script type="module">
      import PhotoSwipe from 'photoswipe';
      import PhotoSwipeLightbox from 'photoswipe-lightbox';

      /**
       * @param {HTMLDivElement} node
       */
      const photoSwipeSize = (node) => {
        // get image tag inside of node
        if (node.hasAttribute('data-pswp-width') && node.hasAttribute('data-pswp-height')) {
          return;
        }
        /** @type {HTMLImageElement | null} */
        const img = node.querySelector('img');
        if (!img) {
          return;
        }
        let i = new Image();
        i.onload = () => {
          node.setAttribute('data-pswp-width', i.width.toString());
          node.setAttribute('data-pswp-height', i.height.toString());
        };
        i.src = img.src;
      };

      class IdsGallery extends HTMLElement {
        constructor() {
          super();
          this.classList.add('ids__gallery');
        }

        connectedCallback() {
          this.lightbox = new PhotoSwipeLightbox({
            gallery: this,
            children: 'a',
            pswpModule: PhotoSwipe,
            padding: {top: 20, bottom: 40, left: 100, right: 100}
          });

          this.lightbox.on('uiRegister', () => {
            if (!this.getAttribute('zoom') && this.lightbox?.pswp?.ui?.uiElementsData?.length) {
              this.lightbox.pswp.ui.uiElementsData = this.lightbox.pswp.ui.uiElementsData.filter(el => el.name !== 'zoom')
            }
          });

          this.lightbox.init();

          this.querySelectorAll('a').forEach(photoSwipeSize)
        }

        disconnectedCallback() {
          this.lightbox.destroy();
        }
      }

      window.customElements.define('ids-gallery', IdsGallery);

    </script>
    <script>
      let observer = new IntersectionObserver((elements)=>{
        elements.forEach((el) => {
          if(el.intersectionRatio > .3) {
            el.target.classList.remove("sleep");
          } else {
            el.target.classList.add("sleep");
          }
        })
      }, {threshold: [0, .5]});

      document.querySelectorAll('.ids__snooze').forEach(el => {
        observer.observe(el);
      })
    </script>
    <script>  

      class IdsNavbar extends HTMLElement {
        static #items = [];
        static #instances = [];

        constructor() {
          super();
          this.classList.add('ids__navbar');
          this.render();
        }

        static updateItems() {
          // Сейчас оно будет запускаться слишком часто, нужно будет переделать
          this.#items = [...document.querySelectorAll('.ids__nav-item')];
          for (const instance of this.#instances) {
            instance.render();
          }
          this.updateCurrent();
        }

        static updateCurrent() {
          let highestTopPositionIndex = 0;
          for (let i = 0; i < this.#items.length; i++) {
            let { bottom, top } = this.#items[i].getBoundingClientRect() ?? {
              top: 0,
              bottom: 0
            };
            let topPosition = (top + bottom) / 2;
            if (topPosition < 0) {
              highestTopPositionIndex = i;
            }
            if (topPosition >= 0 && topPosition < window.innerHeight / 2) {
              highestTopPositionIndex = i;
              break;
            }
          }
          let id = this.#items[highestTopPositionIndex].getAttribute('id');
          history.replaceState({}, '', `#${id}`);
          for (const instance of this.#instances) {
            for (const /** @type {HTMLElement} */ li of instance.querySelectorAll('li:has(a)')) {
              li.classList.toggle('current', li.firstElementChild.getAttribute('href') === '#' + id);
            }
          }
        }

        connectedCallback() {
          IdsNavbar.#instances.push(this);
        }

        disconnectedCallback() {
          IdsNavbar.#instances.splice(IdsNavbar.#instances.indexOf(this), 1);
        }

        render() {
          // Тут стоит делать через манипуляции с dom и не пересоздавать одни и те же записи по 100 раз
          this.innerHTML = `
            <ul>
                ${IdsNavbar.#items.map(item => `
                    <li>
                        <a href="#${item.getAttribute('id')}">
                            ${item.getAttribute('text')}
                        </a>
                    </li>
                `).join('')}
            </ul>
          `
        }

      }

      // TODO можно добавлять/убирать этот лисенер
      document.addEventListener('scroll', () => IdsNavbar.updateCurrent());

      class IdsNavItem extends HTMLElement {
        constructor() {
          super();
          this.classList.add('ids__nav-item');
        }

        connectedCallback() {
          IdsNavbar.updateItems();
        }
        disconnectedCallback() {
          IdsNavbar.updateItems();
        }
      }

      window.customElements.define('ids-navbar', IdsNavbar);
      window.customElements.define('ids-nav-item', IdsNavItem);
    </script>
  </body>

</html>
